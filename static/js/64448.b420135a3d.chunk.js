"use strict";(self.webpackChunkweb=self.webpackChunkweb||[]).push([[64448],{714718:(e,t,r)=>{r.d(t,{A:()=>useFormatDate});var n=r(514041),a=r(243915),o=r(152111),i=r(724726),s=r(584941),l=r(121684),u=r(232585),c=r(769059),d=r(830885),f=r(209730),m=r(411887),h=r(886738),parseLocal=function(e){switch(e){case"zh-CN":return u.A;case"en-US":default:return c.A;case"zh-HK":return d.A;case"ja-JP":return f.A;case"ko-KR":return m.A}};function useFormatDate(){var e=(0,h.L)(),t=(0,n.useCallback)((function(t,r){var n;n="string"==typeof t?(0,a.A)(t):t;try{return(0,o.A)(n,null!=r?r:"PPp",{locale:parseLocal(e)})}catch(e){return"-"}}),[e]),r=(0,n.useCallback)((function(r,n){var o,i;i="string"==typeof r?(0,a.A)(r):r;var s=(new Date).getFullYear(),l=(new Date).getMonth(),u="yyyy/LL/dd, HH:mm";return["de","es","en-US","fr-FR","it-IT","uk-UA"].includes(e)&&(u="LL/dd/yyyy, HH:mm"),(s===i.getFullYear()&&n?.hideTheYear||n?.hideYear)&&(u=(u=u.replace("yyyy/","")).replace("/yyyy","")),(l===i.getMonth()&&n?.hideTheMonth||n?.hideMonth)&&(u=u.replace("LL/","")),n?.hideTimeForever&&(u=u.replace(", HH:mm","")),n?.onlyTime&&(u="HH:mm"),null!=(o=t(i,u))?o:""}),[t,e]),u=(0,n.useCallback)((function(e,r){var n,o,i;return o="string"==typeof e?(0,a.A)(e):e,(new Date).getFullYear()===o.getFullYear()&&r?.hideTheYear||r?.hideYear?null!=(i=t(o,"MMMM"))?i:"":null!=(n=t(o,"MMMM, yyyy"))?n:""}),[t]),c=(0,n.useCallback)((function(t,r){var n;return null!=(n=(0,i.A)(t,r,{locale:parseLocal(e)}))?n:""}),[e]),d=(0,n.useCallback)((function(t){var r;return null!=(r=(0,s.A)(t,{addSuffix:!0,locale:parseLocal(e)}))?r:""}),[e]),f=(0,n.useCallback)((function(t){var r;return null!=(r=(0,l.A)(t,{locale:parseLocal(e)}))?r:""}),[e]);return(0,n.useMemo)((function(){return{format:t,formatDate:r,formatMonth:u,formatDistanceToNow:d,formatDuration:f,formatDistanceStrict:c}}),[t,r,u,d,f,c])}},309008:(e,t,r)=>{r.d(t,{o:()=>c});var n=r(324586),a=r(514041),o=r(325529),i=r(2577),s=r(597102),l=r(829561),u=r(831085);function ownKeys(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function _objectSpread(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?ownKeys(Object(r),!0).forEach((function(t){(0,n.A)(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):ownKeys(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}var c=(0,a.memo)((function(e){var{children:t,storeName:r}=e,n=(0,l.x6)(r),a=i.A.getOrCreateStore(n);return(0,u.jsxs)(u.Fragment,{children:[(0,u.jsx)(s.H,_objectSpread({},n)),(0,u.jsx)(o.BY,{store:a,children:t})]})}));c.displayName="SwapProviderMirror"},664448:(e,t,r)=>{r.r(t),r.d(t,{default:()=>modal_SwapHistoryListModal});var n=r(586330),a=r(514041),o=r(724249),i=r(908867),s=r(490343),l=r(896666),u=r(60153),c=r(791088),d=r(498356),f=r(714718),m=r(911998),h=r(604343),y=r(254491),p=r(628380),b=r(619390),x=r(391944),g=r(831085),SwapTxHistoryAvatar=function({fromUri:e,toUri:t}){return(0,g.jsxs)(s.Stack,{w:"$10",h:"$10",alignItems:"flex-end",justifyContent:"flex-end",children:[(0,g.jsx)(s.Stack,{position:"absolute",left:"$0",top:"$0",children:(0,g.jsx)(x.o,{size:"sm",tokenImageUri:e})}),(0,g.jsx)(s.Stack,{borderWidth:2,borderColor:"$bgApp",borderRadius:"$full",zIndex:1,children:(0,g.jsx)(x.o,{size:"sm",tokenImageUri:t})})]})};const components_SwapTxHistoryListCell=function({item:e,onClickCell:t}){var r,n,o=(0,i.A)(),{formatDate:l}=(0,f.A)(),u=(0,a.useMemo)((function(){return e.status===b.lr.FAILED?(0,g.jsx)(s.Badge,{badgeType:"critical",badgeSize:"lg",children:o.formatMessage({id:y.ETranslations.swap_history_status_failed})}):e.status===b.lr.CANCELED?(0,g.jsx)(s.Badge,{badgeType:"warning",badgeSize:"lg",children:o.formatMessage({id:y.ETranslations.swap_history_status_canceled})}):e.status===b.lr.CANCELING?(0,g.jsx)(s.Badge,{badgeType:"warning",badgeSize:"lg",children:o.formatMessage({id:y.ETranslations.swap_history_status_cancelling})}):null}),[o,e.status]),d=(0,a.useMemo)((function(){var{created:t}=e.date,r=l(new Date(t),{hideYear:!0,onlyTime:e.status!==b.lr.PENDING&&e.status!==b.lr.CANCELING});return(0,g.jsxs)(s.XStack,{space:"$2",children:[(0,g.jsx)(s.SizableText,{size:"$bodyMd",color:"$textSubdued",children:r}),u]})}),[l,e.date,e.status,u]),m=(0,a.useMemo)((function(){return(0,g.jsxs)(s.XStack,{alignItems:"center",space:"$1",children:[(0,g.jsx)(s.SizableText,{size:"$bodyLgMedium",children:e.baseInfo.fromToken.symbol.toUpperCase()}),(0,g.jsx)(s.Icon,{name:"ArrowRightOutline",size:"$5",color:"$iconSubdued"}),(0,g.jsx)(s.SizableText,{size:"$bodyLgMedium",children:e.baseInfo.toToken.symbol.toUpperCase()})]})}),[e.baseInfo.fromToken.symbol,e.baseInfo.toToken.symbol]);return(0,g.jsxs)(c.c,{onPress:t,userSelect:"none",renderAvatar:(0,g.jsx)(SwapTxHistoryAvatar,{fromUri:null!=(r=e.baseInfo.fromToken.logoURI)?r:"",toUri:null!=(n=e.baseInfo.toToken.logoURI)?n:""}),children:[(0,g.jsx)(c.c.Text,{flex:1,primary:m,secondary:d}),(0,g.jsx)(c.c.Text,{align:"right",primary:(0,g.jsxs)(s.SizableText,{color:"$textSuccess",children:["+",(0,g.jsx)(s.NumberSizeableText,{color:"$textSuccess",formatter:"balance",children:e.baseInfo.toAmount})," ",(0,g.jsx)(s.SizableText,{color:"$textSuccess",children:e.baseInfo.toToken.symbol.toUpperCase()})]}),primaryTextProps:{color:"$textSuccess"},secondary:(0,g.jsxs)(s.SizableText,{textAlign:"right",size:"$bodyMd",color:"$textSubdued",children:["-",(0,g.jsx)(s.NumberSizeableText,{formatter:"balance",size:"$bodyMd",color:"$textSubdued",children:e.baseInfo.fromAmount})," ",(0,g.jsx)(s.SizableText,{size:"$bodyMd",color:"$textSubdued",children:e.baseInfo.fromToken.symbol.toUpperCase()})]})})]})};var v=r(309008),SwapHistoryListModal=function({storeName:e}){var t=(0,i.A)(),[{swapHistoryPendingList:r}]=(0,h.useInAppNotificationAtom)(),{result:o,isLoading:x}=(0,m.yk)((0,n.A)((function*(){return yield u.A.serviceSwap.fetchSwapHistoryListFromSimple()})),[r],{watchLoading:!0}),v=(0,d.A)(),{formatDate:A}=(0,f.A)(),D=(0,a.useMemo)((function(){var e,r,n=null!=(e=o?.filter((function(e){return e.status===b.lr.PENDING||e.status===b.lr.CANCELING})))?e:[],a=(null!=(r=o?.filter((function(e){return e.status!==b.lr.PENDING&&e.status!==b.lr.CANCELING})))?r:[]).reduce((function(e,t){var r=new Date(t.date.created),n=A(r,{hideTimeForever:!0,hideYear:!0});return e[n]||(e[n]=[]),e[n].push(t),e}),{}),i=Object.entries(a).map((function([e,t]){return{title:e,data:t}}));return n.length>0&&(i=[{title:t.formatMessage({id:y.ETranslations.swap_history_status_pending}),status:b.lr.PENDING,data:n},...i]),i}),[A,t,o]),S=(0,a.useCallback)((function(){o?.length&&s.Dialog.confirm({title:t.formatMessage({id:y.ETranslations.swap_history_detail_delete_title}),onConfirm:function(){u.A.serviceSwap.cleanSwapHistoryItems()},onConfirmText:t.formatMessage({id:y.ETranslations.swap_history_detail_delete_confirm})})}),[t,o?.length]),j=(0,a.useCallback)((function(){return(0,g.jsx)(l.v$,{onPress:S,icon:"DeleteOutline"})}),[S]),w=(0,a.useCallback)((function({item:t}){return(0,g.jsx)(components_SwapTxHistoryListCell,{item:t,onClickCell:function(){v.push(p.u.SwapHistoryDetail,{txHistory:t,storeName:e})}})}),[v,e]);return(0,g.jsxs)(s.Page,{children:[(0,g.jsx)(s.Page.Header,{headerRight:j}),x?Array.from({length:5}).map((function(e,t){return(0,g.jsxs)(c.c,{children:[(0,g.jsx)(s.Skeleton,{w:"$10",h:"$10",radius:"round"}),(0,g.jsxs)(s.YStack,{children:[(0,g.jsx)(s.YStack,{py:"$1",children:(0,g.jsx)(s.Skeleton,{h:"$4",w:"$32"})}),(0,g.jsx)(s.YStack,{py:"$1",children:(0,g.jsx)(s.Skeleton,{h:"$3",w:"$24"})})]})]},t)})):(0,g.jsx)(s.SectionList,{renderItem:w,sections:D,py:"$1",renderSectionHeader:function({section:{title:e,status:t}}){return(0,g.jsxs)(s.XStack,{px:"$5",py:"$2",space:"$3",alignItems:"center",children:[t===b.lr.PENDING?(0,g.jsx)(s.Stack,{w:"$2",h:"$2",backgroundColor:"$textCaution",borderRadius:"$full"}):null,(0,g.jsx)(s.Heading,{size:"$headingSm",color:t===b.lr.PENDING?"$textCaution":"$textSubdued",children:e})]})},estimatedItemSize:"$10",ListEmptyComponent:(0,g.jsx)(s.Empty,{icon:"InboxOutline",title:t.formatMessage({id:y.ETranslations.global_no_results})})})]})};const modal_SwapHistoryListModal=function(){var e=(0,o.lq)(),{storeName:t}=e.params;return(0,g.jsx)(v.o,{storeName:t,children:(0,g.jsx)(SwapHistoryListModal,{storeName:t})})}},405405:(e,t,r)=>{function assign(e,t){if(null==e)throw new TypeError("assign requires that input parameter not be null or undefined");for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r]);return e}r.d(t,{A:()=>assign})},639794:(e,t,r)=>{r.d(t,{A:()=>cloneObject});var n=r(405405);function cloneObject(e){return(0,n.A)({},e)}},724726:(e,t,r)=>{r.d(t,{A:()=>formatDistanceStrict});var n=r(766017),a=r(57641),o=r(247803),i=r(95286),s=r(639794),l=r(405405),u=r(372231),c=r(981092),d=6e4,f=1440,m=30*f,h=365*f;function formatDistanceStrict(e,t,r){var y,p,b;(0,c.A)(2,arguments);var x=(0,n.q)(),g=null!==(y=null!==(p=null==r?void 0:r.locale)&&void 0!==p?p:x.locale)&&void 0!==y?y:u.A;if(!g.formatDistance)throw new RangeError("locale must contain localize.formatDistance property");var v=(0,o.A)(e,t);if(isNaN(v))throw new RangeError("Invalid time value");var A,D,S=(0,l.A)((0,s.A)(r),{addSuffix:Boolean(null==r?void 0:r.addSuffix),comparison:v});v>0?(A=(0,i.A)(t),D=(0,i.A)(e)):(A=(0,i.A)(e),D=(0,i.A)(t));var j,w=String(null!==(b=null==r?void 0:r.roundingMethod)&&void 0!==b?b:"round");if("floor"===w)j=Math.floor;else if("ceil"===w)j=Math.ceil;else{if("round"!==w)throw new RangeError("roundingMethod must be 'floor', 'ceil' or 'round'");j=Math.round}var M,T=D.getTime()-A.getTime(),$=T/d,k=(T-((0,a.A)(D)-(0,a.A)(A)))/d,C=null==r?void 0:r.unit;if("second"===(M=C?String(C):$<1?"second":$<60?"minute":$<f?"hour":k<m?"day":k<h?"month":"year")){var I=j(T/1e3);return g.formatDistance("xSeconds",I,S)}if("minute"===M){var N=j($);return g.formatDistance("xMinutes",N,S)}if("hour"===M){var E=j($/60);return g.formatDistance("xHours",E,S)}if("day"===M){var z=j(k/f);return g.formatDistance("xDays",z,S)}if("month"===M){var O=j(k/m);return 12===O&&"month"!==C?g.formatDistance("xYears",1,S):g.formatDistance("xMonths",O,S)}if("year"===M){var P=j(k/h);return g.formatDistance("xYears",P,S)}throw new RangeError("unit must be 'second', 'minute', 'hour', 'day', 'month' or 'year'")}},584941:(e,t,r)=>{r.d(t,{A:()=>formatDistanceToNow});var n=r(766017),a=r(247803),o=r(28268),i=r(847245),s=r(981092),l=r(362622);var u=r(372231),c=r(95286),d=r(639794),f=r(405405),m=r(57641),h=1440,y=2520,p=43200,b=86400;function formatDistance(e,t,r){var x,g;(0,s.A)(2,arguments);var v=(0,n.q)(),A=null!==(x=null!==(g=null==r?void 0:r.locale)&&void 0!==g?g:v.locale)&&void 0!==x?x:u.A;if(!A.formatDistance)throw new RangeError("locale must contain formatDistance property");var D=(0,a.A)(e,t);if(isNaN(D))throw new RangeError("Invalid time value");var S,j,w=(0,f.A)((0,d.A)(r),{addSuffix:Boolean(null==r?void 0:r.addSuffix),comparison:D});D>0?(S=(0,c.A)(t),j=(0,c.A)(e)):(S=(0,c.A)(e),j=(0,c.A)(t));var M,T=function differenceInSeconds(e,t,r){(0,s.A)(2,arguments);var n=(0,i.A)(e,t)/1e3;return(0,l.u)(null==r?void 0:r.roundingMethod)(n)}(j,S),$=((0,m.A)(j)-(0,m.A)(S))/1e3,k=Math.round((T-$)/60);if(k<2)return null!=r&&r.includeSeconds?T<5?A.formatDistance("lessThanXSeconds",5,w):T<10?A.formatDistance("lessThanXSeconds",10,w):T<20?A.formatDistance("lessThanXSeconds",20,w):T<40?A.formatDistance("halfAMinute",0,w):T<60?A.formatDistance("lessThanXMinutes",1,w):A.formatDistance("xMinutes",1,w):0===k?A.formatDistance("lessThanXMinutes",1,w):A.formatDistance("xMinutes",k,w);if(k<45)return A.formatDistance("xMinutes",k,w);if(k<90)return A.formatDistance("aboutXHours",1,w);if(k<h){var C=Math.round(k/60);return A.formatDistance("aboutXHours",C,w)}if(k<y)return A.formatDistance("xDays",1,w);if(k<p){var I=Math.round(k/h);return A.formatDistance("xDays",I,w)}if(k<b)return M=Math.round(k/p),A.formatDistance("aboutXMonths",M,w);if((M=(0,o.A)(j,S))<12){var N=Math.round(k/p);return A.formatDistance("xMonths",N,w)}var E=M%12,z=Math.floor(M/12);return E<3?A.formatDistance("aboutXYears",z,w):E<9?A.formatDistance("overXYears",z,w):A.formatDistance("almostXYears",z+1,w)}function formatDistanceToNow(e,t){return(0,s.A)(1,arguments),formatDistance(e,Date.now(),t)}},121684:(e,t,r)=>{r.d(t,{A:()=>formatDuration});var n=r(766017),a=r(372231),o=["years","months","weeks","days","hours","minutes","seconds"];function formatDuration(e,t){var r,i,s,l,u;if(arguments.length<1)throw new TypeError("1 argument required, but only ".concat(arguments.length," present"));var c=(0,n.q)(),d=null!==(r=null!==(i=null==t?void 0:t.locale)&&void 0!==i?i:c.locale)&&void 0!==r?r:a.A,f=null!==(s=null==t?void 0:t.format)&&void 0!==s?s:o,m=null!==(l=null==t?void 0:t.zero)&&void 0!==l&&l,h=null!==(u=null==t?void 0:t.delimiter)&&void 0!==u?u:" ";return d.formatDistance?f.reduce((function(t,r){var n="x".concat(r.replace(/(^.)/,(function(e){return e.toUpperCase()}))),a=e[r];return"number"==typeof a&&(m||e[r])?t.concat(d.formatDistance(n,a)):t}),[]).join(h):""}}}]);
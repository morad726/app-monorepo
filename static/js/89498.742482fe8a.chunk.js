"use strict";(self.webpackChunkweb=self.webpackChunkweb||[]).push([[89498],{309008:(e,t,r)=>{r.d(t,{o:()=>u});var o=r(324586),n=r(514041),i=r(325529),a=r(2577),s=r(597102),l=r(829561),c=r(831085);function ownKeys(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,o)}return r}function _objectSpread(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?ownKeys(Object(r),!0).forEach((function(t){(0,o.A)(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):ownKeys(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}var u=(0,n.memo)((function(e){var{children:t,storeName:r}=e,o=(0,l.x6)(r),n=a.A.getOrCreateStore(o);return(0,c.jsxs)(c.Fragment,{children:[(0,c.jsx)(s.H,_objectSpread({},o)),(0,c.jsx)(i.BY,{store:n,children:t})]})}));u.displayName="SwapProviderMirror"},589498:(e,t,r)=>{r.r(t),r.d(t,{default:()=>modal_SwapProviderSelectModal});var o=r(514041),n=r(724249),i=r(241440),a=r(908867),s=r(490343),l=r(60153),c=r(498356),u=r(325529),d=r(604343),m=r(254491),p=(r(663522),r(58546)),b=r(324586),f=r(839850),g=r(8904),j=r(17617),S=r(403144),x=r(831085),v=["providerLogo","lock"];function ownKeys(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,o)}return r}function _objectSpread(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?ownKeys(Object(r),!0).forEach((function(t){(0,b.A)(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):ownKeys(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function SwapProviderIcon(e){var{providerLogo:t,lock:r}=e,o=(0,f.A)(e,v),n=(0,a.A)();return(0,x.jsxs)(x.Fragment,{children:[(0,x.jsxs)(s.Image,_objectSpread(_objectSpread({size:"$10",borderRadius:"$2",delayMs:1e3},o),{},{children:[(0,x.jsx)(s.Image.Source,{source:{uri:t}}),(0,x.jsx)(s.Image.Fallback,{alignItems:"center",justifyContent:"center",bg:"$bgStrong",children:(0,x.jsx)(s.Icon,{name:"Image2MountainsSolid",color:"$iconDisabled"})})]})),r?(0,x.jsx)(s.Tooltip,{renderTrigger:(0,x.jsx)(s.Stack,{p:"$0.5",borderRadius:"$full",bg:"$bgSubdued",position:"absolute",right:"$-1",bottom:"$-1",children:(0,x.jsx)(s.Icon,{size:"$4",name:"LockOutline"})}),renderContent:(0,x.jsx)(s.SizableText,{size:"$bodySm",color:"$text",children:n.formatMessage({id:m.ETranslations.provider_approval_require})}),placement:"bottom-start"}):null]})}var y=r(391944);function SwapRoutePaths_ownKeys(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,o)}return r}function SwapRoutePaths_objectSpread(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?SwapRoutePaths_ownKeys(Object(r),!0).forEach((function(t){(0,b.A)(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):SwapRoutePaths_ownKeys(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}const h=(0,o.memo)((function({routeContent:e}){return(0,x.jsxs)(s.Stack,{pt:"$3.5",children:["string"==typeof e?(0,x.jsx)(s.SizableText,{size:"$bodySm",color:"$textSubdued",children:e}):null,Array.isArray(e)?(0,x.jsx)(x.Fragment,{children:e.map((function(e,t){return(0,x.jsxs)(s.XStack,SwapRoutePaths_objectSpread(SwapRoutePaths_objectSpread({},0!==t&&{mt:"$3.5"}),{},{justifyContent:"space-between",children:[(0,x.jsx)(s.XStack,{position:"absolute",top:0,left:0,right:0,h:"$3.5",alignItems:"flex-end",space:"$1",children:(0,x.jsx)(s.XStack,{px:"$4",flex:1,space:"$1",alignItems:"center",children:new Array(40).fill(null).map((function(e,t){return(0,x.jsx)(s.Stack,{h:"$0.5",bg:"$borderSubdued",flex:1},t)}))})}),e.map((function(e,t){var r="$"+(4+4*e.images.length);return(0,x.jsxs)(s.Stack,{alignItems:"center",children:[(0,x.jsx)(s.XStack,{bg:"$bgApp",maxWidth:r,children:e.images.map((function(e,t){return(0,x.jsx)(y.o,SwapRoutePaths_objectSpread({size:"sm",tokenImageUri:e.logoImageUri},0!==t&&{ml:"$-2.5"}),t)}))}),(0,x.jsx)(s.Stack,{maxWidth:"$16",$gtMd:{maxWidth:"$24"},children:(0,x.jsx)(s.SizableText,{pt:"$1.5",size:"$bodySmMedium",color:"$textSubdued",numberOfLines:1,children:e.label})})]},t)}))]}),t)}))}):null]})}));var $=["providerResult","currencySymbol","fromToken","fromTokenAmount","toToken","selected","disabled"];function SwapProviderListItem_ownKeys(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,o)}return r}function SwapProviderListItem_objectSpread(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?SwapProviderListItem_ownKeys(Object(r),!0).forEach((function(t){(0,b.A)(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):SwapProviderListItem_ownKeys(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}const w=(0,o.memo)((function(e){var{providerResult:t,currencySymbol:r,fromToken:n,fromTokenAmount:l,toToken:c,selected:u,disabled:d}=e,p=(0,f.A)(e,$),b=(0,a.A)(),v=(0,o.useMemo)((function(){return t.fee?.estimatedFeeFiatValue?(0,x.jsxs)(s.XStack,{space:"$1",alignItems:"center",children:[(0,x.jsx)(s.Tooltip,{renderTrigger:(0,x.jsx)(s.Icon,{name:"GasOutline",size:"$4",color:"$iconSubdued"}),renderContent:(0,x.jsx)(s.SizableText,{size:"$bodySm",color:"$text",children:b.formatMessage({id:m.ETranslations.provider_network_fee})}),placement:"bottom-start"}),(0,x.jsx)(s.NumberSizeableText,{size:"$bodyMd",color:"$textSubdued",formatter:"value",formatterOptions:{currency:r},children:t.fee.estimatedFeeFiatValue})]}):null}),[r,b,t.fee?.estimatedFeeFiatValue]),y=(0,o.useMemo)((function(){if(t.estimatedTime){var e,r=new i.A(t.estimatedTime),o=new i.A(60);if(r.isLessThan(o))e="< 1min";else e=`${r.dividedBy(60).integerValue(i.A.ROUND_UP).toNumber()}min`;return(0,x.jsxs)(s.XStack,{space:"$1",alignItems:"center",children:[(0,x.jsx)(s.Tooltip,{renderTrigger:(0,x.jsx)(s.Icon,{name:"ClockTimeHistoryOutline",size:"$4",color:"$iconSubdued"}),renderContent:(0,x.jsx)(s.SizableText,{size:"$bodySm",color:"$text",children:b.formatMessage({id:m.ETranslations.provider_swap_duration})}),placement:"bottom-start"}),(0,x.jsx)(s.SizableText,{size:"$bodyMd",color:"$textSubdued",children:e})]})}return null}),[b,t.estimatedTime]),w=(0,o.useMemo)((function(){var e;return(0,x.jsxs)(s.XStack,{space:"$1",alignItems:"center",children:[(0,x.jsx)(s.Tooltip,{renderTrigger:(0,x.jsx)(s.Icon,{name:"HandCoinsOutline",size:"$4",color:"$iconSubdued"}),renderContent:(0,x.jsx)(s.SizableText,{size:"$bodySm",color:"$text",children:b.formatMessage({id:m.ETranslations.provider_protocol_fee})}),placement:"bottom-start"}),(0,x.jsx)(s.NumberSizeableText,{size:"$bodyMd",color:"$textSubdued",formatter:"value",formatterOptions:{currency:r},children:null!=(e=t.fee?.protocolFees)?e:0})]})}),[r,b,t.fee?.protocolFees]),O=(0,o.useMemo)((function(){if(d)return t?.errorMessage||b.formatMessage({id:m.ETranslations.provider_route_unable_fetch_price});if(t.limit){var e=new i.A(null!=l?l:0);if(t.limit.min){var r,o=new i.A(t.limit.min);if(e.lt(o))return b.formatMessage({id:m.ETranslations.provider_min_amount_required},{amount:(0,S.jq)(t.limit.min,{formatter:"balance"}),token:null!=(r=n?.symbol)?r:"unknown"})}if(t.limit.max){var a,s=new i.A(t.limit.max);if(e.gt(s))return b.formatMessage({id:m.ETranslations.provider_max_amount_required},{amount:(0,S.jq)(t.limit.max,{formatter:"balance"}),token:null!=(a=n?.symbol)?a:"unknown"})}}var u;return t.toAmount?`${(0,S.jq)(t.toAmount,{formatter:"balance"})} ${null!=(u=c?.symbol)?u:"unknown"}`:""}),[d,n?.symbol,l,b,t?.errorMessage,t.limit,t.toAmount,c?.symbol]),[_,T]=(0,o.useState)(!1),A=(0,o.useMemo)((function(){var e;return null!=(e=t.routesData?.map((function(e){var t,r={images:[{logoImageUri:n?.logoURI}],label:e.part?`${e.part}%`:""},o={images:[{logoImageUri:c?.logoURI}],label:""};return[r,...null!=(t=e.subRoutes?.map((function(e){var t,r=null!=(t=e?.map((function(e){return{logoImageUri:e.logo}})))?t:[];r=r?.length>3?r.slice(0,3):r;var o="protocols";return 1===e.length&&(o=e[0].name),{images:r,label:o}})))?t:[],o]})))?e:[]}),[n?.logoURI,t.routesData,c?.logoURI]),P=(0,o.useMemo)((function(){var e=t.routesData;return t.protocolNoRouterInfo?(0,x.jsx)(s.SizableText,{size:"$bodySm",color:"$textSubdued",mt:"$3.5",children:t.protocolNoRouterInfo}):e?.[0]?.subRoutes?.[0]?.length?(0,x.jsx)(h,{routeContent:A}):(0,x.jsx)(s.SizableText,{size:"$bodySm",color:"$textSubdued",mt:"$3.5",children:b.formatMessage({id:m.ETranslations.provider_route_no_information})})}),[b,t.protocolNoRouterInfo,t.routesData,A]);return(0,x.jsxs)(s.Stack,SwapProviderListItem_objectSpread(SwapProviderListItem_objectSpread({role:"button",group:"card",borderRadius:"$4",my:"$2",overflow:"hidden",borderCurve:"continuous",opacity:d?.5:1,borderWidth:j.A.hairlineWidth,borderColor:u?"$borderActive":"$borderSubdued",userSelect:"none",focusStyle:{outlineWidth:2,outlineColor:"$focusRing",outlineStyle:"solid",outlineOffset:2}},p),{},{children:[(0,x.jsxs)(s.XStack,{px:"$3.5",py:"$3",bg:"$bgSubdued","$group-card-hover":{bg:"$bgHover"},alignItems:"center",children:[(0,x.jsx)(s.Stack,{children:(0,x.jsx)(SwapProviderIcon,{providerLogo:t.info.providerLogo,lock:!!t.allowanceResult})}),(0,x.jsxs)(s.Stack,{px:"$3",flex:1,children:[(0,x.jsx)(s.SizableText,{color:"$text",size:"$bodyLgMedium",children:O}),(0,x.jsx)(s.SizableText,{color:"$textSubdued",size:"$bodyMdMedium",pt:"$1",children:t.info.providerName})]}),t.isBest||t.receivedBest||t.minGasCost?(0,x.jsxs)(s.XStack,{flexWrap:"wrap",justifyContent:"flex-end",m:-3,flex:1,children:[t.isBest?(0,x.jsx)(s.Stack,{p:3,children:(0,x.jsx)(s.Badge,{badgeType:"success",children:b.formatMessage({id:m.ETranslations.provider_label_overall_best})})}):null,t.receivedBest?(0,x.jsx)(s.Stack,{p:3,children:(0,x.jsx)(s.Badge,{badgeType:"info",children:b.formatMessage({id:m.ETranslations.provider_label_max_received})})}):null,t.minGasCost?(0,x.jsx)(s.Stack,{p:3,children:(0,x.jsx)(s.Badge,{badgeType:"info",children:b.formatMessage({id:m.ETranslations.provider_label_min_fee})})}):null]}):null]}),t.toAmount?(0,x.jsxs)(s.Stack,{py:"$2",px:"$3.5",children:[(0,x.jsxs)(s.XStack,{space:"$3.5",alignItems:"center",children:[v,y,w,(0,x.jsxs)(s.XStack,{role:"button",borderRadius:"$2",alignItems:"center",onPress:function(e){T(!_),e.stopPropagation()},ml:"auto",pr:"$1",my:"$-0.5",py:"$0.5",mr:"$-1","$platform-native":{hitSlop:{top:8,left:8,right:8,bottom:8}},hoverStyle:{bg:"$bgHover"},pressStyle:{bg:"$bgActive"},focusStyle:{outlineWidth:2,outlineColor:"$focusRing",outlineStyle:"solid"},children:[(0,x.jsx)(s.SizableText,{pl:"$2",size:"$bodySmMedium",color:"$textSubdued",children:b.formatMessage({id:m.ETranslations.provider_route})}),(0,x.jsx)(g.S,SwapProviderListItem_objectSpread(SwapProviderListItem_objectSpread({},_?{from:{rotate:"0deg"},animate:{rotate:"90deg"}}:{from:{rotate:"90deg"},animate:{rotate:"0deg"}}),{},{transition:{type:"timing",duration:150},children:(0,x.jsx)(s.Icon,{name:"ChevronRightSmallOutline",size:"$5",color:"$iconSubdued"})}))]})]}),(0,x.jsx)(s.HeightTransition,{children:_?P:null})]}):null]}))}));var O=r(309008),_=function(e){return e.AVAILABLE="Available",e.UNAVAILABLE="Unavailable",e}(_||{}),SwapProviderSelectModal=function(){var e=(0,c.A)(),t=(0,a.A)(),[r]=(0,u.pd)(),[n]=(0,u.VS)(),[b]=(0,u.NE)(),[f]=(0,u.Q8)(),[,g]=(0,u.wG)(),[j,S]=(0,u.tb)(),[v]=(0,d.useSettingsPersistAtom)(),[y]=(0,u.Zr)(),h=(0,o.useCallback)((function(e){S(e),l.A.simpleDb.swapConfigs.setRawData({providerSort:e})}),[S]),$=(0,o.useMemo)((function(){return[{label:t.formatMessage({id:m.ETranslations.provider_recommend}),value:p.cw.RECOMMENDED},{label:t.formatMessage({id:m.ETranslations.provider_sort_item_gas}),value:p.cw.GAS_FEE},{label:t.formatMessage({id:m.ETranslations.provider_sort_item_swap_duration}),value:p.cw.SWAP_DURATION},{label:t.formatMessage({id:m.ETranslations.provider_sort_item_received}),value:p.cw.RECEIVED}]}),[t]),O=(0,o.useMemo)((function(){var e=r.filter((function(e){return e.toAmount&&!e.limit?.min&&!e.limit?.max})),o=r.filter((function(e){return!e.toAmount||e.limit?.min||e.limit?.max}));return[...e?.length>0?[{title:"Available",type:_.AVAILABLE,data:e}]:[],...o?.length>0?[{title:t.formatMessage({id:m.ETranslations.provider_unavailable}),type:_.UNAVAILABLE,data:o}]:[]]}),[t,r]),T=(0,o.useCallback)((function(t){g(t),e.pop()}),[e,g]),A=(0,o.useCallback)((function({item:e}){var t=!e.toAmount,r=new i.A(null!=n?n:0);if(e.limit){if(e.limit.min){var o=new i.A(e.limit.min);r.lt(o)&&(t=!1)}if(e.limit.max){var a=new i.A(e.limit.max);r.gt(a)&&(t=!1)}}return(0,x.jsx)(w,{onPress:t?void 0:function(){T(e)},selected:Boolean(e.info.provider===y?.info.provider&&e.info.providerName===y?.info.providerName),fromTokenAmount:n,fromToken:b,toToken:f,providerResult:e,currencySymbol:v.currencyInfo.symbol,disabled:t})}),[y?.info.provider,y?.info.providerName,b,n,T,v.currencyInfo.symbol,f]),P=(0,o.useCallback)((function(){return null}),[t]);return(0,x.jsxs)(s.Page,{children:[(0,x.jsx)(s.Page.Header,{headerRight:P}),(0,x.jsx)(s.SectionList,{px:"$5",pt:"$2",pb:"$4",estimatedItemSize:"$10",renderItem:A,sections:O,renderSectionHeader:function({section:{type:e,title:r}}){return e===_.AVAILABLE?(0,x.jsx)(s.Select,{title:t.formatMessage({id:m.ETranslations.provider_sort_title}),items:$,onChange:h,value:j,renderTrigger:function({value:e,label:t,placeholder:r}){return(0,x.jsx)(s.Button,{mt:"$1",alignSelf:"flex-start",variant:"tertiary",icon:"FilterSortSolid",iconAfter:"ChevronDownSmallOutline",children:(0,x.jsx)(s.SizableText,{size:"$bodyMd",children:e?t:r})})}}):(0,x.jsx)(s.SectionList.SectionHeader,{title:r,px:"$0"})}})]})};const modal_SwapProviderSelectModal=function(){var e=(0,n.lq)(),{storeName:t}=e.params;return(0,x.jsx)(O.o,{storeName:t,children:(0,x.jsx)(SwapProviderSelectModal,{})})}}}]);
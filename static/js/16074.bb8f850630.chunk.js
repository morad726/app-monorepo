"use strict";(self.webpackChunkweb=self.webpackChunkweb||[]).push([[16074],{461483:(e,t,s)=>{s.d(t,{A:()=>__WEBPACK_DEFAULT_EXPORT__});var n=s(586330),r=s(514041),i=s(908867),o=s(490343),a=s(60153),l=s(254491),c=s(509388),u=s(831085);const __WEBPACK_DEFAULT_EXPORT__=function({oldEncodedPassword:e,onUpdateRes:t}){var s,[d,f]=(0,r.useState)(!1),p=(0,i.A)(),g=(0,r.useCallback)((s=(0,n.A)((function*(s){f(!0);try{if(s.confirmPassword!==s.password)return void o.Toast.error({title:p.formatMessage({id:l.ETranslations.auth_error_password_not_match})});var n=yield a.A.servicePassword.encodeSensitiveText({text:s.password}),r=yield a.A.servicePassword.updatePassword(e,n);t(r),o.Toast.success({title:p.formatMessage({id:l.ETranslations.auth_password_set})})}catch(e){o.Toast.error({title:p.formatMessage({id:l.ETranslations.auth_new_password_same_as_old})})}f(!1)})),function(e){return s.apply(this,arguments)}),[e,t,p]);return(0,u.jsx)(c.A,{loading:d,onSetupPassword:g,confirmBtnText:p.formatMessage({id:l.ETranslations.global_confirm})})}},536612:(e,t,s)=>{s.d(t,{SX:()=>useAppUpdateInfo,sx:()=>useDownloadPackage,x7:()=>useAppChangeLog});var n=s(324586),r=s(586330),i=s(514041),o=s(908867),a=s(490343),l=s(604343),c=s(713132),u=s(254491),d=s(639451),f=s(757559),p=s(584186),g=s(60153),m=s(498356),h=s(911998);function ownKeys(e,t){var s=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),s.push.apply(s,n)}return s}function _objectSpread(e){for(var t=1;t<arguments.length;t++){var s=null!=arguments[t]?arguments[t]:{};t%2?ownKeys(Object(s),!0).forEach((function(t){(0,n.A)(e,t,s[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(s)):ownKeys(Object(s)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(s,t))}))}return e}var useAppChangeLog=function(e){var t=(0,h.yk)((function(){return e?g.A.serviceAppUpdate.fetchChangeLog():Promise.resolve(null)}),[e]);return(0,i.useMemo)((function(){return t.result}),[t.result])},useDownloadPackage=function(){var e,t=(0,o.A)();return(0,i.useCallback)((e=(0,r.A)((function*(e){try{yield g.A.serviceAppUpdate.startDownloading();var s=yield(0,d.Xo)(e);yield g.A.serviceAppUpdate.verifyPackage(s),yield Promise.all([(0,d.sB)(s),p.A.wait(3e3)]),yield g.A.serviceAppUpdate.readyToInstall()}catch(e){a.Toast.error({title:t.formatMessage({id:u.ETranslations.global_update_failed})}),g.A.serviceAppUpdate.notifyFailed(e)}})),function(t){return e.apply(this,arguments)}),[t])},useAppUpdateInfo=function(e=!1){var t=(0,o.A)(),[s]=(0,l.useAppUpdatePersistAtom)(),n=(0,m.A)(),r=useDownloadPackage(),p=(0,i.useCallback)((function(){setTimeout((function(){(e?n.pushFullModal:n.pushModal)(f.ry.AppUpdateModal,{screen:f.mk.WhatsNew})}))}),[e,n.pushFullModal,n.pushModal]),h=(0,i.useCallback)((function(e=!1,t){(e?n.pushFullModal:n.pushModal)(f.ry.AppUpdateModal,{screen:f.mk.UpdatePreview,params:_objectSpread({latestVersion:s.latestVersion,isForceUpdate:s.isForceUpdate,autoClose:e},t)})}),[s.isForceUpdate,s.latestVersion,n.pushFullModal,n.pushModal]);(0,i.useEffect)((function(){(0,c.fK)(s)&&p(),s.status===c.ue.downloading&&r(s),g.A.serviceAppUpdate.fetchAppUpdateInfo().then((function(e){e?.isForceUpdate&&(0,c._q)(e.latestVersion,e.status)&&h(!0,e)}))}),[]);var y=(0,i.useCallback)((function(){switch(s.status){case c.ue.notify:case c.ue.downloading:case c.ue.verifying:h(e);break;case c.ue.ready:(0,d.Ed)(s).catch((function(e){a.Toast.error({title:t.formatMessage({id:u.ETranslations.global_update_failed})}),g.A.serviceAppUpdate.notifyFailed(e)}));break;case c.ue.failed:r(s)}}),[s,r,t,e,h]);return(0,i.useMemo)((function(){return{isNeedUpdate:(0,c._q)(s.latestVersion,s.status),data:s,onUpdateAction:y,toUpdatePreviewPage:h,onViewReleaseInfo:p}}),[s,y,p,h])}},447479:(e,t,s)=>{s.d(t,{I:()=>useOptions});var n=s(514041),r=s(908867),i=s(507026),o=s(254491);function useOptions(){var e=(0,r.A)();return(0,n.useMemo)((function(){return[{title:e.formatMessage({id:o.ETranslations.global_always}),value:i.J.Always},{title:e.formatMessage({id:o.ETranslations.settings_if_away_for_1_min}),value:i.J.Minute},{title:e.formatMessage({id:o.ETranslations.settings_if_away_for_5_mins}),value:i.J.Minute5},{title:e.formatMessage({id:o.ETranslations.settings_if_away_for_30_mins}),value:i.J.Minute30},{title:e.formatMessage({id:o.ETranslations.settings_if_away_for_1_hr}),value:i.J.Hour},{title:e.formatMessage({id:o.ETranslations.settings_if_away_for_4_hrs}),value:i.J.Hour4},{title:e.formatMessage({id:o.ETranslations.global_never}),value:i.J.Never}]}),[e])}},415902:(e,t,s)=>{s.d(t,{_:()=>StartTimePanel});var n=s(490343),r=s(318003),i=s(831085);function StartTimePanel(){var{jsBundleLoadedTime:e,fpTime:t}=(0,r.useMeasureTime)();return(0,i.jsxs)(n.YStack,{children:[(0,i.jsxs)(n.SizableText,{children:["JS Bundle 加载执行时长: ",e]}),(0,i.jsxs)(n.SizableText,{children:["界面渲染时长: ",t-e]}),(0,i.jsxs)(n.SizableText,{children:["启动总时长: ",t]})]})}},460627:(e,t,s)=>{s.d(t,{u:()=>l});var n,r=s(586330),i=s(60153),o=s(213644),a=s(520202),l=(n=(0,r.A)((function*(e){var t=`${e}.txt`;o.U.setting.device.logDeviceInfo(),yield(0,a.of)(1e3);var s=yield i.A.serviceLogger.getAllMsg(),n=document.createElement("a"),r=new Blob(s,{type:"text/plain",endings:"native"});n.href=URL.createObjectURL(r),n.download=t,document.body.appendChild(n),n.click()})),function exportLogs(e){return n.apply(this,arguments)})},716074:(e,t,s)=>{s.r(t),s.d(t,{default:()=>SettingListModal});var n,r,i,o=s(586330),a=s(514041),l=s(724249),c=s(908867),u=s(490343),d=s(60153),f=s(164208),p=s(604343),g=s(726130),m=s(254491),h=s(663522),y=s(117746),b=0,v=!1,x=(r=(0,o.A)((function*(){return new Promise((function(e,t){u.Dialog.show({title:"Danger Zone",tone:"warning",icon:"ErrorOutline",description:"Are you sure you want to enable developer-related features?",dismissOnOverlayPress:!1,confirmButtonProps:{testID:"confirm-button"},onConfirm:e,onCancel:function(e){e(),t(new Error("User canceled"))}})}))})),function showPromoteDialog(){return r.apply(this,arguments)}),j=(i=(0,o.A)((function*(e){var t=new Date;if(0===b&&e(),!v&&(void 0===n||Math.round(t.getTime()-n.getTime())>5e3?(n=t,b=0):b+=1,b>=9)){v=!0;try{yield x(),yield d.A.servicePassword.promptPasswordVerify({dialogProps:{confirmButtonProps:{testID:"confirm-button"},description:"Danger Zone: Are you sure you want to enable developer-related features?",dismissOnOverlayPress:!1}}),yield d.A.serviceDevSetting.switchDevMode(!0)}catch(e){}finally{b=0,v=!1}}})),function handleOpenDevMode(e){return i.apply(this,arguments)}),_=s(791088),P=s(498356),A=s(757559),w=s(324586),S=s(831085);function ownKeys(e,t){var s=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),s.push.apply(s,n)}return s}function _objectSpread(e){for(var t=1;t<arguments.length;t++){var s=null!=arguments[t]?arguments[t]:{};t%2?ownKeys(Object(s),!0).forEach((function(t){(0,w.A)(e,t,s[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(s)):ownKeys(Object(s)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(s,t))}))}return e}var Section=function({title:e,titleProps:t,children:s}){return(0,S.jsxs)(u.Stack,{children:[(0,S.jsx)(u.SizableText,_objectSpread(_objectSpread({size:"$headingSm",paddingHorizontal:"$4",paddingBottom:"$2",paddingTop:"$5",color:"$textSubdued"},t),{},{children:e})),(0,S.jsx)(u.Stack,{children:s})]})},HardwareBridgeListItems=function(){var e=(0,a.useCallback)((function(){(0,y.Dr)(g.By)}),[]),t=(0,c.A)();return(0,S.jsx)(S.Fragment,{children:(0,S.jsx)(_.c,{onPress:e,icon:"ApiConnectionOutline",title:t.formatMessage({id:m.ETranslations.settings_hardware_bridge_status}),children:(0,S.jsx)(_.c.IconButton,{disabled:!0,icon:"ArrowTopRightOutline",iconProps:{color:"$iconActive"}})})})},AdvancedSection=function(){var e=(0,c.A)(),t=(0,P.A)(),s=(0,a.useCallback)((function(){t.push(A.Pj.SettingAccountDerivationModal)}),[t]),n=(0,a.useCallback)((function(){t.push(A.Pj.SettingCustomRPC)}),[t]);return(0,S.jsxs)(Section,{title:e.formatMessage({id:m.ETranslations.global_advanced}),children:[(0,S.jsx)(_.c,{onPress:n,icon:"BezierNodesOutline",title:e.formatMessage({id:m.ETranslations.custom_rpc_title}),drillIn:!0}),(0,S.jsx)(_.c,{onPress:s,icon:"BranchesOutline",title:e.formatMessage({id:m.ETranslations.settings_account_derivation_path}),drillIn:!0}),(0,S.jsx)(HardwareBridgeListItems,{})]})},T=(s(911998),s(833800)),D=s(318822),AddressBookItem=function(){var e=(0,c.A)(),t=(0,P.A)(),s=(0,a.useCallback)((0,o.A)((function*(){yield d.A.servicePassword.promptPasswordVerify(),t.push(A.sv.ListItemModal)})),[t]),[{hideDialogInfo:n}]=(0,p.useAddressBookPersistAtom)(),r=(0,a.useCallback)((0,o.A)((function*(){var t;n?yield s():u.Dialog.show({title:e.formatMessage({id:m.ETranslations.address_book_encrypted_storage_title}),icon:"ShieldKeyholeOutline",description:e.formatMessage({id:m.ETranslations.address_book_encrypted_storage_description}),tone:"default",showConfirmButton:!0,showCancelButton:!1,onConfirmText:e.formatMessage({id:m.ETranslations.address_book_button_next}),onConfirm:(t=(0,o.A)((function*(e){yield e.close(),yield s(),yield d.A.serviceAddressBook.hideDialogInfo()})),function onConfirm(e){return t.apply(this,arguments)}),confirmButtonProps:{testID:"encrypted-storage-confirm"}})})),[s,n,e]);return(0,S.jsx)(_.c,{icon:"ContactsOutline",title:e.formatMessage({id:m.ETranslations.settings_address_book}),drillIn:!0,onPress:r,testID:"setting-address-book"})},LockNowButton=function(){var e=(0,c.A)(),t=(0,P.A)(),[s]=(0,p.usePasswordPersistAtom)(),n=(0,a.useCallback)((0,o.A)((function*(){s.isPasswordSet||(yield d.A.servicePassword.promptPasswordVerify()),yield d.A.servicePassword.lockApp(),t.popStack()})),[s.isPasswordSet,t]);return(0,S.jsx)(_.c,{icon:"LockOutline",title:e.formatMessage({id:m.ETranslations.settings_lock_now}),onPress:n})},DefaultSection=function(){var e=(0,c.A)(),t=(0,P.A)();(0,T.S)();return(0,S.jsxs)(u.YStack,{children:[(0,S.jsx)(LockNowButton,{}),null,(0,S.jsx)(AddressBookItem,{}),null,null,(0,S.jsx)(_.c,{icon:"OnekeyKeytagOutline",title:e.formatMessage({id:m.ETranslations.global_onekey_keytag}),drillIn:!0,onPress:function(){t.pushModal(A.ry.KeyTagModal,{screen:A.ex.UserOptions})}})]})},O=s(265767),E=s(536039),C=(s(567807),s(215341)),M=s(281464),I=s(839850),k=["title","onPress","copyable"];function SectionPressItem_ownKeys(e,t){var s=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),s.push.apply(s,n)}return s}function SectionPressItem(e){var{title:t,onPress:s,copyable:n}=e,r=(0,I.A)(e,k),{copyText:i}=(0,u.useClipboard)(),o=(0,a.useCallback)((function(){i(t)}),[i,t]);return(0,S.jsx)(_.c,function SectionPressItem_objectSpread(e){for(var t=1;t<arguments.length;t++){var s=null!=arguments[t]?arguments[t]:{};t%2?SectionPressItem_ownKeys(Object(s),!0).forEach((function(t){(0,w.A)(e,t,s[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(s)):SectionPressItem_ownKeys(Object(s)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(s,t))}))}return e}({drillIn:!0,onPress:n?o:s,title:t,titleProps:{color:"$textCritical"}},r))}var AddressBookDevSetting=function(){var e=(0,a.useCallback)((0,o.A)((function*(){u.Dialog.show({title:"Tamper Address Book",description:"This is a feature specific to development environments. Function used to simulate address data being tampered with",confirmButtonProps:{variant:"destructive"},onConfirm:function(){d.A.serviceAddressBook.__dangerTamperVerifyHashForTest()}})})),[]);return(0,S.jsx)(SectionPressItem,{title:"Hack Address Book",testID:"temper-address-book",onPress:e})};function CrashDevSettings(){var[e,t]=(0,a.useState)({a:{b:{c:"text"}}});return(0,S.jsx)(SectionPressItem,{title:`Crash Test ${e.a.b.c}`,onPress:function(){t("")}})}function SectionFieldItem_ownKeys(e,t){var s=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),s.push.apply(s,n)}return s}function SectionFieldItem_objectSpread(e){for(var t=1;t<arguments.length;t++){var s=null!=arguments[t]?arguments[t]:{};t%2?SectionFieldItem_ownKeys(Object(s),!0).forEach((function(t){(0,w.A)(e,t,s[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(s)):SectionFieldItem_ownKeys(Object(s)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(s,t))}))}return e}function SectionFieldItem({name:e,title:t,subtitle:s,children:n,onValueChange:r,titleProps:i={color:"$textCritical"},testID:l=""}){var[c]=(0,p.useDevSettingsPersistAtom)(),u=a.Children.only(n),f=e?c?.settings?.[e]:"",g=(0,a.useCallback)(function(){var t=(0,o.A)((function*(t){e&&(yield d.A.serviceDevSetting.updateDevSetting(e,t),r?.(t))}));return function(e){return t.apply(this,arguments)}}(),[e,r]),m=u?(0,a.cloneElement)(u,SectionFieldItem_objectSpread(SectionFieldItem_objectSpread({},u.props),{},{value:f,onChange:g})):null;return(0,S.jsx)(_.c,{title:t,subtitle:s,titleProps:i,testID:l,children:m})}var F=s(415902);function DevSettingsSection_ownKeys(e,t){var s=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),s.push.apply(s,n)}return s}function DevSettingsSection_objectSpread(e){for(var t=1;t<arguments.length;t++){var s=null!=arguments[t]?arguments[t]:{};t%2?DevSettingsSection_ownKeys(Object(s),!0).forEach((function(t){(0,w.A)(e,t,s[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(s)):DevSettingsSection_ownKeys(Object(s)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(s,t))}))}return e}function showDevOnlyPasswordDialog({title:e,description:t,onConfirm:s,confirmButtonProps:n}){u.Dialog.show({title:e,description:t,confirmButtonProps:DevSettingsSection_objectSpread({variant:"destructive"},n),renderContent:(0,S.jsx)(u.Dialog.Form,{formProps:{values:{password:""}},children:(0,S.jsx)(u.Dialog.FormField,{name:"password",rules:{required:{value:!0,message:"password is required."}},children:(0,S.jsx)(u.Input,{testID:"dev-only-password",placeholder:"devOnlyPassword"})})}),onConfirm:function(){var e=(0,o.A)((function*({getForm:e}){var t=e();if(t){yield t.trigger();var{password:n}=t.getValues()||{};if(!(0,E.tB)(n))return;var r={$$devOnlyPassword:n};yield s(r)}}));return function onConfirm(t){return e.apply(this,arguments)}}()})}var DevSettingsSection=function(){var[e]=(0,p.useSettingsPersistAtom)(),[t]=(0,O.LA)(),s=(0,c.A)(),n=(0,P.A)(),{copyText:r}=(0,u.useClipboard)(),i=(0,a.useCallback)((function(){u.Dialog.show({title:"关闭开发者模式",onConfirm:function(){d.A.serviceDevSetting.switchDevMode(!1)}})}),[]);(0,a.useCallback)((function(){showDevOnlyPasswordDialog({title:"Danger Zone: Open Chrome DevTools",onConfirm:function(){var e=(0,o.A)((function*(){window?.desktopApi.openDevTools()}));return function onConfirm(){return e.apply(this,arguments)}}()})}),[]);return t.enabled?(0,S.jsxs)(Section,{title:s.formatMessage({id:m.ETranslations.global_dev_mode}),titleProps:{color:"$textCritical"},children:[(0,S.jsx)(SectionPressItem,{title:"关闭开发者模式",onPress:i}),null,(0,S.jsx)(SectionPressItem,{copyable:!0,title:e.instanceId,subtitle:"InstanceId"}),h.Ay.githubSHA?(0,S.jsx)(SectionPressItem,{copyable:!0,title:h.Ay.githubSHA,subtitle:"BuildHash"}):null,(0,S.jsx)(SectionFieldItem,{name:"enableTestEndpoint",title:"启用 OneKey 测试网络节点",subtitle:t.settings?.enableTestEndpoint?g.Nv:g.E5,onValueChange:function(e){setTimeout((function(){d.A.serviceApp.restartApp()}),300)},children:(0,S.jsx)(u.Switch,{size:u.ESwitchSize.small})}),(0,S.jsx)(SectionFieldItem,{name:"showDevOverlayWindow",title:"开发者悬浮窗",subtitle:"始终悬浮于全局的开发调试工具栏",testID:"show-dev-overlay",children:(0,S.jsx)(u.Switch,{size:u.ESwitchSize.small})}),(0,S.jsx)(SectionFieldItem,{name:"alwaysSignOnlySendTx",title:"始终只签名不广播",testID:"always-sign-only-send-tx",children:(0,S.jsx)(u.Switch,{size:u.ESwitchSize.small})}),(0,S.jsx)(SectionFieldItem,{name:"showDevExportPrivateKey",title:"首页导出私钥临时入口",subtitle:"",testID:"export-private-key",children:(0,S.jsx)(u.Switch,{size:u.ESwitchSize.small})}),(0,S.jsx)(SectionPressItem,{title:"Export Accounts Data",onPress:function(){var e;showDevOnlyPasswordDialog({title:"Danger Zone",description:"Export Accounts Data",onConfirm:(e=(0,o.A)((function*(e){u.Dialog.cancel({title:"Export Accounts Data",renderContent:(0,S.jsx)(u.YStack,{children:(0,S.jsx)(SectionPressItem,{title:"Export Accounts Data",onPress:(0,o.A)((function*(){var t=yield d.A.serviceE2E.exportAllAccountsData(e);r((0,M.JB)(t))}))})})})})),function onConfirm(t){return e.apply(this,arguments)})})}}),(0,S.jsx)(SectionPressItem,{title:"FirmwareUpdateDevSettings",testID:"firmware-update-dev-settings-menu",onPress:function(){n.push(A.Pj.SettingDevFirmwareUpdateModal)}}),(0,S.jsx)(SectionPressItem,{title:"V4MigrationDevSettings",testID:"v4-migration-dev-settings-menu",onPress:function(){u.Dialog.show({title:"!!!!  Danger Zone: Clear all your data",description:"This is a feature specific to development environments. Function used to erase all data in the app.",confirmButtonProps:{variant:"destructive"},onConfirm:function(){n.push(A.Pj.SettingDevV4MigrationModal)}})}}),(0,S.jsx)(SectionPressItem,{title:"Clear App Data (E2E release only)",testID:"clear-data-menu",onPress:function(){var e;showDevOnlyPasswordDialog({title:"Danger Zone: Clear all your data",confirmButtonProps:{variant:"destructive",testID:"clear-double-confirm"},description:"This is a feature specific to development environments.\n                  Function used to erase all data in the app.",onConfirm:(e=(0,o.A)((function*(e){u.Dialog.cancel({title:"Clear App Data (E2E release only)",renderContent:(0,S.jsxs)(u.YStack,{children:[(0,S.jsx)(SectionPressItem,{title:"Clear Discovery Data",testID:"clear-discovery-data",onPress:(0,o.A)((function*(){yield d.A.serviceE2E.clearDiscoveryPageData(e),u.Toast.success({title:"Success"})}))}),(0,S.jsx)(SectionPressItem,{title:"Clear Address Book Data",testID:"clear-address-book-data",onPress:(0,o.A)((function*(){yield d.A.serviceE2E.clearAddressBook(e),u.Toast.success({title:"Success"})}))}),(0,S.jsx)(SectionPressItem,{title:"Clear Wallets & Accounts Data",testID:"clear-wallets-data",onPress:(0,o.A)((function*(){yield d.A.serviceE2E.clearWalletsAndAccounts(e),u.Toast.success({title:"Success"})}))}),(0,S.jsx)(SectionPressItem,{title:"Clear Password",testID:"clear-password",onPress:(0,o.A)((function*(){yield d.A.serviceE2E.clearPassword(e),u.Toast.success({title:"Success"})}))}),(0,S.jsx)(SectionPressItem,{title:"Clear History",testID:"clear-history",onPress:(0,o.A)((function*(){yield d.A.serviceE2E.clearHistoryData(e),u.Toast.success({title:"Success"})}))}),(0,S.jsx)(SectionPressItem,{title:"Clear Settings",testID:"clear-settings",onPress:(0,o.A)((function*(){yield d.A.serviceE2E.clearSettings(e),u.Toast.success({title:"Success"})}))}),(0,S.jsx)(SectionPressItem,{title:"Clear Wallet Connect Sessions",testID:"wallet-connect-session",onPress:(0,o.A)((function*(){yield d.A.serviceWalletConnect.disconnectAllSessions(),u.Toast.success({title:"Success"})}))})]})})})),function onConfirm(t){return e.apply(this,arguments)})})}}),(0,S.jsx)(SectionPressItem,{title:"Startup Time(ms)",onPress:function(){u.Dialog.cancel({title:"Startup Time(ms)",renderContent:(0,S.jsx)(F._,{})})}}),(0,S.jsx)(SectionPressItem,{title:"Reset Spotlight",subtitle:"Will reset after 5 seconds.",onPress:function(){setTimeout((function(){d.A.serviceSpotlight.reset()}),5e3)}}),(0,S.jsx)(SectionPressItem,{title:"重置清空应用更新状态",onPress:function(){d.A.serviceAppUpdate.reset()}}),(0,S.jsx)(SectionPressItem,{title:"重置清空应用更新状态为失败状态",onPress:function(){d.A.serviceAppUpdate.notifyFailed()}}),h.Ay.isNativeAndroid?(0,S.jsx)(SectionPressItem,{copyable:!0,title:"Android Channel: "}):null,null,(0,S.jsx)(_.c,{drillIn:!0,onPress:function(){(0,C.RI)(),window.location.reload()},title:`Switch web mode: ${(0,C.uP)()?"dapp":"wallet"} mode`,titleProps:{color:"$textCritical"}}),(0,S.jsx)(AddressBookDevSetting,{}),(0,S.jsx)(CrashDevSettings,{})]}):null},B=s(603465),$=s(788316),ThemeListItem=function(){var[{theme:e}]=(0,p.useSettingsPersistAtom)(),{setFreezeOnBlur:t}=(0,a.useContext)(B.k),s=(0,c.A)(),n=(0,a.useMemo)((function(){return[{label:s.formatMessage({id:m.ETranslations.global_auto}),description:s.formatMessage({id:m.ETranslations.global_follow_the_system}),value:"system"},{label:s.formatMessage({id:m.ETranslations.global_light}),value:"light"},{label:s.formatMessage({id:m.ETranslations.global_dark}),value:"dark"}]}),[s]),r=(0,a.useCallback)(function(){var e=(0,o.A)((function*(e){t(!1),yield d.A.serviceSetting.setTheme(e),t(!0)}));return function(t){return e.apply(this,arguments)}}(),[t]);return(0,S.jsx)(u.Select,{offset:{mainAxis:-4,crossAxis:-10},title:s.formatMessage({id:m.ETranslations.settings_theme}),items:n,value:e,onChange:r,placement:"bottom-end",renderTrigger:function({label:e}){return(0,S.jsx)(_.c,{userSelect:"none",icon:"PaletteOutline",title:s.formatMessage({id:m.ETranslations.settings_theme}),children:(0,S.jsxs)(u.XStack,{children:[(0,S.jsx)(_.c.Text,{primary:e,align:"right"}),(0,S.jsx)(_.c.DrillIn,{ml:"$1.5",name:"ChevronDownSmallSolid"})]})})}})},LanguageListItem=function(){var e=(0,$._)(),t=(0,c.A)(),[{locale:s}]=(0,p.useSettingsPersistAtom)(),n=(0,a.useCallback)(function(){var e=(0,o.A)((function*(e){yield d.A.serviceSetting.setLocale(e),setTimeout((function(){d.A.serviceApp.restartApp()}),0)}));return function(t){return e.apply(this,arguments)}}(),[]);return(0,S.jsx)(u.Select,{offset:{mainAxis:-4,crossAxis:-10},title:t.formatMessage({id:m.ETranslations.global_language}),items:e,value:s,onChange:n,placement:"bottom-end",floatingPanelProps:{maxHeight:280},sheetProps:{snapPoints:[80],snapPointsMode:"percent"},renderTrigger:function({label:e}){return(0,S.jsx)(_.c,{userSelect:"none",icon:"GlobusOutline",title:t.formatMessage({id:m.ETranslations.global_language}),children:(0,S.jsxs)(u.XStack,{children:[(0,S.jsx)(_.c.Text,{primary:e,align:"right"}),(0,S.jsx)(_.c.DrillIn,{ml:"$1.5",name:"ChevronDownSmallSolid"})]})})}})},CurrencyListItem=function(){var e,t=(0,P.A)(),s=(0,a.useCallback)((function(){t.push(A.Pj.SettingCurrencyModal)}),[t]),n=(0,c.A)(),[r]=(0,p.useSettingsPersistAtom)(),i=null!=(e=r.currencyInfo?.id)?e:"";return(0,S.jsx)(_.c,{userSelect:"none",icon:"DollarOutline",title:n.formatMessage({id:m.ETranslations.settings_default_currency}),drillIn:!0,onPress:s,children:(0,S.jsx)(_.c.Text,{primary:i.toUpperCase(),align:"right"})})},PreferenceSection=function(){var e=(0,c.A)();return(0,S.jsxs)(Section,{title:e.formatMessage({id:m.ETranslations.global_preferences}),children:[(0,S.jsx)(CurrencyListItem,{}),(0,S.jsx)(LanguageListItem,{}),(0,S.jsx)(ThemeListItem,{})]})},U=s(536612),z=s(390334),UrlExternalListItem=function({icon:e,title:t,url:s,drillIn:n}){var r=(0,a.useCallback)((function(){(0,y.Dr)(s)}),[s]);return(0,S.jsx)(_.c,{onPress:r,icon:e,title:t,drillIn:n})},L=h.Ay.isNativeAndroidGooglePlay||h.Ay.isNativeIOS,RateAppItem=function(){var e=(0,c.A)(),t=(0,a.useCallback)((function(){h.Ay.isNativeAndroidGooglePlay?(0,y.Dr)(g.M6):h.Ay.isNativeIOS&&(0,y.Dr)(g.nw)}),[e]);return L?(0,S.jsx)(_.c,{onPress:t,icon:"StarOutline",title:e.formatMessage({id:m.ETranslations.settings_rate_app}),drillIn:!0}):null},V=s(460627),StateLogsItem=function(){var e=(0,c.A)(),{copyText:t}=(0,u.useClipboard)(),s=(0,a.useCallback)((function(){u.Dialog.show({icon:"FileDownloadOutline",title:e.formatMessage({id:m.ETranslations.settings_export_state_logs}),renderContent:(0,S.jsxs)(u.Stack,{children:[(0,S.jsxs)(u.SizableText,{size:"$bodyLg",children:[e.formatMessage({id:m.ETranslations.settings_logs_do_not_include_sensitive_data}),(0,S.jsx)(u.Stack,{h:"$5"})]}),(0,S.jsx)(u.SizableText,{size:"$bodyLg",children:e.formatMessage({id:m.ETranslations.settings_export_state_logs_desc},{email:(0,S.jsx)(u.SizableText,{size:"$bodyLg",textDecorationLine:"underline",onPress:function(){return t("hi@onekey.so")},children:"hi@onekey.so"})})})]}),confirmButtonProps:{variant:"primary"},onConfirmText:e.formatMessage({id:m.ETranslations.global_export}),onConfirm:function(){var e=(new Date).toISOString().replace(/[-:.]/g,"");(0,V.u)(`OneKeyLogs-${e}`)}})}),[t,e]);return(0,S.jsx)(_.c,{icon:"FileDownloadOutline",onPress:s,title:e.formatMessage({id:m.ETranslations.settings_export_state_logs}),drillIn:!0})};function ListVersionItem(){var e=(0,c.A)(),t=(0,U.SX)(),s=(0,a.useCallback)((function(){t.toUpdatePreviewPage()}),[t]);return t.isNeedUpdate?(0,S.jsx)(_.c,{onPress:s,icon:"InfoCircleOutline",iconProps:{color:"$textInfo"},title:e.formatMessage({id:m.ETranslations.settings_app_update_available}),titleProps:{color:"$textInfo"},drillIn:!0,children:(0,S.jsx)(_.c.Text,{primary:(0,S.jsx)(u.Badge,{badgeType:"info",badgeSize:"lg",children:t.data.latestVersion}),align:"right"})}):(0,S.jsx)(_.c,{onPress:t.onViewReleaseInfo,icon:"InfoCircleOutline",title:e.formatMessage({id:m.ETranslations.settings_whats_new}),drillIn:!0,children:(0,S.jsx)(_.c.Text,{primary:h.Ay.version,align:"right"})})}var ResourceSection=function(){var e=(0,z.P)({path:"articles/360002014776"}),t=(0,z.P)({path:"articles/360002003315"}),s=(0,z.P)({path:"requests/new"}),n=(0,z.P)({path:""}),r=(0,c.A)();return(0,S.jsxs)(Section,{title:r.formatMessage({id:m.ETranslations.settings_resources}),children:[(0,S.jsx)(ListVersionItem,{}),(0,S.jsx)(UrlExternalListItem,{icon:"HelpSupportOutline",title:r.formatMessage({id:m.ETranslations.settings_help_center}),url:n,drillIn:!0}),(0,S.jsx)(UrlExternalListItem,{icon:"EditOutline",title:r.formatMessage({id:m.ETranslations.settings_submit_request}),url:s,drillIn:!0}),(0,S.jsx)(RateAppItem,{}),(0,S.jsx)(UrlExternalListItem,{icon:"PeopleOutline",title:r.formatMessage({id:m.ETranslations.settings_user_agreement}),url:e,drillIn:!0}),(0,S.jsx)(UrlExternalListItem,{icon:"FileTextOutline",title:r.formatMessage({id:m.ETranslations.settings_privacy_policy}),url:t,drillIn:!0}),(0,S.jsx)(StateLogsItem,{})]})},K=s(247424),H=s(215189),R=s(461483),N=s(456628),W=s(15159),X=s(447479),ClearCacheOnAppContent=function(){var e=(0,c.A)();return(0,S.jsx)(u.Dialog.Form,{formProps:{defaultValues:{tokenAndNFT:!0,transactionHistory:!0,swapHistory:!0,browserCache:!0,browserHistory:!1,connectSites:!1,signatureRecord:!1}},children:(0,S.jsxs)(u.Stack,{children:[(0,S.jsx)(u.Dialog.FormField,{name:"tokenAndNFT",children:(0,S.jsx)(u.Checkbox,{label:e.formatMessage({id:m.ETranslations.settings_token_nft_data})})}),(0,S.jsx)(u.Dialog.FormField,{name:"transactionHistory",children:(0,S.jsx)(u.Checkbox,{label:e.formatMessage({id:m.ETranslations.settings_transaction_history})})}),(0,S.jsx)(u.Dialog.FormField,{name:"swapHistory",children:(0,S.jsx)(u.Checkbox,{label:e.formatMessage({id:m.ETranslations.settings_swap_history})})}),(0,S.jsx)(u.Dialog.FormField,{name:"browserCache",children:(0,S.jsx)(u.Checkbox,{label:e.formatMessage({id:m.ETranslations.settings_browser_cache})})}),(0,S.jsx)(u.Dialog.FormField,{name:"browserHistory",children:(0,S.jsx)(u.Checkbox,{label:e.formatMessage({id:m.ETranslations.settings_browser_history_bookmarks_pins_risk_dapp_whitelist}),labelProps:{flex:1}})}),(0,S.jsx)(u.Dialog.FormField,{name:"connectSites",children:(0,S.jsx)(u.Checkbox,{label:e.formatMessage({id:m.ETranslations.settings_connected_sites})})}),(0,S.jsx)(u.Dialog.FormField,{name:"signatureRecord",children:(0,S.jsx)(u.Checkbox,{label:e.formatMessage({id:m.ETranslations.settings_signature_record})})})]})})},CleanDataItem=function(){var{copyText:e}=(0,u.useClipboard)(),t=(0,c.A)(),s=(0,$.Q)();return(0,S.jsx)(u.ActionList,{offset:{mainAxis:-4,crossAxis:-10},title:t.formatMessage({id:m.ETranslations.settings_clear_data}),renderTrigger:(0,S.jsx)(_.c,{title:t.formatMessage({id:m.ETranslations.settings_clear_data}),icon:"FolderDeleteOutline",testID:"setting-clear-data",children:(0,S.jsx)(_.c.DrillIn,{name:"ChevronDownSmallOutline"})}),items:[{label:t.formatMessage({id:m.ETranslations.settings_clear_cache_on_app}),onPress:function(){u.Dialog.show({title:t.formatMessage({id:m.ETranslations.settings_clear_cache_on_app}),renderContent:(0,S.jsx)(ClearCacheOnAppContent,{}),tone:"destructive",confirmButtonProps:{disabledOn:function({getForm:e}){var{getValues:t}=e()||{};if(t){var s=t();return!Object.values(s).some((function(e){return Boolean(e)}))}return!0}},onConfirm:function(){var s=(0,o.A)((function*(s){var n=s.getForm()?.getValues();if(n&&(yield d.A.serviceSetting.clearCacheOnApp(n),u.Toast.success({title:t.formatMessage({id:m.ETranslations.global_success})}),n?.browserCache))if(h.Ay.isRuntimeChrome||h.Ay.isRuntimeEdge){var r="chrome://settings/clearBrowserData";h.Ay.isRuntimeEdge&&(r="edge://settings/clearBrowserData"),u.Dialog.show({title:t.formatMessage({id:m.ETranslations.settings_clear_browser_cache}),description:t.formatMessage({id:m.ETranslations.settings_clear_browser_cache_desc},{url:r}),onConfirm:function(){e(r)},showCancelButton:!1,confirmButtonProps:{variant:"primary",size:"large",icon:"Copy1Outline"},onConfirmText:t.formatMessage({id:m.ETranslations.global_copy})})}else u.Dialog.show({title:t.formatMessage({id:m.ETranslations.settings_clear_browser_cache}),description:t.formatMessage({id:m.ETranslations.settings_clear_browser_cache_desc2}),showCancelButton:!1,confirmButtonProps:{variant:"primary",size:"large",icon:"Copy1Outline"}})}));return function onConfirm(e){return s.apply(this,arguments)}}()})}},{label:t.formatMessage({id:m.ETranslations.settings_clear_pending_transactions}),onPress:function(){u.Dialog.show({title:t.formatMessage({id:m.ETranslations.settings_clear_pending_transactions}),description:t.formatMessage({id:m.ETranslations.settings_clear_pending_transactions_desc}),tone:"destructive",onConfirmText:t.formatMessage({id:m.ETranslations.global_clear}),onConfirm:function(){var e=(0,o.A)((function*(){yield d.A.serviceSetting.clearPendingTransaction(),D.iL.emit(D.Tu.ClearLocalHistoryPendingTxs,void 0),u.Toast.success({title:t.formatMessage({id:m.ETranslations.global_success})})}));return function onConfirm(){return e.apply(this,arguments)}}()})}},{label:t.formatMessage({id:m.ETranslations.settings_reset_app}),destructive:!0,onPress:s,testID:"setting-erase-data"}]})},AppAutoLockItem=function(){var[{isPasswordSet:e,appLockDuration:t}]=(0,N.MW)(),s=(0,P.A)(),n=(0,a.useCallback)((function(){s.push(A.Pj.SettingAppAutoLockModal)}),[s]),r=(0,c.A)(),i=(0,X.I)(),o=(0,a.useMemo)((function(){var e,s=i.find((function(e){return e.value===String(t)}));return null!=(e=s?.title)?e:""}),[i,t]);return e?(0,S.jsx)(_.c,{onPress:n,icon:"ClockTimeHistoryOutline",title:r.formatMessage({id:m.ETranslations.settings_auto_lock}),drillIn:!0,children:(0,S.jsx)(_.c.Text,{primary:o,align:"right"})}):null},SetPasswordItem=function(){var e=(0,c.A)();return(0,S.jsx)(_.c,{onPress:function(){d.A.servicePassword.promptPasswordVerify()},icon:"KeyOutline",title:e.formatMessage({id:m.ETranslations.global_set_password}),drillIn:!0})},ChangePasswordItem=function(){var e=(0,c.A)(),t=(0,a.useCallback)((0,o.A)((function*(){var t=yield d.A.servicePassword.promptPasswordVerify({reason:W.a.Security}),s=u.Dialog.show({title:e.formatMessage({id:m.ETranslations.global_change_password}),renderContent:(0,S.jsx)(R.A,{oldEncodedPassword:t.password,onUpdateRes:function(){var e=(0,o.A)((function*(e){e&&(yield s.close())}));return function(t){return e.apply(this,arguments)}}()}),showFooter:!1})})),[e]);return(0,S.jsx)(_.c,{onPress:t,icon:"KeyOutline",title:e.formatMessage({id:m.ETranslations.global_change_password}),drillIn:!0})},PasswordItem=function(){var[{isPasswordSet:e}]=(0,N.MW)();return e?(0,S.jsx)(ChangePasswordItem,{}):(0,S.jsx)(SetPasswordItem,{})},FaceIdItem=function(){var e=(0,c.A)(),[{isPasswordSet:t}]=(0,N.MW)(),[{isSupport:s,authType:n}]=(0,N.Bd)(),[{isSupport:r}]=(0,N.GZ)(),i=e.formatMessage({id:m.ETranslations.global_touch_id}),o="TouchIdSolid";return s&&(n.includes(K.h.FACIAL_RECOGNITION)||n.includes(K.h.IRIS))&&(i=e.formatMessage({id:n.length>1?m.ETranslations.global_biometric:m.ETranslations.global_face_id}),o="FaceIdSolid"),t&&(s||r)?(0,S.jsx)(_.c,{icon:o,title:i,children:(0,S.jsx)(H.V,{})}):null},ProtectionItem=function(){var e=(0,c.A)(),[{isPasswordSet:t}]=(0,N.MW)(),s=(0,P.A)(),n=(0,a.useCallback)((function(){s.push(A.Pj.SettingProtectModal)}),[s]);return t?(0,S.jsx)(_.c,{onPress:n,icon:"ShieldCheckDoneOutline",title:e.formatMessage({id:m.ETranslations.settings_protection}),drillIn:!0}):null},ConnectedSitesItem=function(){var e=(0,c.A)(),t=(0,P.A)(),s=(0,a.useCallback)((function(){t.pushModal(A.ry.DAppConnectionModal,{screen:A.EB.ConnectionList})}),[t]);return(0,S.jsx)(_.c,{title:e.formatMessage({id:m.ETranslations.settings_connected_sites}),icon:"LinkOutline",drillIn:!0,onPress:s})},SignatureRecordItem=function(){var e=(0,c.A)(),t=(0,P.A)(),s=(0,a.useCallback)((function(){t.push(A.Pj.SettingSignatureRecordModal)}),[t]);return(0,S.jsx)(_.c,{onPress:s,icon:"NoteOutline",title:e.formatMessage({id:m.ETranslations.settings_signature_record}),drillIn:!0})},SecuritySection=function(){var e=(0,c.A)();return(0,S.jsxs)(Section,{title:e.formatMessage({id:m.ETranslations.global_security}),children:[(0,S.jsx)(a.Suspense,{fallback:null,children:(0,S.jsx)(FaceIdItem,{})}),(0,S.jsx)(AppAutoLockItem,{}),(0,S.jsx)(PasswordItem,{}),h.Ay.isWebDappMode?null:(0,S.jsx)(ConnectedSitesItem,{}),(0,S.jsx)(SignatureRecordItem,{}),(0,S.jsx)(ProtectionItem,{}),(0,S.jsx)(CleanDataItem,{})]})},SocialButton=function({icon:e,url:t,text:s}){var n=(0,a.useCallback)((function(){(0,y.Dr)(t)}),[t]);return(0,S.jsx)(u.Tooltip,{renderTrigger:(0,S.jsx)(u.IconButton,{bg:"$bgSubdued",width:"$14",height:"$14",icon:e,borderRadius:"$full",onPress:n}),renderContent:s,placement:"top"})},SocialButtonGroup=function(){var e,t,s=(0,c.A)(),{copyText:n}=(0,u.useClipboard)(),r=s.formatMessage({id:m.ETranslations.settings_version_versionnum},{versionNum:`${null!=(e=h.Ay.version)?e:""} ${null!=(t=h.Ay.buildNumber)?t:""}`}),i=(0,a.useCallback)((function(){j((function(){return n(`${r}-${h.Ay.githubSHA||""}`)}))}),[n,r]);return(0,S.jsxs)(u.YStack,{children:[(0,S.jsx)(u.XStack,{justifyContent:"center",children:(0,S.jsxs)(u.XStack,{space:"$3",paddingVertical:"$3",my:"$3",children:[(0,S.jsx)(SocialButton,{icon:"OnekeyBrand",url:g.eG,text:s.formatMessage({id:m.ETranslations.global_official_website})}),(0,S.jsx)(SocialButton,{icon:"DiscordBrand",url:g.zp,text:s.formatMessage({id:m.ETranslations.global_discord})}),(0,S.jsx)(SocialButton,{icon:"Xbrand",url:g.Gz,text:s.formatMessage({id:m.ETranslations.global_x})}),(0,S.jsx)(SocialButton,{icon:"GithubBrand",url:g.Oe,text:s.formatMessage({id:m.ETranslations.global_github})})]})}),(0,S.jsx)(u.XStack,{justifyContent:"center",py:"$4",children:(0,S.jsx)(u.SizableText,{selectable:!1,color:"$textSubdued",onPress:i,testID:"setting-version",children:r})})]})};function SettingListModal(){var e,t=(0,l.lq)(),s=null!=(e=t.params?.flag)?e:"",{setWebAuthEnable:n}=(0,f.Z)(),[{webAuthCredentialId:r}]=(0,p.usePasswordPersistAtom)();(0,a.useEffect)((function(){"webAuthRegistration"!==s||r||(0,o.A)((function*(){(yield n(!0))&&(yield d.A.serviceSetting.setBiologyAuthSwitchOn(!0))}))()}),[s,n,r]);var i=(0,c.A)(),{bottom:g}=(0,u.useSafeAreaInsets)();return(0,S.jsxs)(u.Page,{scrollEnabled:!0,safeAreaEnabled:!1,children:[(0,S.jsx)(u.Page.Header,{title:i.formatMessage({id:m.ETranslations.settings_settings})}),(0,S.jsxs)(u.Page.Body,{children:[(0,S.jsx)(DefaultSection,{}),(0,S.jsx)(PreferenceSection,{}),(0,S.jsx)(SecuritySection,{}),(0,S.jsx)(AdvancedSection,{}),(0,S.jsx)(ResourceSection,{}),(0,S.jsx)(DevSettingsSection,{}),(0,S.jsx)(SocialButtonGroup,{}),g>0?(0,S.jsx)(u.Stack,{height:g||"$2"}):null]})]})}},639451:(e,t,s)=>{s.d(t,{Ed:()=>c,Xo:()=>a,sB:()=>l,xf:()=>useDownloadProgress});var n,r,i,o=s(586330),a=(n=(0,o.A)((function*(){return{}})),function downloadPackage(){return n.apply(this,arguments)}),l=(r=(0,o.A)((function*(){})),function verifyPackage(){return r.apply(this,arguments)}),c=(i=(0,o.A)((function*(){})),function installPackage(){return i.apply(this,arguments)}),useDownloadProgress=function(){return 0}}}]);
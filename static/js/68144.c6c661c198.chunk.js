"use strict";(self.webpackChunkweb=self.webpackChunkweb||[]).push([[68144],{657412:(e,t,r)=>{r.d(t,{Xp:()=>n.Xp,yZ:()=>useBrowserAction,Gd:()=>useBrowserBookmarkAction,cS:()=>useBrowserHistoryAction,AO:()=>useBrowserTabActions,AS:()=>n.AS,Do:()=>n.Do,pJ:()=>n.pJ,nD:()=>n.nD});var n=r(603614),a=r(586330),o=r(324586),i=r(946343),s=r.n(i),l=r(230414),c=r(929296),u=r(195309),d=r(972715),p=r(514041),b=r(490343),f=r(60153),g=r(262873),h=r(714178),y=r(971670),m=r(660015),w=r(254491),v=r(849726),S=r(213644),k=(r(663522),r(757559)),D=r(657355),x=r(482407),j=r(796151),$=r(42484);function ownKeys(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function _objectSpread(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?ownKeys(Object(r),!0).forEach((function(t){(0,o.A)(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):ownKeys(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function _createSuper(e){var t=_isNativeReflectConstruct();return function _createSuperInternal(){var r,n=(0,d.A)(e);if(t){var a=(0,d.A)(this).constructor;r=Reflect.construct(n,arguments,a)}else r=n.apply(this,arguments);return(0,u.A)(this,r)}}function _isNativeReflectConstruct(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(e){}return(_isNativeReflectConstruct=function(){return!!e})()}function loggerForEmptyData(e,t){e&&0!==e.length||(S.U.discovery.browser.setTabsDataFunctionName(t),S.U.discovery.browser.tabsData(e))}var A={};var O={id:"home",url:"about:blank",title:"OneKey",canGoBack:!1,loading:!1,favicon:""},W=function(e){(0,c.A)(ContextJotaiActionsDiscovery,e);var t=_createSuper(ContextJotaiActionsDiscovery);function ContextJotaiActionsDiscovery(...e){var r,o,i,l,c,u,d,p,h;return(r=t.call(this,...e)).setDisplayHomePage=(0,n.q0)((function(e,t,r){t((0,n.QL)(),r)})),r.setBrowserDataReady=(0,n.q0)((function(e,t){t((0,n.lr)(),!0)})),r.buildWebTabs=(0,n.q0)((function(e,t,r){var{data:a,options:o}=r;if(e((0,n.lr)())||o?.isInitFromStorage){var i=e((0,n.cl)()),l=a;if(!Array.isArray(a))throw new Error("setWebTabsWriteAtom: payload must be an array");l&&l.length||(l=[]);var c=function buildWebTabData(e){var t={},r=[];return e.sort((function(e,t){return e.timestamp&&t.timestamp?e.timestamp-t.timestamp:0})),e.forEach((function(e){r.push(e.id),t[e.id]=e})),{data:e,keys:r,map:t}}(l);s()(c.keys,i.keys)&&!o?.forceUpdate||t((0,n.cl)(),{keys:c.keys,tabs:c.data}),t((0,n.GW)(),(function(){return c.map})),loggerForEmptyData(c.data,"buildWebTabs->saveToSimpleDB"),f.A.simpleDb.browserTabs.setRawData({tabs:c.data})}})),r.refreshTabs=(0,n.q0)((function(e,t){var{tabs:a}=e((0,n.cl)()),o=[...a];loggerForEmptyData(o,"refreshTabs"),r.buildWebTabs.call(t,{data:o,options:{forceUpdate:!0}})})),r.setCurrentWebTab=(0,n.q0)((function(e,t,a){var o=e((0,n.WL)());if(o!==a){r.pauseDappInteraction.call(t,o);var{tabs:i}=e((0,n.cl)()),s=i.findIndex((function(e){return e.id===a}));i.forEach((function(e){e.isActive=!1})),loggerForEmptyData([...i],"setCurrentWebTab"),r.buildWebTabs.call(t,{data:[...i]}),-1!==s?(i[s].isActive=!0,t((0,n.WL)(),a),r.resumeDappInteraction.call(t,a)):t((0,n.WL)(),"")}var l=e((0,n.QL)());a&&l&&r.setDisplayHomePage.call(t,!1),a||l||r.setDisplayHomePage.call(t,!0)})),r.addWebTab=(0,n.q0)((function(e,t,a){performance.now();var o,{tabs:i}=e((0,n.cl)());a.id&&a.id!==O.id||(a.id=(0,x.lk)()),a.timestamp=Date.now(),r.buildWebTabs.call(t,{data:[...i,a]}),r.setCurrentWebTab.call(t,null!=(o=a.id)?o:"");performance.now()})),r.addBlankWebTab=(0,n.q0)((function(e,t){r.addWebTab.call(t,_objectSpread(_objectSpread({},O),{},{isActive:!0}))})),r.setWebTabData=(0,n.q0)((function(e,t,a){var{tabs:o}=e((0,n.cl)()),i=o,s=i.findIndex((function(e){return e.id===a.id}));if(s>-1){var l=i[s];Object.keys(a).forEach((function(e){var t=e,r=a[t];if(void 0!==r&&r!==l[t]){if("title"===t&&!r)return;l[t]=r,"url"===t&&(l.timestamp=Date.now(),"about:blank"===r&&a.id&&(A[a.id]=l.timestamp))}})),i[s]=l,loggerForEmptyData(i,"setWebTabData"),r.buildWebTabs.call(t,{data:i})}})),r.closeWebTab=(0,n.q0)((function(e,t,a){delete m.O3[a];var{tabs:o}=e((0,n.cl)()),i=e((0,n.WL)()),s=o.findIndex((function(e){return e.id===a}));if(-1!==s){var l=o[s].id===i;if(o.splice(s,1),l){var c=s-1;if(c<0&&o.length>0&&(c=0),c>=0){var u=o[c];u.isActive=!0,r.setCurrentWebTab.call(t,u.id)}}}loggerForEmptyData([...o],"closeWebTab"),r.buildWebTabs.call(t,{data:[...o]})})),r.closeAllWebTabs=(0,n.q0)((function(e,t){var{tabs:a}=e((0,n.cl)()),o=e((0,n.WL)()),i=a.filter((function(e){return e.isPinned}));i.every((function(e){return e.id!==o}))&&r.setCurrentWebTab.call(t,null);var _loop=function(e){i.find((function(t){return t.id===e}))||delete m.O3[e]};for(var s of Object.getOwnPropertyNames(m.O3))_loop(s);loggerForEmptyData(i,"closeAllWebTabs"),r.buildWebTabs.call(t,{data:i})})),r.setPinnedTab=(0,n.q0)((function(e,t,n){r.setWebTabData.call(t,{id:n.id,isPinned:n.pinned,timestamp:Date.now()}),r.refreshTabs.call(t)})),r.syncBookmark=(0,n.q0)((function(e,t,a){var o=e((0,n.GW)());o&&Object.entries(o).forEach((function([,e]){e.url===a.url&&r.setWebTabData.call(t,{id:e.id,isBookmark:a.isBookmark})}))})),r.getBookmarkData=(0,n.q0)((0,a.A)((function*(){var e;return null!=(e=(yield f.A.simpleDb.browserBookmarks.getRawData())?.data)?e:[]}))),r.buildBookmarkData=(0,n.q0)((function(e,t,r){var{data:a,options:o}=r;if(e((0,n.lr)())||o?.isInitFromStorage){if(!Array.isArray(a))throw new Error("buildBookmarkData: payload must be an array");f.A.serviceDiscovery.setBrowserBookmarks(a)}})),r.addBrowserBookmark=(0,n.q0)((o=(0,a.A)((function*(e,t,n){if(n.url&&n.url!==O.url){var a=[...(yield r.getBookmarkData.call(t)).filter((function(e){return e.url!==n.url})),{url:n.url,title:n.title}];r.buildBookmarkData.call(t,{data:a}),r.syncBookmark.call(t,{url:n.url,isBookmark:!0}),f.A.serviceCloudBackup.requestAutoBackup()}})),function(e,t,r){return o.apply(this,arguments)})),r.removeBrowserBookmark=(0,n.q0)((i=(0,a.A)((function*(e,t,n){var a=(yield r.getBookmarkData.call(t)).filter((function(e){return e.url!==n}));r.buildBookmarkData.call(t,{data:a}),r.syncBookmark.call(t,{url:n,isBookmark:!1})})),function(e,t,r){return i.apply(this,arguments)})),r.modifyBrowserBookmark=(0,n.q0)((l=(0,a.A)((function*(e,t,n){if(n.url&&n.url!==O.url){var a=(yield r.getBookmarkData.call(t)).map((function(e){return e.url===n.url?_objectSpread(_objectSpread({},e),n):e}));r.buildBookmarkData.call(t,{data:a})}})),function(e,t,r){return l.apply(this,arguments)})),r.getHistoryData=(0,n.q0)((0,a.A)((function*(){var e;return null!=(e=(yield f.A.simpleDb.browserHistory.getRawData())?.data)?e:[]}))),r.buildHistoryData=(0,n.q0)((function(e,t,r){var{data:a,options:o}=r;if(e((0,n.lr)())||o?.isInitFromStorage){if(!Array.isArray(a))throw new Error("buildHistoryData: payload must be an array");f.A.simpleDb.browserHistory.setRawData({data:a})}})),r.addBrowserHistory=(0,n.q0)((c=(0,a.A)((function*(e,t,n){if(n.url&&n.url!==O.url){var a=(yield r.getHistoryData.call(t)).filter((function(e){return e.url!==n.url})),o={id:(0,x.lk)(),url:n.url,title:n.title,createdAt:Date.now()};r.buildHistoryData.call(t,{data:[o,...a]})}})),function(e,t,r){return c.apply(this,arguments)})),r.removeBrowserHistory=(0,n.q0)((u=(0,a.A)((function*(e,t,n){var a=(yield r.getHistoryData.call(t)).filter((function(e){return e.id!==n}));r.buildHistoryData.call(t,{data:a})})),function(e,t,r){return u.apply(this,arguments)})),r.removeAllBrowserHistory=(0,n.q0)((d=(0,a.A)((function*(e,t){r.buildHistoryData.call(t,{data:[]})})),function(e,t){return d.apply(this,arguments)})),r.getWebTabById=(0,n.q0)((function(e,t,r){var a=e((0,n.GW)());return a?.[r||""]})),r.gotoSite=(0,n.q0)((p=(0,a.A)((function*(e,t,{id:n,url:a,title:o,favicon:i,isNewWindow:s,isInPlace:l,userTriggered:c}){var u=r.getWebTabById.call(t,null!=n?n:"");if(a){var d=j.Ay.validateUrl(a);if(!d)return;if(c&&r.addBrowserHistory.call(t,{url:d,title:null!=o?o:""}),"StandardBrowser"===m.n5)return(0,y.C)(d);var p=u?.id,b=!d.startsWith("http")&&"about:blank"!==d,f="boolean"==typeof s?s:(s||!p||"home"===p||b)&&"MultiTabBrowser"===m.n5,g=yield r.getBookmarkData.call(t),h=g?.some((function(e){return e.url.includes(d)}));return f?r.addWebTab.call(t,{title:o,url:d,favicon:i,isBookmark:h}):r.setWebTabData.call(t,{id:p,url:d,title:o,favicon:i,isBookmark:h}),f||l||(0,m.T0)({url:d,tabId:p}),b&&"MultiTabBrowser"===m.n5&&p&&setTimeout((function(){r.closeWebTab.call(t,p)}),1e3),!0}return!1})),function(e,t,r){return p.apply(this,arguments)})),r.openMatchDApp=(0,n.q0)((h=(0,a.A)((function*(e,t,{dApp:n,webSite:a,isNewWindow:o,tabId:i}){return a?r.gotoSite.call(t,{id:i,url:a.url,title:a.title,favicon:yield f.A.serviceDiscovery.buildWebsiteIconUrl(a.url),isNewWindow:o,userTriggered:!0}):n?r.gotoSite.call(t,{id:i,url:n.url,title:n.name,dAppId:n.dappId,favicon:n.logo||n.originLogo,userTriggered:!0,isNewWindow:o}):void 0})),function(e,t,r){return h.apply(this,arguments)})),r.handleOpenWebSite=(0,n.q0)((function(e,t,{useCurrentWindow:a,tabId:o,navigation:i,webSite:s,dApp:l,shouldPopNavigation:c=!0}){var u=!a;if(!a&&e((0,n.$D)()))return void b.Toast.message({title:v.a.intl.formatMessage({id:w.ETranslations.explore_toast_tab_limit_reached},{number:"20"})});r.setDisplayHomePage.call(t,!1),r.openMatchDApp.call(t,{webSite:s,dApp:l,isNewWindow:u,tabId:o}),c&&i.switchTab(k.V4.Discovery)})),r.onNavigation=(0,n.q0)((function(e,t,{url:a,isNewWindow:o,isInPlace:i,title:s,favicon:l,canGoBack:c,canGoForward:u,loading:d,id:p,handlePhishingUrl:b}){var f=Date.now(),h=r.getWebTabById.call(t,null!=p?p:"");if(h){var y="string"==typeof a&&a!==h.url;if(a){var m=e((0,n.RY)()),{action:w}=j.Ay.parseDappRedirect(a,Array.from(m.keys()));if(w===j.Ay.EDAppOpenActionEnum.DENY)return S.U.discovery.browser.logRejectUrl(a),void b?.(a);if(j.Ay.isValidDeepLink(a))return void(0,g.q)({url:a})}if(y){if(h.timestamp&&f-h.timestamp<500)return;if(A[h.id]&&a!==O.url&&f-A[h.id]<1e3)return;r.gotoSite.call(t,{url:a,title:s,favicon:l,isNewWindow:o,isInPlace:i,id:h.id})}r.setWebTabData.call(t,{id:h.id,title:s,favicon:l,canGoBack:c,canGoForward:u,loading:d})}})),r.addUrlToPhishingCache=(0,n.q0)((function(e,t,r){try{var{origin:a}=new URL(r.url),o=e((0,n.RY)());o.set(a,!0),t((0,n.RY)(),o),window.desktopApi?.setAllowedPhishingUrls(Array.from(o.keys()))}catch{}})),r.updateDappActivityInteraction=(0,n.q0)((function(e,t,r){var a=r.id;a||(a=e((0,n.WL)()));var o=a?m.O3[a]:null;if(o){var i="pause"===r.type;i?m.ay:m.F;o.jsBridge&&(o.jsBridge.globalOnMessageEnabled=!i)}})),r.pauseDappInteraction=(0,n.q0)((function(e,t,n){r.updateDappActivityInteraction.call(t,{id:n,type:"pause"})})),r.resumeDappInteraction=(0,n.q0)((function(e,t,n){r.updateDappActivityInteraction.call(t,{id:n,type:"resume"})})),r.validateWebviewSrc=(0,n.q0)((function(e,t,r){if(!r)return $.i.InvalidUrl;var a=e((0,n.RY)()),{action:o}=j.Ay.parseDappRedirect(r,Array.from(a.keys()));return o===j.Ay.EDAppOpenActionEnum.DENY?(S.U.discovery.browser.logRejectUrl(r),$.i.NotSupportProtocol):j.Ay.containsPunycode(r)?(S.U.discovery.browser.logRejectUrl(r),$.i.InvalidPunycode):j.Ay.isValidDeepLink(r)?$.i.ValidDeeplink:$.i.Valid})),r}return(0,l.A)(ContextJotaiActionsDiscovery)}(h.x),B=(0,D.j)((function(){return new W}));function useBrowserTabActions(){var e=B(),t=e.addWebTab.use(),r=e.addBlankWebTab.use(),n=e.buildWebTabs.use(),a=e.refreshTabs.use(),o=e.setWebTabData.use(),i=e.getWebTabById.use(),s=e.closeWebTab.use(),l=e.closeAllWebTabs.use(),c=e.setCurrentWebTab.use(),u=e.setPinnedTab.use(),d=e.setDisplayHomePage.use(),b=e.setBrowserDataReady.use();return(0,p.useRef)({addWebTab:t,addBlankWebTab:r,buildWebTabs:n,refreshTabs:a,setWebTabData:o,getWebTabById:i,closeWebTab:s,closeAllWebTabs:l,setCurrentWebTab:c,setPinnedTab:u,setDisplayHomePage:d,setBrowserDataReady:b})}function useBrowserBookmarkAction(){var e=B(),t=e.buildBookmarkData.use(),r=e.getBookmarkData.use(),n=e.addBrowserBookmark.use(),a=e.removeBrowserBookmark.use(),o=e.modifyBrowserBookmark.use();return(0,p.useRef)({buildBookmarkData:t,getBookmarkData:r,addBrowserBookmark:n,removeBrowserBookmark:a,modifyBrowserBookmark:o})}function useBrowserHistoryAction(){var e=B(),t=e.buildHistoryData.use(),r=e.getHistoryData.use(),n=e.addBrowserHistory.use(),a=e.removeBrowserHistory.use(),o=e.removeAllBrowserHistory.use();return(0,p.useRef)({buildHistoryData:t,getHistoryData:r,addBrowserHistory:n,removeBrowserHistory:a,removeAllBrowserHistory:o})}function useBrowserAction(){var e=B(),t=e.gotoSite.use(),r=e.openMatchDApp.use(),n=e.handleOpenWebSite.use(),a=e.onNavigation.use(),o=e.addUrlToPhishingCache.use(),i=e.pauseDappInteraction.use(),s=e.resumeDappInteraction.use(),l=e.validateWebviewSrc.use();return(0,p.useRef)({gotoSite:t,openMatchDApp:r,handleOpenWebSite:n,onNavigation:a,addUrlToPhishingCache:o,pauseDappInteraction:i,resumeDappInteraction:s,validateWebviewSrc:l})}},574319:(e,t,r)=>{r.d(t,{D$:()=>useWebTabDataById,bI:()=>useDisabledAddedNewTab,cf:()=>useActiveTabId,oM:()=>useWebTabs,y:()=>useDisplayHomePageFlag});var n=r(514041),a=r(657412),useWebTabs=function(){var[e]=(0,a.pJ)();return(0,n.useMemo)((function(){return{tabs:e.tabs}}),[e])},useWebTabDataById=function(e){var[t]=(0,a.nD)();return(0,n.useMemo)((function(){return{tab:t[null!=e?e:""]}}),[t,e])},useActiveTabId=function(){var[e]=(0,a.Xp)();return(0,n.useMemo)((function(){return{activeTabId:e}}),[e])},useDisplayHomePageFlag=function(){var[e]=(0,a.Do)();return{displayHomePage:e}},useDisabledAddedNewTab=function(){var[e]=(0,a.AS)();return(0,n.useMemo)((function(){return{disabledAddedNewTab:e}}),[e])}},568144:(e,t,r)=>{r.r(t),r.d(t,{default:()=>U});var n=r(514041),a=r(490343),o=r(498356),i=r(757559),s=r(908867),l=r(254491),c=r(663522),u=(r(187576),r(574319)),d=r(564452),p=r(660015),b=r(831085),f={width:"calc(100vw - 40px)",flex:1,mt:"$4"};const g=(0,d.k)((function CustomHeaderTitle({handleSearchBarPress:e}){var t=(0,s.A)(),{activeTabId:r}=(0,u.cf)(),{tab:n}=(0,u.D$)(null!=r?r:""),o=r&&n?.url,{isHttpsUrl:i,hiddenHttpsUrl:c}=(0,p.Mr)(o?n?.url:void 0);return(0,b.jsxs)(a.XStack,{role:"button",alignItems:"center",px:"$2",py:"$1.5",bg:"$bgStrong",borderRadius:"$3",minWidth:"$64",$md:f,hoverStyle:{bg:"$bgHover"},pressStyle:{bg:"$bgActive"},onPress:function(){var t;return e(null!=(t=n?.url)?t:"")},borderCurve:"continuous",children:[(0,b.jsx)(a.Icon,{name:i?"LockOutline":"SearchOutline",size:"$5",color:"$iconSubdued"}),(0,b.jsx)(a.SizableText,{pl:"$2",size:"$bodyLg",color:"$textSubdued",flex:1,numberOfLines:1,testID:"explore-index-search",children:o?c:t.formatMessage({id:l.ETranslations.explore_search_dapps})}),null]})}));var h=r(586330),y=r(60153),m=r(292600),w=r(317522),v=r(911998),S=r(153763),k=r(657412),D=r(213644),x=r(899035),j=r(117746),$=r(503668),A=r.n($);function Banner({banners:e,handleOpenWebSite:t,isLoading:r}){var o=(0,a.useMedia)(),i=(0,n.useCallback)((function({item:e}){var r;return(0,b.jsxs)(a.Stack,{p:"$5",tag:"section",flex:1,position:"relative",userSelect:"none",onPress:function(){return t({webSite:{url:e.href,title:e.href},useSystemBrowser:e.useSystemBrowser})},children:[(0,b.jsx)(a.Image,{flex:1,borderRadius:"$3",bg:"$bgStrong",src:e.src}),(0,b.jsx)(a.Stack,{position:"absolute",bottom:0,right:0,left:0,px:"$10",py:"$8",$gtMd:{px:"$14",py:"$10"},children:(0,b.jsx)(a.SizableText,{color:"dark"===e.theme?"$textDark":"$textLight",size:"$headingLg",$gtMd:{size:"$heading2xl"},maxWidth:"$96",children:null!=(r=e.title)?r:""})})]})}),[t]),s=(0,n.useCallback)((function({currentIndex:t,goToNextIndex:r,gotToPrevIndex:n}){return(0,b.jsxs)(b.Fragment,{children:[o.gtMd?(0,b.jsxs)(b.Fragment,{children:[0!==t?(0,b.jsx)(a.IconButton,{position:"absolute",left:"$10",top:"50%",transform:"translateY(-50%)",icon:"ChevronLeftOutline",variant:"tertiary",iconProps:{color:"light"===e[t]?.theme?"$iconSubduedLight":"$iconSubduedDark"},onPress:n}):null,t!==e.length-1?(0,b.jsx)(a.IconButton,{icon:"ChevronRightOutline",variant:"tertiary",position:"absolute",right:"$10",top:"50%",transform:"translateY(-50%)",iconProps:{color:"light"===e[t]?.theme?"$iconSubduedLight":"$iconSubduedDark"},onPress:r,disabled:t===e.length-1}):null]}):null,e.length>1?(0,b.jsx)(a.XStack,{space:"$1",position:"absolute",right:"$10",bottom:"$10",children:e.map((function(e,r){return(0,b.jsx)(a.Stack,{w:"$3",$gtMd:{w:"$4"},h:"$1",borderRadius:"$full",bg:"$whiteA12",opacity:t===r?1:.5},r)}))}):null]})}),[o.gtMd,e]),l=(0,n.useCallback)((function(e){return e.bannerId}),[]);return A()(r)||r?(0,b.jsx)(a.Stack,{p:"$5",children:(0,b.jsx)(a.Skeleton,{h:188,w:"100%",$gtMd:{height:268},$gtLg:{height:364}})}):(0,b.jsx)(a.Swiper,{autoplay:!0,autoplayLoop:!0,autoplayLoopKeepAnimation:!0,autoplayDelayMs:3e3,height:228,$gtMd:{height:308},$gtLg:{height:404},keyExtractor:l,data:e,renderItem:i,renderPagination:s})}var O=r(324586),W=r(839850),B=["selected","children"],I=["children"],T=["children"];function ownKeys(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function _objectSpread(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?ownKeys(Object(r),!0).forEach((function(t){(0,O.A)(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):ownKeys(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function DashboardSectionHeader_DashboardSectionHeader(e){var{children:t}=e,r=(0,W.A)(e,T);return(0,b.jsx)(a.XStack,_objectSpread(_objectSpread({alignItems:"center",space:"$5",userSelect:"none",$gtMd:{pt:"$1",mt:"$1",borderTopWidth:1,borderColor:"$borderSubdued"}},r),{},{children:t}))}DashboardSectionHeader_DashboardSectionHeader.Heading=function SectionHeading(e){var{selected:t,children:r}=e,n=(0,W.A)(e,B);return(0,b.jsx)(a.Heading,_objectSpread(_objectSpread(_objectSpread({size:"$headingLg",selectable:!1,py:"$2.5"},!t&&{opacity:.5}),n),{},{children:r}))},DashboardSectionHeader_DashboardSectionHeader.Button=function SectionButton(e){var{children:t}=e,r=(0,W.A)(e,I);return(0,b.jsx)(a.Button,_objectSpread(_objectSpread({size:"medium",variant:"tertiary",ml:"auto"},r),{},{children:t}))};var C=r(848312),P=r(344145),M=r.n(P),H=r(17617),L=r(812715),_=r(584186),E=["children","horizontal"];function ChunkedItemsView_ownKeys(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function ChunkedItemsView_objectSpread(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?ChunkedItemsView_ownKeys(Object(r),!0).forEach((function(t){(0,O.A)(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):ChunkedItemsView_ownKeys(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}var chunkArray=function(e,t){for(var r=[],n=0;n<e.length;n+=t)r.push(e.slice(n,n+t));return r},R=M()((function(){return(0,a.getTokenValue)("$12","size")}),{maxAge:_.A.getTimeDurationMs({minute:10})});function useCardWidth(){var{width:e}=(0,L.A)();return e-R()}function ItemsContainer(e){var{children:t,horizontal:r}=e,n=(0,W.A)(e,E),o=(0,a.useMedia)(),i=function usePaginationStyle(e){var t=useCardWidth(),r=R();return e?{horizontal:!0,showsHorizontalScrollIndicator:!1,decelerationRate:0,snapToInterval:t,snapToAlignment:"start",contentContainerStyle:{paddingRight:r}}:void 0}(!!r);return o.gtMd?(0,b.jsx)(a.Stack,ChunkedItemsView_objectSpread(ChunkedItemsView_objectSpread({},n),{},{children:t})):(0,b.jsx)(a.ScrollView,ChunkedItemsView_objectSpread(ChunkedItemsView_objectSpread(ChunkedItemsView_objectSpread({pagingEnabled:!0},i),n),{},{contentContainerStyle:ChunkedItemsView_objectSpread(ChunkedItemsView_objectSpread({},n.contentContainerStyle),i?.contentContainerStyle),children:t}))}function ChunkedItemsView({isExploreView:e,dataChunks:t,handleOpenWebSite:r}){var n=useCardWidth();return(0,b.jsx)(ItemsContainer,{mx:"$-5",$md:c.Ay.isRuntimeBrowser?{ml:"$-3"}:void 0,horizontal:!e,contentContainerStyle:{px:"$2",$md:{flexDirection:e?"column":"row"},$gtMd:{flexDirection:"column"}},children:t.map((function(t,o){return(0,b.jsx)(a.Stack,{$md:e?{flexDirection:"row",flexWrap:"wrap"}:{w:n},$gtMd:{flexDirection:"row",flexWrap:"wrap"},children:t.map((function(t){return(0,b.jsxs)(a.XStack,{group:"card",p:"$3",alignItems:"center",$md:e?{flexBasis:"100%"}:void 0,$gtMd:{px:"$5",flexBasis:"50%"},$gtLg:{px:"$5",flexBasis:"33.3333%"},onPress:function(){return r({webSite:{url:t.url,title:t.name}})},userSelect:"none",testID:`dapp-${t.dappId}`,children:[(0,b.jsxs)(a.Image,{w:"$14",h:"$14",borderRadius:"$3","$group-card-hover":{opacity:.75},borderWidth:H.A.hairlineWidth,borderColor:"$borderSubdued",borderCurve:"continuous",children:[(0,b.jsx)(a.Image.Source,{source:{uri:t.logo}}),(0,b.jsx)(a.Image.Fallback,{children:(0,b.jsx)(a.Icon,{name:"GlobusOutline",width:"100%",height:"100%"})}),(0,b.jsx)(a.Image.Loading,{children:(0,b.jsx)(a.Skeleton,{width:"100%",height:"100%"})})]}),(0,b.jsxs)(a.Stack,{flex:1,ml:"$3",children:[(0,b.jsxs)(a.XStack,{alignItems:"center",children:[(0,b.jsx)(a.SizableText,{size:"$bodyLgMedium",$gtMd:{size:"$bodyMdMedium"},numberOfLines:1,children:t.name}),Array.isArray(t.tags)&&t.tags.length?(0,b.jsx)(a.Badge,{badgeSize:"sm",badgeType:t.tags[0].type,ml:"$2",children:t.tags[0].name}):null]}),(0,b.jsx)(a.SizableText,{size:"$bodyMd",color:"$textSubdued",numberOfLines:1,$gtMd:{size:"$bodySm",numberOfLines:2,whiteSpace:"break-spaces"},children:t.description})]})]},t.dappId)}))},o)}))})}function ChunkedItemsSkeletonView({isExploreView:e,dataChunks:t}){var r=useCardWidth();return(0,b.jsx)(ItemsContainer,{mx:"$-5",$gtMd:{mx:"$-3"},horizontal:!e,contentContainerStyle:{px:"$2",$md:{flexDirection:e?"column":"row"},$gtMd:{flexDirection:"column"}},children:t?.map((function(t,n){return(0,b.jsx)(a.Stack,{$md:e?{flexDirection:"row",flexWrap:"wrap"}:{w:r},$gtMd:{flexDirection:"row",flexWrap:"wrap"},children:t.map((function(t){return(0,b.jsxs)(a.XStack,{p:"$3",space:"$3",alignItems:"center",$md:e?{flexBasis:"100%"}:void 0,$gtMd:{flexBasis:"50%"},$gtLg:{flexBasis:"33.3333%"},children:[(0,b.jsx)(a.Skeleton,{w:"$14",h:"$14",borderRadius:"$3"}),(0,b.jsxs)(a.Stack,{flex:1,space:"$1",children:[(0,b.jsx)(a.XStack,{alignItems:"center",children:(0,b.jsx)(a.Skeleton,{w:"$20",h:"$4"})}),(0,b.jsx)(a.Skeleton,{w:216,h:"$4",$md:{w:"100%"}})]})]},t.dappId)}))},n)}))})}var V=r(86677),N=r(885127);function ExploreView({isLoading:e,dAppList:t,categoryResult:r,handleOpenWebSite:o,selectedCategory:i,setSelectedCategory:c,selectedNetwork:u,setSelectedNetwork:d,networkList:p}){var f,g,h=(0,s.A)(),y=(0,a.useMedia)(),m=(0,n.useMemo)((function(){return y.gtMd?y.lg?2:3:1}),[y]),w=(0,n.useMemo)((function(){return Array.isArray(r?.categoryList)?r.categoryList.map((function(e){return{value:e.categoryId,label:e.name}})):[]}),[r?.categoryList]),v=!t?.data||0===t?.data.length,S=(0,n.useCallback)((function(e,t){return(0,b.jsx)(ChunkedItemsView,{isExploreView:!0,dataChunks:e,handleOpenWebSite:o},t)}),[o]),k=(0,n.useCallback)((function(e,t){return(0,b.jsx)(ChunkedItemsSkeletonView,{isExploreView:!0,dataChunks:e},t)}),[]),D=(0,n.useMemo)((function(){var r;return v?(0,b.jsx)(a.Empty,{icon:"SearchOutline",title:h.formatMessage({id:l.ETranslations.global_no_results})}):e?k(chunkArray(Array.from({length:30}).map((function(e,t){return{dappId:t.toString()}})),m),i):S(chunkArray(null!=(r=t?.data)?r:[],m),i)}),[h,v,e,t?.data,m,i,k,S]),x=(0,N.A)();return(0,b.jsxs)(b.Fragment,{children:[(0,b.jsxs)(a.XStack,{py:"$2",children:[(0,b.jsx)(a.Select,{title:h.formatMessage({id:l.ETranslations.explore_categories}),items:w,value:i,onChange:c,renderTrigger:function({label:e}){return(0,b.jsxs)(a.XStack,{mr:"$2.5",py:"$1.5",px:"$2",bg:"$bgStrong",borderRadius:"$3",userSelect:"none",borderCurve:"continuous",hoverStyle:{bg:"$bgStrongHover"},pressStyle:{bg:"$bgStrongActive"},children:[(0,b.jsx)(a.SizableText,{size:"$bodyMdMedium",px:"$1",children:e}),(0,b.jsx)(a.Icon,{name:"ChevronDownSmallOutline",size:"$5",color:"$iconSubdued"})]})}}),(0,b.jsxs)(a.XStack,{py:"$1.5",px:"$2",bg:"$bgStrong",borderRadius:"$3",userSelect:"none",borderCurve:"continuous",hoverStyle:{bg:"$bgStrongHover"},pressStyle:{bg:"$bgStrongActive"},onPress:function(){x({onSelect:function(e){e&&d(e)},defaultNetworkId:u?.id,networkIds:p})},children:[(0,b.jsx)(a.Image,{w:"$5",h:"$5",children:(0,b.jsx)(V.b,{source:{uri:null!=(f=u?.logoURI)?f:""}})}),(0,b.jsx)(a.XStack,{maxWidth:119,children:(0,b.jsx)(a.SizableText,{size:"$bodyMdMedium",px:"$1",numberOfLines:1,children:null!=(g=u?.name)?g:""})}),(0,b.jsx)(a.Icon,{name:"ChevronDownSmallOutline",size:"$5",color:"$iconSubdued"})]})]}),D]})}function SuggestedView_ownKeys(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function SuggestedView_objectSpread(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?SuggestedView_ownKeys(Object(r),!0).forEach((function(t){(0,O.A)(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):SuggestedView_ownKeys(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function SuggestedView({suggestedData:e,handleOpenWebSite:t}){var r=(0,a.useMedia)(),o=r.gtMd&&r.lg?2:3,i=(0,n.useMemo)((function(){return e.map((function(e){return SuggestedView_objectSpread(SuggestedView_objectSpread({},e),{},{dataChunks:chunkArray(e.dapps,o)})}))}),[e,o]),s=(0,n.useCallback)((function(e,r){return(0,b.jsx)(ChunkedItemsView,{isExploreView:!1,dataChunks:e,handleOpenWebSite:t},r)}),[t]);return(0,b.jsx)(b.Fragment,{children:i.map((function(e,t){return(0,b.jsxs)(a.Stack,{children:[(0,b.jsx)(a.Heading,SuggestedView_objectSpread(SuggestedView_objectSpread({size:"$headingMd",pt:"$2",selectable:!1},0!==t&&{pt:"$5"}),{},{children:e.name})),s(e.dataChunks,e.categoryId)]},`${e.name}--${e.categoryId}`)}))})}function SuggestedAndExploreSection({suggestedData:e,handleOpenWebSite:t,isLoading:r}){var o=(0,s.A)(),[i,c]=(0,n.useState)(!1),[u,d]=(0,n.useState)(""),[p,f]=(0,n.useState)(),{result:g}=(0,v.yk)((0,h.A)((function*(){var[e,t,r]=yield Promise.all([y.A.serviceDiscovery.fetchCategoryList(),y.A.serviceNetwork.getNetwork({networkId:(0,C.V$)().eth}),y.A.serviceNetwork.getDappInteractionEnabledNetworks()]),n=r.map((function(e){return e.id}));return d(e[0].categoryId),f(t),{categoryList:e,networkList:n}})),[]),{result:m,isLoading:w}=(0,v.yk)((0,h.A)((function*(){return u&&p?y.A.serviceDiscovery.fetchDAppListByCategory({category:u,network:p.id}):{data:[],next:""}})),[u,p],{watchLoading:!0}),S=(0,a.useMedia)(),k=S.gtMd&&S.lg?2:3,D=(0,n.useCallback)((function(){return(0,b.jsx)(a.Stack,{space:"$5",children:Array.from({length:4}).map((function(e,t){return(0,b.jsxs)(a.Stack,{space:"$3",children:[(0,b.jsx)(a.Skeleton,{w:"$14",h:"$6"}),(0,b.jsx)(ChunkedItemsSkeletonView,{isExploreView:!0,dataChunks:chunkArray(Array.from({length:k}).map((function(e,t){return{dappId:`first-${t}`}})),k)},"skeleton-view")]},t)}))})}),[k]),x=(0,n.useCallback)((function(){return A()(r)||r?D():i?(0,b.jsx)(ExploreView,{isLoading:w,dAppList:m,categoryResult:g,selectedCategory:u,selectedNetwork:p,setSelectedCategory:d,setSelectedNetwork:f,networkList:null!=(n=g?.networkList)?n:[],handleOpenWebSite:t}):(0,b.jsx)(SuggestedView,{suggestedData:e,handleOpenWebSite:t});var n}),[w,i,r,D,e,t,m,g,u,p,d,f]);return(0,b.jsxs)(a.Stack,{p:"$5","$platform-native":{pb:"$16"},tag:"section",children:[(0,b.jsxs)(DashboardSectionHeader_DashboardSectionHeader,{children:[(0,b.jsx)(DashboardSectionHeader_DashboardSectionHeader.Heading,{selected:!i,onPress:function(){return c(!1)},children:o.formatMessage({id:l.ETranslations.explore_suggested})},"suggested"),(0,b.jsx)(DashboardSectionHeader_DashboardSectionHeader.Heading,{selected:i,onPress:function(){return c(!0)},children:o.formatMessage({id:l.ETranslations.explore_explore})},"explore")]}),x()]})}const q=(0,n.memo)((function DashboardContent({onScroll:e}){var t=(0,o.A)(),{displayHomePage:r}=((0,S.E)(),(0,u.y)()),{handleOpenWebSite:s}=(0,k.yZ)().current,{result:[l,c]=[],run:d}=(0,v.yk)((0,h.A)((function*(){var e=y.A.serviceDiscovery.getBookmarkData({generateIcon:!0,sliceCount:8}),t=y.A.serviceDiscovery.getHistoryData({generateIcon:!0,sliceCount:8});return Promise.all([e,t])})),[],{watchLoading:!0}),{result:p,isLoading:f}=(0,v.yk)((0,h.A)((function*(){return yield y.A.serviceDiscovery.fetchDiscoveryHomePageData()})),[],{watchLoading:!0,checkIsFocused:!1});(0,w.A)(i.V4.Discovery,(function(e){e&&setTimeout((function(){d()}))})),(0,n.useEffect)((function(){0}),[r,d]);var g=(0,n.useCallback)((function(e){t.pushModal(i.ry.DiscoveryModal,{screen:e?i.v1.HistoryListModal:i.v1.BookmarkListModal})}),[t]),$=(0,n.useMemo)((function(){return(0,b.jsxs)(b.Fragment,{children:[(0,b.jsx)(Banner,{banners:Array.isArray(p?.banners)?p?.banners:[],handleOpenWebSite:function({webSite:e,useSystemBrowser:r}){r&&e?.url?(0,j.Dr)(e.url):e?.url&&s({webSite:e,navigation:t,shouldPopNavigation:!1}),D.U.discovery.dapp.enterDapp({dappDomain:e?.url||"",dappName:e?.title||"",enterMethod:x.z.banner})},isLoading:f},"Banner"),null,(0,b.jsx)(m.O,{children:(0,b.jsx)(SuggestedAndExploreSection,{suggestedData:Array.isArray(p?.categories)?p.categories:[],handleOpenWebSite:function({webSite:e}){s({webSite:e,navigation:t,shouldPopNavigation:!1}),D.U.discovery.dapp.enterDapp({dappDomain:e?.url||"",dappName:e?.title||"",enterMethod:x.z.dashboard})},isLoading:f},"SuggestedAndExploreSection")})]})}),[l,c,g,s,t,p,f]);return(0,b.jsx)(a.Stack,{children:$})}));const U=(0,d.k)((function Dashboard(){var e=(0,o.A)(),t=(0,n.useCallback)((function(){e.pushModal(i.ry.DiscoveryModal,{screen:i.v1.SearchModal})}),[e]),r=(0,n.useCallback)((function(){return(0,b.jsx)(g,{handleSearchBarPress:t})}),[t]);return(0,b.jsxs)(a.Page,{scrollEnabled:!0,children:[(0,b.jsx)(a.Page.Header,{headerTitle:r}),(0,b.jsx)(a.Page.Body,{children:(0,b.jsx)(q,{})})]})}))},660015:(e,t,r)=>{r.d(t,{F:()=>s,Mr:()=>formatHiddenHttpsUrl,O3:()=>o,T0:()=>crossWebviewLoadUrl,ay:()=>i,n5:()=>a});var n=r(663522),a="StandardBrowser",o={};function getWebviewWrapperRef(e){var t=e?o[e]:null;return null!=t?t:null}function formatHiddenHttpsUrl(e){return{isHttpsUrl:e&&/^https/i.test(e),hiddenHttpsUrl:e?.replace?.(/^https:\/\//i,"")}}function crossWebviewLoadUrl({url:e,tabId:t}){var r=getWebviewWrapperRef(t);n.Ay.isRuntimeBrowser?r?.innerRef?.loadURL(e):r?.innerRef?.loadUrl(e)}var i="\n(function(){\n  if (window.WebSocket) {\n    if (!window.$$onekeyWebSocketSend) {\n      window.$$onekeyWebSocketSend = window.WebSocket.prototype.send;\n    }\n    window.WebSocket.prototype.send = () => {};\n  }\n})()\n",s="\n(function(){\n  if (\n    window.WebSocket &&\n    window.$$onekeyWebSocketSend\n  ) {\n    window.WebSocket.prototype.send = window.$$onekeyWebSocketSend;\n  }\n})()\n"},187576:(e,t,r)=>{r.d(t,{s:()=>o});var n=r(663522),a=n.Ay.isDesktopMac||n.Ay.isNativeIOS||function(){if("undefined"!=typeof navigator){if("platform"in navigator)return navigator.platform.toLowerCase().indexOf("mac")>-1;if("userAgentData"in navigator)return(navigator.userAgentData?.platform.toLowerCase().indexOf("mac")||-1)>-1}return!1}(),o={CmdOrCtrl:a?"⌘":"Ctrl",Alt:a?"⌥":"Alt",Shift:a?"⇧":"Shift",Left:"←",Right:"→",Up:"↑",Down:"↓",Search:"/"}}}]);
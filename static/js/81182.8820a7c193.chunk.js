"use strict";(self.webpackChunkweb=self.webpackChunkweb||[]).push([[81182],{424403:(e,t,n)=>{n.d(t,{KR:()=>useCheckAccountExist,Mo:()=>useAccountInfoForManageToken,YF:()=>useAddToken,yT:()=>useAddTokenForm});var r=n(586330),o=n(514041),s=n(241440),a=n(578104),d=n(490343),c=n(848312),i=n(184251),l=n(60153),u=n(911998);function useAddTokenForm({token:e,networkId:t}){var n=i.A.isAllNetwork({networkId:t}),r=(0,o.useCallback)((function(){return e&&e.networkId?e.networkId:n?(0,c.V$)().eth:t}),[n,t,e]),a=(0,d.useForm)({values:{networkId:r(),contractAddress:e?.address||"",symbol:e?.symbol||"",decimals:e?.decimals?new s.A(e.decimals).toString():""},mode:"onChange",reValidateMode:"onBlur"}),l=a.watch("networkId"),u=a.watch("contractAddress"),k=a.watch("symbol"),m=a.watch("decimals"),[f,w]=(0,o.useState)(!1),I=(0,o.useRef)(!0),b=(0,o.useCallback)((function(t){I.current||(e?.address||u)&&w(t)}),[u,e?.address]);return(0,o.useEffect)((function(){I.current?I.current=!1:a.trigger("contractAddress")}),[f,a]),{form:a,isEmptyContract:f,setIsEmptyContractState:b,selectedNetworkIdValue:l,contractAddressValue:u,symbolValue:k,decimalsValue:m}}function useAddToken({token:e,walletId:t,networkId:n,form:d,selectedNetworkIdValue:c,contractAddressValue:i,setIsEmptyContractState:k}){var m,{result:f}=(0,u.yk)((0,r.A)((function*(){var t=(yield l.A.serviceNetwork.getCustomTokenEnabledNetworks({currentNetworkId:n})).map((function(e){return e.id})),r=yield l.A.serviceNetwork.getNetwork({networkId:n});return e?.networkId&&!t.includes(e.networkId)&&t.push(e.networkId),{networkIds:t,network:r}})),[n,e?.networkId]),w=(0,o.useRef)(),I=(0,a.YQ)((m=(0,r.A)((function*(n){var r;if(!e&&!n.value.trim())return d.setValue("symbol",""),d.setValue("decimals",""),void k(!0);var o=yield l.A.serviceCustomToken.searchTokenByContractAddress({walletId:t,networkId:n.networkId,contractAddress:n.value,isNative:null!=(r=e?.isNative)&&r});if(Array.isArray(o)&&o.length>0&&o[0]?.info){var[a]=o;d.setValue("symbol",a.info.symbol),d.setValue("decimals",new s.A(a.info.decimals).toString()),w.current=a.info,k(!1)}else d.setValue("symbol",""),d.setValue("decimals",""),k(!0)})),function(e){return m.apply(this,arguments)}),300);return(0,o.useEffect)((function(){I({value:i,networkId:c})}),[i,c,I]),{availableNetworks:f,searchedTokenRef:w}}function useAccountInfoForManageToken(){var e,t=(0,o.useCallback)((e=(0,r.A)((function*({accountId:e,networkId:t,isOthersWallet:n,indexedAccountId:r,deriveType:o,selectedNetworkId:s}){var{serviceAccount:a}=l.A,d=!1,c="";try{c=n?(yield a.getAccount({accountId:e,networkId:t})).id:(yield a.getNetworkAccount({accountId:void 0,indexedAccountId:r,networkId:s,deriveType:o})).id,d=!0}catch(e){d=!1}return{hasExistAccountFlag:d,accountIdForNetwork:c}})),function(t){return e.apply(this,arguments)}),[]);return{findAccountInfoForNetwork:t}}function useCheckAccountExist({accountId:e,networkId:t,isOthersWallet:n,indexedAccountId:s,deriveType:a,selectedNetworkIdValue:d}){var{findAccountInfoForNetwork:c}=useAccountInfoForManageToken(),i=(0,o.useCallback)((0,r.A)((function*(){return c({accountId:e,networkId:t,isOthersWallet:n,indexedAccountId:s,deriveType:a,selectedNetworkId:d})})),[e,s,t,n,a,d,c]),{result:l,run:k}=(0,u.yk)((0,r.A)((function*(){var{hasExistAccountFlag:e}=yield i();return e})),[i]);return{hasExistAccount:l,runCheckAccountExist:k,checkAccountIsExist:i}}},281182:(e,t,n)=>{n.r(t),n.d(t,{default:()=>A});var r=n(586330),o=n(324586),s=n(514041),a=n(724249),d=n(241440),c=n(908867),i=n(490343),l=n(325809),u=n(525603),k=n(254491),m=n(184251),f=n(714191),w=n(60153),I=n(414375),b=n(424403),g=n(831085);function ownKeys(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function _objectSpread(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?ownKeys(Object(n),!0).forEach((function(t){(0,o.A)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):ownKeys(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function CreateAddressButton(e){var t=(0,c.A)();return(0,g.jsx)(i.Button,_objectSpread(_objectSpread({$md:{flexGrow:1,flexBasis:0,size:"large"},variant:"primary"},e),{},{children:t.formatMessage({id:k.ETranslations.global_create_address})}))}function AddCustomTokenModal(){var e,t=(0,c.A)(),n=(0,a.lq)(),{walletId:o,networkId:f,indexedAccountId:A,accountId:y,isOthersWallet:h,deriveType:p,token:x,onSuccess:_}=n.params,v=m.A.isAllNetwork({networkId:f}),{form:T,isEmptyContract:j,setIsEmptyContractState:E,selectedNetworkIdValue:C,contractAddressValue:M,symbolValue:N,decimalsValue:$}=(0,b.yT)({token:x,networkId:f}),{hasExistAccount:S,runCheckAccountExist:F,checkAccountIsExist:O}=(0,b.KR)({accountId:y,networkId:f,isOthersWallet:h,indexedAccountId:A,deriveType:p,selectedNetworkIdValue:C}),{availableNetworks:V,searchedTokenRef:z}=(0,b.YF)({token:x,walletId:o,networkId:f,form:T,selectedNetworkIdValue:C,contractAddressValue:M,setIsEmptyContractState:E,checkAccountIsExist:O}),[P,R]=(0,s.useState)(!1),B=(0,s.useMemo)((function(){return!S||(!!j||(!N||!new d.A($).isInteger()||!!P))}),[N,$,j,P,S]),D=(0,s.useCallback)((e=(0,r.A)((function*(e){R(!0);var{hasExistAccountFlag:n,accountIdForNetwork:r}=yield O();if(n){var o=T.getValues(),{contractAddress:s,symbol:a,decimals:c}=o;if(!s&&!x?.isNative)return R(!1),void i.Toast.error({title:t.formatMessage({id:k.ETranslations.manger_token_custom_token_address_required})});if(!a||!new d.A(c).isInteger())return R(!1),void i.Toast.error({title:t.formatMessage({id:k.ETranslations.send_engine_incorrect_address})});try{var l,u,m=_objectSpread(_objectSpread({address:s,symbol:a,decimals:new d.A(c).toNumber()},z.current),{},{accountId:r,networkId:C,allNetworkAccountId:v?y:void 0,name:null!=(l=z.current?.name)?l:"",isNative:null!=(u=z.current?.isNative)&&u,$key:`${C}_${s}`});yield w.A.serviceCustomToken.activateToken({accountId:r,networkId:C,token:m}),yield w.A.serviceCustomToken.addCustomToken({token:m})}finally{R(!1)}i.Toast.success({title:t.formatMessage({id:k.ETranslations.address_book_add_address_toast_add_success})}),setTimeout((function(){_?.(),e?.()}),300)}else i.Toast.error({title:"Account not exist"})})),function(t){return e.apply(this,arguments)}),[T,O,C,x?.isNative,t,_,v,y,z]),W=(0,s.useCallback)((function(){var e;return v?(0,g.jsx)(i.Form.Field,{label:t.formatMessage({id:k.ETranslations.global_chain}),name:"networkId",children:(0,g.jsx)(l.YS,{networkIds:V?.networkIds})}):(0,g.jsx)(i.Form.Field,{label:t.formatMessage({id:k.ETranslations.global_network}),name:"networkId",children:(0,g.jsxs)(i.Stack,{userSelect:"none",flexDirection:"row",alignItems:"center",borderRadius:"$3",borderWidth:1,borderCurve:"continuous",borderColor:"$borderStrong",px:"$3",py:"$2.5",$gtMd:{borderRadius:"$2",py:"$2"},testID:"network-selector-input",children:[(0,g.jsx)(I.um,{networkId:f,size:"$6"}),(0,g.jsx)(i.SizableText,{px:14,flex:1,size:"$bodyLg",children:null!=(e=V?.network.name)?e:""})]})})}),[V,t,v,f]);return(0,g.jsxs)(i.Page,{children:[(0,g.jsx)(i.Page.Header,{title:t.formatMessage({id:k.ETranslations.manage_token_custom_token_title})}),(0,g.jsx)(i.Page.Body,{px:"$5",children:(0,g.jsxs)(i.Form,{form:T,children:[W(),(0,g.jsx)(i.Form.Field,{label:t.formatMessage({id:k.ETranslations.manage_token_custom_token_contract_address}),rules:{validate:function(){if(j)return t.formatMessage({id:k.ETranslations.Token_manage_custom_token_address_faild})}},name:"contractAddress",children:(0,g.jsx)(i.Input,{size:"large",$gtMd:{size:"medium"},editable:!x?.isNative})}),(0,g.jsx)(i.Form.Field,{label:t.formatMessage({id:k.ETranslations.manage_token_custom_token_symbol}),name:"symbol",children:(0,g.jsx)(i.Input,{size:"large",$gtMd:{size:"medium"},editable:!1})}),(0,g.jsx)(i.Form.Field,{label:t.formatMessage({id:k.ETranslations.manage_token_custom_token_decimal}),name:"decimals",children:(0,g.jsx)(i.Input,{size:"large",$gtMd:{size:"medium"},editable:!1})})]})}),(0,g.jsx)(i.Page.Footer,{onConfirmText:t.formatMessage({id:k.ETranslations.manage_token_custom_token_add_btn}),onConfirm:D,confirmButtonProps:{loading:P,disabled:B},children:S?void 0:(0,g.jsx)(i.Stack,{p:"$5",$gtMd:{flexDirection:"row",alignItems:"center"},bg:"$bgApp",children:(0,g.jsxs)(i.XStack,{space:"$2.5",$gtMd:{ml:"auto"},flex:1,justifyContent:"space-between",children:[(0,g.jsxs)(i.XStack,{alignItems:"center",space:"$2",children:[(0,g.jsx)(i.SizableText,{size:"$bodyMdMedium",color:"$text",children:t.formatMessage({id:k.ETranslations.manage_token_custom_token_create_address})}),(0,g.jsx)(i.Icon,{name:"ArrowRightOutline",color:"$iconSubdued",size:"$5"}),(0,g.jsx)(i.SizableText,{size:"$bodyMdMedium",color:"$textSubdued",children:t.formatMessage({id:k.ETranslations.manage_token_custom_token_add})})]}),(0,g.jsx)(u.J,{num:0,account:{walletId:o,indexedAccountId:A,networkId:C,deriveType:p},buttonRender:CreateAddressButton,onCreateDone:function(){setTimeout((function(){F()}))}})]})})})]})}const A=function AddCustomTokenModalWithMirror(){return(0,g.jsx)(l.b8,{config:{sceneName:f.Zs.home},enabledNum:[0],children:(0,g.jsx)(AddCustomTokenModal,{})})}}}]);
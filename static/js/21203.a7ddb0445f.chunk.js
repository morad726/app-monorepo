"use strict";(self.webpackChunkweb=self.webpackChunkweb||[]).push([[21203],{793437:(e,t,n)=>{n.d(t,{X:()=>OpenInAppButton});var r=n(586330),o=n(514041),i=n(908867),a=n(17617),s=n(490343),c=n(889949),l=n(726130),u=n(254491),d=n(663522),f=n(117746),p=n(911998),k=n(831085);function OpenInAppButton({buildDeepLinkUrl:e,buildFullUrl:t}){var n=(0,i.A)(),{result:m}=(0,p.yk)((0,r.A)((function*(){var t=e();return(yield f.Ay.linkingCanOpenURL(t))?t:""})),[e]),y=((0,o.useMemo)((function(){return d.Ay.isWebMobile?d.Ay.isWebMobileAndroid?"Open by OneKey Android":d.Ay.isWebMobileIOS?"Open by OneKey iOS":void 0:"Open by OneKey Desktop"}),[]),(0,o.useCallback)((0,r.A)((function*(){var e=yield t();s.Dialog.show({title:n.formatMessage({id:u.ETranslations.open_in_mobile_app}),floatingPanelProps:{overflow:"hidden"},renderContent:(0,k.jsxs)(s.Stack,{children:[(0,k.jsx)(s.Stack,{alignItems:"center",justifyContent:"center",overflow:"hidden",children:(0,k.jsx)(s.Stack,{p:"$4",borderRadius:"$6",borderCurve:"continuous",borderWidth:a.A.hairlineWidth,borderColor:"$borderSubdued",children:(0,k.jsx)(s.QRCode,{value:e,logo:c,logoSize:40,size:224})})}),(0,k.jsxs)(s.XStack,{m:"$-5",mt:"$5",py:"$4",px:"$5",backgroundColor:"$bgSubdued",alignItems:"center",children:[(0,k.jsx)(s.SizableText,{size:"$bodyMd",color:"$textSubdued",flex:1,children:n.formatMessage({id:u.ETranslations.dont_have_mobile_app_yet})}),(0,k.jsx)(s.Button,{size:"small",onPress:function(){(0,f.Dr)(l.A8)},children:n.formatMessage({id:u.ETranslations.global_download})})]})]}),showFooter:!1})})),[t,n]));return(0,k.jsx)(s.Button,{size:"small",onPress:y,children:n.formatMessage({id:u.ETranslations.open_in_mobile_app})})}},660823:(e,t,n)=>{n.d(t,{i:()=>TabPageHeader});var r=n(514041),o=n(490343),i=n(901976),a=n(162616),s=n(208257),c=n(325809),l=n(714191),u=n(831085);function HeaderLeft({sceneName:e}){var t=(0,r.useMemo)((function(){return e===l.Zs.homeUrlAccount?(0,u.jsx)(o.Page.Close,{children:(0,u.jsx)(o.NavBackButton,{})}):(0,u.jsx)(c.Qt,{num:0},"accountSelectorTrigger")}),[e]);return(0,u.jsx)(c.b8,{enabledNum:[0],config:{sceneName:e,sceneUrl:""},children:t})}var d=n(586330),f=n(908867),p=n(896666),k=n(384013),m=n(254491),y=n(663522),h=n(757559),w=n(60153),g=n(498356),b=n(793437),v=n(211129),A=n(491180),T=n(796151),I=n(826339);function OpenInAppButtonContainer(){var{activeAccount:{account:e,network:t}}=(0,a.LH)({num:0}),n=(0,r.useCallback)((function(){return e&&t?T.Ay.buildDeepLinkUrl({path:v.oO.url_account,query:{networkCode:t.code,address:e.address}}):""}),[e,t]),o=(0,r.useCallback)((0,d.A)((function*(){return e&&t?(0,I.Hw)({account:e,network:t}):"n"})),[e,t]);return e?.address&&t?.id?(0,u.jsx)(b.X,{buildDeepLinkUrl:n,buildFullUrl:o}):null}function ShareButton(){var{activeAccount:{account:e,network:t}}=(0,a.LH)({num:0}),{shareText:n}=(0,o.useShare)();return e?.address&&t?.id?(0,u.jsx)(o.HeaderIconButton,{onPress:(0,d.A)((function*(){var r=yield(0,I.Hw)({account:e,network:t});yield n(r)})),icon:"ShareOutline"}):null}var j={Address:function Address(){var{activeAccount:{account:e}}=(0,a.LH)({num:0});return(0,o.useMedia)(),(0,u.jsxs)(o.XStack,{alignItems:"center",children:[(0,u.jsx)(o.SizableText,{size:"$headingLg",children:A.A.shortenAddress({address:e?.address})}),null]})},OpenInApp:function OpenInApp(){return(0,u.jsx)(c.b8,{config:{sceneName:l.Zs.homeUrlAccount,sceneUrl:""},enabledNum:[0],children:(0,u.jsx)(OpenInAppButtonContainer,{})})},Share:function Share(){return(0,u.jsx)(c.b8,{config:{sceneName:l.Zs.homeUrlAccount,sceneUrl:""},enabledNum:[0],children:(0,u.jsx)(ShareButton,{})})}},S=n(147882),x=n(390574),O=n(506851);function UniversalSearchInput(){var e=(0,f.A)(),t=(0,g.A)(),n=(0,r.useCallback)((function(){t.pushModal(h.ry.UniversalSearchModal,{screen:x.j.UniversalSearch,params:{filterType:O.j.Address}})}),[t]);return(0,u.jsxs)(o.XStack,{w:280,children:[(0,u.jsx)(o.Input,{leftIconName:"SearchOutline",containerProps:{w:"100%"},size:"small",placeholder:e.formatMessage({id:m.ETranslations.global_search_address})},"searchInput"),(0,u.jsx)(o.View,{position:"absolute",top:0,left:0,right:0,bottom:0,onPress:n})]})}function HeaderRight({sceneName:e}){var t=(0,f.A)(),n=(0,g.A)(),i=(0,S.A)(),{activeAccount:{account:s}}=(0,a.LH)({num:0}),[c]=(0,k.RI)(),[b]=(0,k.D4)(),v=(0,r.useCallback)((function(){n.pushModal(h.ry.SettingModal,{screen:h.Pj.SettingListModal})}),[n]),A=(0,r.useCallback)((function(){return i.start({handlers:i.PARSE_HANDLER_NAMES.all,autoHandleResult:!0,account:s,tokens:{data:c.tokens,keys:c.keys,map:b}})}),[i,s,c,b]),T=(0,r.useCallback)((0,d.A)((function*(){var e,n,r,i={routes:""};o.ActionList.show({title:t.formatMessage({id:m.ETranslations.global_layout}),items:[y.Ay.isExtensionUiPopup?{label:t.formatMessage({id:m.ETranslations.open_as_sidebar}),icon:"LayoutRightOutline",onPress:(r=(0,d.A)((function*(){yield w.A.serviceApp.openExtensionSidePanelOnActionClick(!0),yield w.A.serviceApp.openExtensionSidePanel(i),window.close()})),function onPress(){return r.apply(this,arguments)})}:{label:t.formatMessage({id:m.ETranslations.open_as_popup}),icon:"LayoutTopOutline",onPress:(n=(0,d.A)((function*(){yield w.A.serviceApp.openExtensionSidePanelOnActionClick(!1),window.close()})),function onPress(){return n.apply(this,arguments)})},{label:t.formatMessage({id:m.ETranslations.global_expand_view}),icon:"ExpandOutline",onPress:(e=(0,d.A)((function*(){window.close(),yield w.A.serviceApp.openExtensionExpandTab(i)})),function onPress(){return e.apply(this,arguments)})}]})})),[t]),I=(0,o.useMedia)(),x=(0,r.useMemo)((function(){var n=(0,u.jsx)(p.v$,{title:t.formatMessage({id:m.ETranslations.settings_settings}),icon:"SettingsOutline",testID:"setting",onPress:v},"setting"),r=(0,u.jsx)(p.v$,{title:t.formatMessage({id:m.ETranslations.global_layout}),icon:"LayoutRightOutline",onPress:T},"layoutRightView"),o=(0,u.jsx)(p.v$,{title:t.formatMessage({id:m.ETranslations.scan_scan_qr_code}),icon:"ScanOutline",onPress:A},"scan"),i=I.gtMd?(0,u.jsx)(UniversalSearchInput,{},"searchInput"):null;return e===l.Zs.homeUrlAccount?[(0,u.jsx)(j.OpenInApp,{},"urlAccountOpenInApp"),(0,u.jsx)(j.Share,{},"urlAccountShare")].filter(Boolean):y.Ay.isExtensionUiPopup||y.Ay.isExtensionUiSidePanel?[r,n]:[o,n,i]}),[t,I.gtMd,A,T,v,e]);return(0,u.jsx)(p.bE,{testID:"Wallet-Page-Header-Right",className:"app-region-no-drag",children:x})}function HeaderTitle({sceneName:e}){var t=(0,r.useMemo)((function(){if(e===l.Zs.homeUrlAccount)return(0,u.jsx)(j.Address,{},"urlAccountNavHeaderAddress")}),[e]);return(0,u.jsx)(c.b8,{enabledNum:[0],config:{sceneName:e,sceneUrl:""},children:t})}function TabPageHeader({sceneName:e,showHeaderRight:t}){(0,i.e)({name:`web TabPageHeader:${e}:${String(t)}`});var n=(0,r.useCallback)((function(){return(0,u.jsx)(HeaderLeft,{sceneName:e})}),[e]),{config:l}=(0,a.H9)(),d=(0,r.useCallback)((function(){return t&&l?(0,u.jsx)(s.p,{children:(0,u.jsx)(c.b8,{enabledNum:[0],config:l,children:(0,u.jsx)(HeaderRight,{sceneName:e})})}):null}),[l,e,t]),f=(0,r.useCallback)((function(){return(0,u.jsx)(HeaderTitle,{sceneName:e})}),[e]);return(0,u.jsx)(u.Fragment,{children:(0,u.jsx)(o.Page.Header,{headerTitle:f,headerLeft:n,headerRight:d})})}},536612:(e,t,n)=>{n.d(t,{SX:()=>useAppUpdateInfo,sx:()=>useDownloadPackage,x7:()=>useAppChangeLog});var r=n(324586),o=n(586330),i=n(514041),a=n(908867),s=n(490343),c=n(604343),l=n(713132),u=n(254491),d=n(639451),f=n(757559),p=n(584186),k=n(60153),m=n(498356),y=n(911998);function ownKeys(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function _objectSpread(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?ownKeys(Object(n),!0).forEach((function(t){(0,r.A)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):ownKeys(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var useAppChangeLog=function(e){var t=(0,y.yk)((function(){return e?k.A.serviceAppUpdate.fetchChangeLog():Promise.resolve(null)}),[e]);return(0,i.useMemo)((function(){return t.result}),[t.result])},useDownloadPackage=function(){var e,t=(0,a.A)();return(0,i.useCallback)((e=(0,o.A)((function*(e){try{yield k.A.serviceAppUpdate.startDownloading();var n=yield(0,d.Xo)(e);yield k.A.serviceAppUpdate.verifyPackage(n),yield Promise.all([(0,d.sB)(n),p.A.wait(3e3)]),yield k.A.serviceAppUpdate.readyToInstall()}catch(e){s.Toast.error({title:t.formatMessage({id:u.ETranslations.global_update_failed})}),k.A.serviceAppUpdate.notifyFailed(e)}})),function(t){return e.apply(this,arguments)}),[t])},useAppUpdateInfo=function(e=!1){var t=(0,a.A)(),[n]=(0,c.useAppUpdatePersistAtom)(),r=(0,m.A)(),o=useDownloadPackage(),p=(0,i.useCallback)((function(){setTimeout((function(){(e?r.pushFullModal:r.pushModal)(f.ry.AppUpdateModal,{screen:f.mk.WhatsNew})}))}),[e,r.pushFullModal,r.pushModal]),y=(0,i.useCallback)((function(e=!1,t){(e?r.pushFullModal:r.pushModal)(f.ry.AppUpdateModal,{screen:f.mk.UpdatePreview,params:_objectSpread({latestVersion:n.latestVersion,isForceUpdate:n.isForceUpdate,autoClose:e},t)})}),[n.isForceUpdate,n.latestVersion,r.pushFullModal,r.pushModal]);(0,i.useEffect)((function(){(0,l.fK)(n)&&p(),n.status===l.ue.downloading&&o(n),k.A.serviceAppUpdate.fetchAppUpdateInfo().then((function(e){e?.isForceUpdate&&(0,l._q)(e.latestVersion,e.status)&&y(!0,e)}))}),[]);var h=(0,i.useCallback)((function(){switch(n.status){case l.ue.notify:case l.ue.downloading:case l.ue.verifying:y(e);break;case l.ue.ready:(0,d.Ed)(n).catch((function(e){s.Toast.error({title:t.formatMessage({id:u.ETranslations.global_update_failed})}),k.A.serviceAppUpdate.notifyFailed(e)}));break;case l.ue.failed:o(n)}}),[n,o,t,e,y]);return(0,i.useMemo)((function(){return{isNeedUpdate:(0,l._q)(n.latestVersion,n.status),data:n,onUpdateAction:h,toUpdatePreviewPage:y,onViewReleaseInfo:p}}),[n,h,p,y])}},989840:(e,t,n)=>{n.d(t,{wu:()=>p,Lu:()=>useAccountOverviewActions,Al:()=>b,mw:()=>w,we:()=>k});var r=n(324586),o=n(230414),i=n(929296),a=n(195309),s=n(972715),c=n(514041),l=n(241440),u=n(657355),d=n(714178),f=n(809690),{Provider:p,withProvider:k,contextAtom:m,contextAtomMethod:y}=(0,f.f)(),{atom:h,use:w}=m({worth:"0"}),{atom:g,use:b}=m({isRefreshing:!1,initialized:!1});function ownKeys(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function _objectSpread(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?ownKeys(Object(n),!0).forEach((function(t){(0,r.A)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):ownKeys(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function _createSuper(e){var t=_isNativeReflectConstruct();return function _createSuperInternal(){var n,r=(0,s.A)(e);if(t){var o=(0,s.A)(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return(0,a.A)(this,n)}}function _isNativeReflectConstruct(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(e){}return(_isNativeReflectConstruct=function(){return!!e})()}var v=function(e){(0,i.A)(ContextJotaiActionsAccountOverview,e);var t=_createSuper(ContextJotaiActionsAccountOverview);function ContextJotaiActionsAccountOverview(...e){var n;return(n=t.call(this,...e)).updateAccountOverviewState=y((function(e,t,n){t(g(),_objectSpread(_objectSpread({},e(g())),n))})),n.updateAccountWorth=y((function(e,t,n){if(n.merge){var r,{worth:o}=e(h());t(h(),{worth:new l.A(null!=o?o:"0").plus(null!=(r=n.worth)?r:"0").toFixed()})}else t(h(),{worth:n.worth})})),n}return(0,o.A)(ContextJotaiActionsAccountOverview)}(d.x),A=(0,u.j)((function(){return new v}));function useAccountOverviewActions(){var e=A(),t=e.updateAccountWorth.use(),n=e.updateAccountOverviewState.use();return(0,c.useRef)({updateAccountWorth:t,updateAccountOverviewState:n})}},349521:(e,t,n)=>{n.d(t,{F:()=>FirmwareUpdateReminderAlert,a:()=>HomeFirmwareUpdateReminder});var r=n(586330),o=n(514041),i=n(908867),a=n(490343),s=n(604343),c=n(254491),l=n(714191),u=n(60153),d=n(325809),f=n(498356),p=n(911998),k=n(162616),m=n(613838),y=n(318822);function BootloaderModeUpdateReminder(){var e=(0,f.A)(),t=(0,m.B)();return(0,o.useEffect)((function(){var fn=function(e){t.showBootloaderMode({connectId:e.connectId,existsFirmware:e.existsFirmware})};return y.iL.on(y.Tu.ShowFirmwareUpdateFromBootloaderMode,fn),function(){y.iL.off(y.Tu.ShowFirmwareUpdateFromBootloaderMode,fn)}}),[t,e]),null}var h=n(153763),w=n(491180),g=n(831085);function HomeFirmwareUpdateDetectCmp(){var{activeAccount:e}=(0,k.LH)({num:0}),t=e.device?.connectId,n=(0,h.E)(),r=(0,o.useMemo)((function(){return w.A.isHwWallet({walletId:e.wallet?.id})}),[e.wallet?.id]);return(0,o.useEffect)((function(){r&&t&&n&&u.A.serviceFirmwareUpdate.detectActiveAccountFirmwareUpdates({connectId:t})}),[r,t,n]),null}var b=(0,o.memo)((function HomeFirmwareUpdateDetectWithProvider(){var[e]=(0,s.useAppIsLockedAtom)();return e?null:(0,g.jsx)(d.b8,{config:{sceneName:l.Zs.home},enabledNum:[0],children:(0,g.jsx)(HomeFirmwareUpdateDetectCmp,{})})}));function FirmwareUpdateReminderAlert({message:e,onPress:t}){var n=(0,i.A)();return(0,g.jsxs)(a.XStack,{px:"$5",py:"$2",borderTopWidth:"$px",borderBottomWidth:"$px",bg:"$bgInfoSubdued",borderColor:"$borderInfoSubdued",alignItems:"center",space:"$2",flex:1,children:[(0,g.jsx)(a.Icon,{size:"$4",name:"DownloadOutline",color:"$iconInfo"}),(0,g.jsx)(a.SizableText,{flex:1,size:"$bodyMdMedium",color:"$text",numberOfLines:1,children:e}),(0,g.jsx)(a.Button,{size:"small",onPress:t,children:n.formatMessage({id:c.ETranslations.global_view})})]})}function HomeFirmwareUpdateReminderCmp(){var e=(0,i.A)(),{activeAccount:t}=(0,k.LH)({num:0}),n=t.device?.connectId,l=(0,m.B)(),[d]=(0,s.useFirmwareUpdatesDetectStatusAtom)(),{result:y}=((0,f.A)(),(0,p.yk)((0,r.A)((function*(){if(n){var e=d?.[n],t=e?.connectId===n&&e?.hasUpgrade;yield u.A.serviceFirmwareUpdate.getFirmwareUpdateDetectInfo({connectId:n});return{shouldUpdate:t,detectResult:e}}})),[n,d])),h=(0,o.useMemo)((function(){if(y?.shouldUpdate){var t="New firmware is available";return y?.detectResult?.toVersion?t=e.formatMessage({id:c.ETranslations.update_firmware_version_available},{version:y?.detectResult?.toVersion}):y?.detectResult?.toVersionBle&&(t=e.formatMessage({id:c.ETranslations.update_bluetooth_version_available},{version:y?.detectResult?.toVersionBle})),(0,g.jsx)(FirmwareUpdateReminderAlert,{message:t,onPress:(0,r.A)((function*(){l.openChangeLogModal({connectId:n})}))})}return null}),[e,l,n,y]);return(0,g.jsxs)(a.XStack,{children:[(0,g.jsx)(b,{}),(0,g.jsx)(BootloaderModeUpdateReminder,{}),h]})}function HomeFirmwareUpdateReminder(){return(0,g.jsx)(d.b8,{config:{sceneName:l.Zs.home},enabledNum:[0],children:(0,g.jsx)(HomeFirmwareUpdateReminderCmp,{})})}},323104:(e,t,n)=>{n.d(t,{A:()=>useHomePageWidth});var r=n(514041),o=n(812715),i=n(490343),a=n(40651),s=n(989375);function useHomePageWidth(){var e=(0,i.useMedia)(),t=(0,o.A)().width,n=(0,r.useMemo)((function(){return(0,s.RQ)().size.sideBarWidth.val}),[]),{leftSidebarCollapsed:c}=(0,a.A)();return{screenWidth:t,pageWidth:e.md||c?t:t-n}}},521203:(e,t,n)=>{n.d(t,{U:()=>HomePageView});var r=n(586330),o=n(514041),i=n(908867),a=n(546591),s=n(462723),c=n(490343),l=n(928557),u=n(254491),d=n(60153),f=n(357829),p=n(660823),k=n(713132),m=(n(663522),n(117746),n(536612),n(831085));k.ue.notify,k.ue.downloading,k.ue.verifying,k.ue.ready,k.ue.failed,k.ue.done;var UpdateReminder=function(){return null},y=n(911998),h=n(162616),w=n(349521),g=n(324586),b=n(839850),v=n(325809),A=n(575995),T=n(84269),I=["createAddressDisabled"];function HomeSelector_ownKeys(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function HomeSelector_objectSpread(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?HomeSelector_ownKeys(Object(n),!0).forEach((function(t){(0,g.A)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):HomeSelector_ownKeys(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}const j=(0,o.memo)((function HomeSelector(e){var t=(0,c.useMedia)(),{createAddressDisabled:n}=e,r=(0,b.A)(e,I);return(0,m.jsxs)(c.XStack,HomeSelector_objectSpread(HomeSelector_objectSpread({testID:"Wallet-Address-Generator",alignItems:"center",space:"$3"},r),{},{children:[(0,m.jsx)(T.vO,{num:0}),n?null:(0,m.jsx)(v.Ln,{num:0}),n?null:(0,m.jsx)(A.XH,{renderTrigger:function({label:e}){return(0,m.jsxs)(c.XStack,{testID:"wallet-derivation-path-selector-trigger",role:"button",borderRadius:"$2",userSelect:"none",alignItems:"center",p:"$1",my:"$-1",hoverStyle:{bg:"$bgHover"},pressStyle:{bg:"$bgActive"},focusStyle:{outlineWidth:2,outlineOffset:0,outlineColor:"$focusRing",outlineStyle:"solid"},"$platform-native":{hitSlop:{right:16,top:16,bottom:16}},focusable:!0,children:[(0,m.jsx)(c.Icon,{name:"BranchesOutline",color:"$iconSubdued",size:"$4.5"}),t.gtSm?(0,m.jsx)(c.SizableText,{pl:"$2",pr:"$1",size:"$bodyMd",color:"$textSubdued",children:e}):null]})},num:0})]}))}));var S=n(323104),x=n(208257),O=n(604343),L=n(318822),P=n(403144),C=n(714191),N=n(989840),M=n(432178);function HomeOverviewContainer_ownKeys(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function HomeOverviewContainer_objectSpread(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?HomeOverviewContainer_ownKeys(Object(n),!0).forEach((function(t){(0,g.A)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):HomeOverviewContainer_ownKeys(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function HomeOverviewContainer(){var e,t,{activeAccount:{account:n,network:i,wallet:a}}=(0,h.LH)({num:0}),[s,l]=(0,o.useState)(!1),[u,f]=(0,o.useState)(!1),[p,k]=(0,o.useState)(!1),[w,g]=(0,o.useState)(!1),[b]=(0,N.mw)(),[v]=(0,N.Al)(),{updateAccountOverviewState:A,updateAccountWorth:T}=(0,N.Lu)().current,[I]=(0,O.useSettingsPersistAtom)(),{result:j}=(0,y.yk)((0,r.A)((function*(){if(i)return d.A.serviceNetwork.getVaultSettings({networkId:i.id})})),[i]);(0,o.useEffect)((function(){n?.id&&i?.id&&a?.id&&(A({initialized:!1,isRefreshing:!0}),i.isAllNetworks&&T({worth:"0"}))}),[n?.id,i?.id,i?.isAllNetworks,A,T,a?.id]),(0,o.useEffect)((function(){var fn=function({isRefreshing:e,type:t}){t===C.GV.TOKENS?f(e):t===C.GV.NFT?k(e):t===C.GV.HISTORY&&g(e),l(e)};return L.iL.on(L.Tu.TabListStateUpdate,fn),function(){L.iL.off(L.Tu.TabListStateUpdate,fn)}}),[]);var{md:S}=(0,c.useMedia)(),x=(0,o.useRef)(null),E=(0,o.useCallback)((function(){s||(l(!0),L.iL.emit(L.Tu.AccountDataUpdate,void 0))}),[s]);if(v.isRefreshing&&!v.initialized)return(0,m.jsx)(c.Stack,{py:"$2.5",children:(0,m.jsx)(c.Skeleton,{w:"$40",h:"$7",my:"$2.5"})});var _=null!=(e=b.worth)?e:"0",R="$heading5xl",H={formatter:"value",formatterOptions:{currency:I.currencyInfo.symbol}},D=(0,m.jsx)(c.NumberSizeableText,HomeOverviewContainer_objectSpread(HomeOverviewContainer_objectSpread({flexShrink:1,minWidth:0},H),{},{size:S&&null!=(t=[{length:25,size:"$headingXl"},{length:13,size:"$heading4xl"}].find((function(e){return(0,P.jq)(String(_),H,!0).length>=e.length}))?.size)?t:R,children:_}));return(0,m.jsxs)(c.XStack,{alignItems:"center",space:"$3",children:[j?.hasFrozenBalance?(0,m.jsxs)(c.XStack,{flexShrink:1,borderRadius:"$3",px:"$1",py:"$0.5",mx:"$-1",my:"$-0.5",cursor:"default",focusable:!0,hoverStyle:{bg:"$bgHover"},pressStyle:{bg:"$bgActive"},focusStyle:{outlineColor:"$focusRing",outlineWidth:2,outlineOffset:0,outlineStyle:"solid"},onPress:function(){var e,t;x?.current||(x.current=(0,M.k)({accountId:null!=(e=n?.id)?e:"",networkId:null!=(t=i?.id)?t:"",onClose:function(){x.current=null}}))},children:[D,(0,m.jsx)(c.Icon,{flexShrink:0,name:"InfoCircleOutline",size:"$4",color:"$iconSubdued"})]}):D,(0,m.jsx)(c.IconButton,{icon:"RefreshCcwOutline",variant:"tertiary",loading:s||u||p||w,onPress:E})]})}function HomeHeaderContainer(){return(0,m.jsx)(x.p,{children:(0,m.jsxs)(c.Stack,{testID:"Wallet-Tab-Header",p:"$5",bg:"$bgApp",children:[(0,m.jsx)(j,{mb:"$2.5"}),(0,m.jsxs)(c.Stack,{flexDirection:"column-reverse",$gtLg:{flexDirection:"row-reverse",justifyContent:"space-between",alignItems:"center"},children:[(0,m.jsx)(c.Portal.Container,{name:c.Portal.Constant.WALLET_ACTIONS}),(0,m.jsx)(HomeOverviewContainer,{})]})]})})}var E=n(787835),_=n.n(E),R=n(848312),H=n(227428),D=n(603514),$=n.n(D),F=n(482407),U=n(520202),B={current:""};function useAllNetworkRequests(e){var{account:t,network:n,wallet:i,allNetworkRequests:a,abortAllNetworkRequests:s,clearAllNetworkData:c,isNFTRequests:l,disabled:u,interval:f=0,shouldAlwaysFetch:p,onStarted:k,onFinished:m}=e,h=(0,o.useRef)(!1),w=(0,o.useRef)(!1),[g,b]=(0,o.useState)(!1),{run:v,result:A}=(0,y.yk)((0,r.A)((function*(){var e=(0,F.lk)();if(!u&&!w.current&&t&&n&&i&&n.isAllNetworks){w.current=!0,h.current||c(),s?.();var{accountsInfo:o,accountsInfoBackendIndexed:p,accountsInfoBackendNotIndexed:y}=yield d.A.serviceAllNetwork.getAllNetworkAccounts({accountId:t.id,networkId:n.id,singleNetworkDeriveType:void 0,nftEnabledOnly:l});if(!o||$()(o))return b(!0),void(w.current=!1);var g,v=p,A=y,T=[];if(0===v.length&&0===A.length)return b(!0),void(w.current=!1);if(b(!1),k?.(),B.current=e,h.current){var I=o.map((function(e){var{accountId:t,networkId:n}=e;return a({accountId:t,networkId:n,allNetworkDataInit:h.current})}));try{T=(yield Promise.all(I)).filter(Boolean)}catch(e){}}else{var j=Array.from(v).map((function(e){var{accountId:t,networkId:n,apiAddress:r}=e;return a({accountId:t,networkId:n,allNetworkDataInit:h.current})}));try{yield Promise.all(j)}catch(e){}yield(g=(0,r.A)((function*(e){for(var t of A){if(B.current&&B.current!==e)break;var{accountId:n,networkId:r}=t;try{yield a({accountId:n,networkId:r,allNetworkDataInit:h.current})}catch(e){}yield(0,U.of)(f)}})),function(e){return g.apply(this,arguments)})(e)}return h.current=!0,w.current=!1,m?.({accountId:t.id,networkId:n.id}),T}})),[u,t,n,i,s,l,k,m,c,a,f],{debounced:H.EI,overrideIsFocused:function(e){return e||!!p}});return(0,o.useEffect)((function(){t?.id&&n?.id&&i?.id&&(h.current=!1)}),[t?.id,n?.id,i?.id]),{run:v,result:A,isEmptyAccount:g,allNetworkDataInit:h}}var W=n(230414),V=n(929296),K=n(195309),z=n(972715),X=n(657355),q=n(714178),G=n(809690),{Provider:J,withProvider:Z,contextAtom:Y,contextAtomMethod:Q}=(0,G.f)(),{atom:ee,use:te}=Y("");function _createSuper(e){var t=_isNativeReflectConstruct();return function _createSuperInternal(){var n,r=(0,z.A)(e);if(t){var o=(0,z.A)(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return(0,K.A)(this,n)}}function _isNativeReflectConstruct(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(e){}return(_isNativeReflectConstruct=function(){return!!e})()}var ne=function(e){(0,V.A)(ContextJotaiActionsNFTList,e);var t=_createSuper(ContextJotaiActionsNFTList);function ContextJotaiActionsNFTList(...e){var n;return(n=t.call(this,...e)).updateSearchKey=Q((function(e,t,n){t(ee(),n)})),n}return(0,W.A)(ContextJotaiActionsNFTList)}(q.x),re=(0,X.j)((function(){return new ne}));function useNFTListActions(){var e=re().updateSearchKey.use();return(0,o.useRef)({updateSearchKey:e})}var oe=n(535864),ie=n(498356),ae=n(69983),se=n(757559),ce=n(669617),le=n(712784),ue=n.n(le),de=n(327550);function NFTListHeader(e){var{filteredNfts:t}=e,n=(0,i.A)(),[r]=te(),{updateSearchKey:o}=useNFTListActions().current;return(0,m.jsx)(de.W,{px:"$2.5",searchProps:{placeholder:n.formatMessage({id:u.ETranslations.global_search_asset}),onChangeText:ue()((function(e){return o(e)}),H.FV),searchResultCount:r&&r.length>=H.NZ?t.length:0}})}var fe=n(241440),pe=n(391944),ke=n(298254),me=n(982447);var ye=(0,o.memo)((function BasicNFTListItem(e){var t,{nft:n,onPress:r,flexBasis:i,isAllNetworks:a}=e,[s,l]=(0,o.useState)(!!n.metadata?.image),{network:u}=(0,ke.b)({networkId:n.networkId});return(0,m.jsxs)(c.Stack,{group:"nftItem",flexBasis:i,focusable:!0,focusStyle:{outlineColor:"$focusRing",outlineWidth:2,outlineStyle:"solid",outlineOffset:-2},p:"$2.5",borderRadius:"$4",onPress:function(){r?.(n)},userSelect:"none",children:[(0,m.jsx)(c.Stack,{pb:"100%","$group-nftItem-hover":{opacity:.8},children:(0,m.jsxs)(c.Stack,{position:"absolute",left:0,top:0,right:0,bottom:0,children:[(0,m.jsxs)(c.Image,{w:"100%",h:"100%",borderRadius:"$2.5",children:[s?(0,m.jsx)(c.Video,{source:{uri:n.metadata?.image},onError:function(){return l(!1)},style:{width:"100%",height:"100%",position:"absolute",zIndex:1},autoPlay:!1}):(0,m.jsx)(c.Image.Source,{src:n.metadata?.image}),(0,m.jsx)(c.Image.Fallback,{bg:"$bgStrong",justifyContent:"center",alignItems:"center",children:(0,m.jsx)(c.Icon,{name:"ImageSquareWavesOutline",color:"$iconDisabled"})})]}),n.collectionType===me.m.ERC1155&&new fe.A(null!=(t=n.amount)?t:1).gt(1)?(0,m.jsx)(c.Stack,{borderRadius:"$2.5",position:"absolute",right:"$0",bottom:"$0",px:"$2",bg:"$bgInverse",borderWidth:2,borderColor:"$bgApp",children:(0,m.jsxs)(c.SizableText,{size:"$bodyMdMedium",color:"$textInverse",children:["x",new fe.A(n.amount).gt(H.JA)?`${H.JA}+`:n.amount]})}):null]})}),(0,m.jsxs)(c.Stack,{mt:"$2",children:[(0,m.jsxs)(c.XStack,{alignItems:"center",justifyContent:"space-between",children:[(0,m.jsx)(c.SizableText,{size:"$bodySm",color:"$textSubdued",minWidth:0,flex:1,numberOfLines:1,pr:"$2",children:n.collectionName||"-"}),a?(0,m.jsx)(pe.o,{width:"$3.5",height:"$3.5",tokenImageUri:u?.logoURI}):null]}),(0,m.jsx)(c.SizableText,{size:"$bodyLgMedium",numberOfLines:1,children:n.metadata?.name||"-"})]})]},n.itemId)}));function NFTListView_ownKeys(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function NFTListView_objectSpread(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?NFTListView_ownKeys(Object(n),!0).forEach((function(t){(0,g.A)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):NFTListView_ownKeys(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var useMumColumns=function(){var{gtSm:e,gtLg:t,gtXl:n,gt2xl:r}=(0,c.useMedia)();return(0,o.useMemo)((function(){return r?{flexBasis:"14.2857142857%",numColumns:7}:n?{flexBasis:"16.666666%",numColumns:6}:t?{flexBasis:"25%",numColumns:4}:e?{flexBasis:"33.333333%",numColumns:3}:{flexBasis:"50%",numColumns:2}}),[r,t,e,n])};function NFTListView(e){var{data:t,isLoading:n,initialized:r,inTabList:i=!1,isAllNetworks:a}=e,[s]=te(),l=(0,ce.D_)({nfts:t,searchKey:s}),u=(0,ie.A)(),{activeAccount:{account:d,network:p,wallet:k}}=(0,h.LH)({num:0}),y=(0,o.useCallback)((function(e){var t,n;d&&p&&k&&u.pushModal(se.ry.MainModal,{screen:se.kZ.NFTDetails,params:{networkId:null!=(t=e.networkId)?t:p.id,accountId:null!=(n=e.accountId)?n:d.id,walletId:k.id,collectionAddress:e.collectionAddress,itemId:e.itemId}})}),[d,u,p,k]),{flexBasis:w,numColumns:g}=useMumColumns(),b=(0,o.useCallback)((function({item:e}){return(0,m.jsx)(ye,{nft:e,flexBasis:w,onPress:y,isAllNetworks:a},`${e.collectionAddress}-${e.itemId}`)}),[w,y,a]),{listViewProps:v,listViewRef:A,onLayout:T}=(0,ae.q)({inTabList:i}),I=(0,o.useMemo)((function(){return{pb:"$6"}}),[]);return!r&&n?(0,m.jsx)(oe.yu,{}):(0,o.createElement)(c.ListView,NFTListView_objectSpread(NFTListView_objectSpread({},v),{},{ref:A,renderScrollComponent:c.renderNestedScrollView,key:g,onLayout:T,contentContainerStyle:I,numColumns:g,data:l,px:"$2.5",renderItem:b,ListHeaderComponent:(0,m.jsx)(NFTListHeader,{filteredNfts:l}),ListEmptyComponent:s?(0,m.jsx)(f.wE,{}):(0,m.jsx)(f.eZ,{})}))}var he=(0,R.V$)();var we=(0,o.memo)(Z((function NFTListContainer(e){var t,{isFocused:n,isHeaderRefreshing:i,setIsHeaderRefreshing:a}=(0,c.useTabIsRefreshingFocused)(),{updateSearchKey:s}=useNFTListActions().current,[l,u]=(0,o.useState)({initialized:!1,isRefreshing:!1}),f=(0,o.useRef)(!1),[p,k]=(0,o.useState)([]),{activeAccount:{account:w,network:g,wallet:b}}=(0,h.LH)({num:0}),{run:v}=(0,y.yk)((0,r.A)((function*(){if(w&&g&&!g.isAllNetworks){L.iL.emit(L.Tu.TabListStateUpdate,{isRefreshing:!0,type:C.GV.NFT}),yield d.A.serviceNFT.abortFetchAccountNFTs();var e=yield d.A.serviceNFT.fetchAccountNFTs({accountId:w.id,networkId:g.id});return u({initialized:!0,isRefreshing:!1}),a(!1),k(e.data),L.iL.emit(L.Tu.TabListStateUpdate,{isRefreshing:!1,type:C.GV.NFT}),e.data}})),[w,g,a],{overrideIsFocused:function(e){return e&&n},debounced:H.EI,pollingInterval:H.Pi}),A=(0,o.useCallback)((t=(0,r.A)((function*({accountId:e,networkId:t,allNetworkDataInit:n}){var r=yield d.A.serviceNFT.fetchAccountNFTs({accountId:e,networkId:t,isAllNetworks:!0,allNetworksAccountId:w?.id,allNetworksNetworkId:g?.id});return n||f.current||r.networkId!==he.onekeyall||!r.isSameAllNetworksAccountData||(k((function(e){return _()([...e,...r.data],(function(e){return`${e.collectionAddress}_${e.itemId}`}))})),u({initialized:!0,isRefreshing:!1})),r})),function(e){return t.apply(this,arguments)}),[w?.id,g?.id]),T=(0,o.useCallback)((function({accountId:e,networkId:t}){e===w?.id&&t===g?.id&&L.iL.emit(L.Tu.TabListStateUpdate,{isRefreshing:!1,type:C.GV.NFT})}),[w?.id,g?.id]),I=(0,o.useCallback)((function(){L.iL.emit(L.Tu.TabListStateUpdate,{isRefreshing:!0,type:C.GV.NFT})}),[]),j=(0,o.useCallback)((function(){return k([])}),[]),{run:S,result:x,isEmptyAccount:O}=useAllNetworkRequests({account:w,network:g,wallet:b,allNetworkRequests:A,clearAllNetworkData:j,isNFTRequests:!0,onStarted:I,onFinished:T}),P=(0,o.useCallback)((function(){f.current=!0,S()}),[S]);return(0,o.useEffect)((function(){if(f.current&&x){var e=[];for(var t of x)e=e.concat(t.data);k(_()(e,(function(e){return`${e.collectionAddress}_${e.itemId}`})))}}),[x]),(0,o.useEffect)((function(){w?.id&&g?.id&&b?.id&&(u({initialized:!1,isRefreshing:!0}),s(""),f.current=!1,d.A.serviceNFT.updateCurrentAccount({networkId:g.id,accountId:w.id}))}),[w?.id,g?.id,s,b?.id]),(0,o.useEffect)((function(){i&&v()}),[i,v]),(0,o.useEffect)((function(){O&&(k([]),u({initialized:!0,isRefreshing:!1}))}),[O]),(0,o.useEffect)((function(){var fn=function(){n&&(g?.isAllNetworks?P():v())};return L.iL.on(L.Tu.AccountDataUpdate,fn),function(){L.iL.off(L.Tu.AccountDataUpdate,fn)}}),[P,n,g?.isAllNetworks,v]),(0,m.jsx)(NFTListView,{inTabList:!0,data:null!=p?p:[],isLoading:l.isRefreshing,initialized:l.initialized,isAllNetworks:g?.isAllNetworks})}))),ge=n(875669);const{Axios:be,AxiosError:ve,CanceledError:Ae,isCancel:Te,CancelToken:Ie,VERSION:je,all:Se,Cancel:xe,isAxiosError:Oe,spread:Le,toFormData:Pe,AxiosHeaders:Ce,HttpStatusCode:Ne,formToJSON:Me,getAdapter:Ee,mergeConfig:_e}=ge.A;var Re=n(181447),He=n(491180),De=n(734818),$e=n(284781),Fe=n(384013),Ue=n(69531);function useBuyToken({accountId:e,networkId:t}){var{result:n}=(0,Ue.yt)("buy",t),[r]=(0,Fe.RI)(),[i]=(0,Fe.D4)(),a=(0,ie.A)();return{handleOnBuy:(0,o.useCallback)((function(){a.pushModal(se.ry.FiatCryptoModal,{screen:se.Mg.BuyModal,params:{networkId:t,accountId:e,tokens:r.tokens,map:i}})}),[e,a,t,r,i]),isSupported:Boolean(t&&e&&n)}}var Be=n(962771),We=n(641106),Ve=n(727476);function UrlAccountHomeTokenListProviderMirror_ownKeys(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function UrlAccountHomeTokenListProviderMirror_objectSpread(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?UrlAccountHomeTokenListProviderMirror_ownKeys(Object(n),!0).forEach((function(t){(0,g.A)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):UrlAccountHomeTokenListProviderMirror_ownKeys(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var Ke=(0,o.memo)((function(e){var t=(0,Ve.y)();return(0,m.jsx)(We.m,UrlAccountHomeTokenListProviderMirror_objectSpread(UrlAccountHomeTokenListProviderMirror_objectSpread({},e),{},{data:t}))}));Ke.displayName="UrlAccountHomeTokenListProviderMirror";var ze=n(186207),Xe=n(292600),qe=n(359395),Ge=n(398509);function WalletActionBuy(){var e,t,{activeAccount:{network:n,account:r,wallet:i}}=(0,h.LH)({num:0}),{isSupported:a,handleOnBuy:s}=useBuyToken({networkId:null!=(e=n?.id)?e:"",accountId:null!=(t=r?.id)?t:""}),c=(0,o.useMemo)((function(){return i?.type===Re.Hk||!a}),[a,i?.type]);return(0,m.jsx)(Ge.c.Buy,{onPress:s,disabled:c})}var Je=n(404727),Ze=n(639563),Ye=n(15409);function WalletActionMore(){var e,t,n,a,[s]=(0,O.useDevSettingsPersistAtom)(),{activeAccount:l}=(0,h.LH)({num:0}),{account:f,network:p,wallet:k,deriveInfo:w,deriveType:g}=l,b=(0,i.A)(),{copyText:v}=(0,c.useClipboard)(),A=(0,ie.A)(),{handleOnReceive:T}=(0,Be.m)({accountId:null!=(e=f?.id)?e:"",networkId:null!=(t=p?.id)?t:"",walletId:null!=(n=k?.id)?n:"",deriveInfo:w,deriveType:g}),{isEnable:I,handleWalletAddress:j}=(0,Ye.p)({activeAccount:l}),{result:S}=(0,Ue.yt)("sell",p?.id),x=(0,o.useMemo)((function(){return k?.type===Re.Hk||!S}),[S,k?.type]),[L]=(0,Fe.RI)(),[P]=(0,Fe.D4)(),C=(0,o.useCallback)((function(){I?j():k?.type===Re.FN?T():v(f?.address||"")}),[f?.address,v,T,k?.type,I,j]),N=(0,o.useCallback)((function(){var e,t;A.pushModal(se.ry.FiatCryptoModal,{screen:se.Mg.SellModal,params:{networkId:null!=(e=p?.id)?e:"",accountId:null!=(t=f?.id)?t:"",tokens:L.tokens,map:P}})}),[A,p,f,L,P]),M=(0,Xe.T)(),E=(0,y.yk)((0,r.A)((function*(){var e;return yield d.A.serviceNetwork.getVaultSettings({networkId:null!=(e=p?.id)?e:""})})),[p?.id]).result,_=[];if(E?.copyAddressDisabled&&E?.hideBlockExplorer||_.unshift({items:[...E?.hideBlockExplorer?[]:[{label:b.formatMessage({id:u.ETranslations.global_view_in_blockchain_explorer}),icon:"GlobusOutline",onPress:function(){return(0,Ze.HM)({networkId:p?.id,address:f?.address})}}],...E?.copyAddressDisabled?[]:[{label:b.formatMessage({id:u.ETranslations.global_copy_address}),icon:"Copy3Outline",onPress:C}]]}),M&&_.unshift({items:[{label:b.formatMessage({id:u.ETranslations.global_sell}),icon:"MinusLargeOutline",disabled:Boolean(x&&f?.id&&p?.id),onPress:N}]}),s?.settings?.showDevExportPrivateKey){var R=(a=(0,r.A)((function*({keyType:e}){var t="";t=e===Je.ECoreApiExportedSecretKeyType.xpub||e===Je.ECoreApiExportedSecretKeyType.publicKey?yield d.A.serviceAccount.exportAccountPublicKey({accountId:f?.id||"",networkId:p?.id||"",keyType:e}):yield d.A.serviceAccount.exportAccountSecretKey({accountId:f?.id||"",networkId:p?.id||"",keyType:e}),c.Dialog.show({title:"Key",description:t,onConfirmText:"Copy",onConfirm(){v(t||"")}})})),function exportAccountCredentialKey(e){return a.apply(this,arguments)});_.unshift({items:[{label:"Export Public Key",icon:"MinusLargeOutline",onPress:function(){R({keyType:Je.ECoreApiExportedSecretKeyType.publicKey})}},{label:"Export xpub",icon:"MinusLargeOutline",onPress:function(){R({keyType:Je.ECoreApiExportedSecretKeyType.xpub})}},{label:"Export Private Key",icon:"MinusLargeOutline",onPress:function(){R({keyType:Je.ECoreApiExportedSecretKeyType.privateKey})}},{label:"Export xprvt",icon:"MinusLargeOutline",onPress:function(){R({keyType:Je.ECoreApiExportedSecretKeyType.xprvt})}}]})}return(0,m.jsx)(Ge.c.More,{sections:_})}function WalletActionReceive(){var e,t,n,{activeAccount:{network:r,account:i,wallet:a,deriveInfo:s,deriveType:c}}=(0,h.LH)({num:0}),[l]=(0,Fe.RI)(),[u]=(0,Fe.D4)(),[d]=(0,Fe.V3)(),f=(0,o.useMemo)((function(){return a?.type===Re.Hk}),[a?.type]),{handleOnReceive:p}=(0,Be.m)({accountId:null!=(e=i?.id)?e:"",networkId:null!=(t=r?.id)?t:"",walletId:null!=(n=a?.id)?n:"",deriveInfo:s,deriveType:c,tokens:{data:l.tokens,keys:l.keys,map:u},tokenListState:d});return(0,m.jsx)(Ge.c.Receive,{disabled:f,onPress:function(){return p()}})}function WalletActions_ownKeys(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function WalletActions_objectSpread(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?WalletActions_ownKeys(Object(n),!0).forEach((function(t){(0,g.A)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):WalletActions_ownKeys(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function WalletActionSend(){var e=(0,ie.A)(),{activeAccount:{account:t,network:n,wallet:a}}=(0,h.LH)({num:0}),s=(0,i.A)(),[c]=(0,Fe.RI)(),[l]=(0,Fe.D4)(),[f]=(0,Fe.V3)(),p=(0,y.yk)((0,r.A)((function*(){var e;return yield d.A.serviceNetwork.getVaultSettings({networkId:null!=(e=n?.id)?e:""})})),[n?.id]).result,k=(0,o.useCallback)((0,r.A)((function*(){if(t&&n)if(p?.isSingleToken){var o=yield d.A.serviceToken.getNativeToken({networkId:n.id,accountId:t.id});e.pushModal(se.ry.SendModal,{screen:se.j$.SendDataInput,params:{accountId:t.id,networkId:n.id,isNFT:!1,token:o}})}else{var i;e.pushModal(se.ry.SendModal,{screen:se.j$.SendSelectToken,params:{title:s.formatMessage({id:u.ETranslations.global_send}),searchPlaceholder:s.formatMessage({id:u.ETranslations.global_search_asset}),networkId:n.id,accountId:t.id,tokens:{data:c.tokens,keys:c.keys,map:l},tokenListState:f,closeAfterSelect:!1,onSelect:(i=(0,r.A)((function*(r){var o,i,s;if((yield d.A.serviceNetwork.getVaultSettings({networkId:null!=(o=r.networkId)?o:""})).mergeDeriveAssetsEnabled&&n.isAllNetworks&&(He.A.isHdWallet({walletId:a?.id})||He.A.isHwWallet({walletId:a?.id}))){var c,u,f,p,k=He.A.getWalletIdFromAccountId({accountId:null!=(c=r.accountId)?c:""});e.push(se.j$.SendSelectDeriveAddress,{networkId:null!=(u=r.networkId)?u:"",indexedAccountId:null!=(f=t.indexedAccountId)?f:"",walletId:k,accountId:null!=(p=r.accountId)?p:"",actionType:qe.rI.Select,token:r,tokenMap:l,onUnmounted:function(){},onSelected:function({account:t}){var o;e.push(se.j$.SendDataInput,{accountId:t.id,networkId:null!=(o=r.networkId)?o:n.id,isNFT:!1,token:r,isAllNetworks:n?.isAllNetworks})}})}else e.push(se.j$.SendDataInput,{accountId:null!=(i=r.accountId)?i:t.id,networkId:null!=(s=r.networkId)?s:n.id,isNFT:!1,token:r,isAllNetworks:n?.isAllNetworks})})),function onSelect(e){return i.apply(this,arguments)})}})}})),[t,n,p?.isSingleToken,e,s,c.tokens,c.keys,l,f,a?.id]);return(0,m.jsx)(Ge.c.Send,{onPress:k,disabled:p?.disabledSendAction})}function WalletActionSwap({networkId:e}){var t=(0,ie.A)(),n=(0,y.yk)((0,r.A)((function*(){return yield d.A.serviceNetwork.getVaultSettings({networkId:null!=e?e:""})})),[e]).result,i=(0,o.useCallback)((function(){t.pushModal(se.ry.SwapModal,{screen:se.uw.SwapMainLand,params:{importNetworkId:e}})}),[t,e]);return(0,m.jsx)(Ge.c.Swap,{onPress:i,disabled:n?.disabledSwapAction})}function WalletActions(e){var t=Object.assign({},((0,ze.A)(e),e)),{activeAccount:{network:n}}=(0,h.LH)({num:0});return(0,m.jsxs)(Ge.c,WalletActions_objectSpread(WalletActions_objectSpread({},t),{},{children:[(0,m.jsx)(Xe.O,{children:(0,m.jsx)(WalletActionBuy,{})}),(0,m.jsx)(WalletActionSwap,{networkId:n?.id}),(0,m.jsx)(WalletActionSend,{}),(0,m.jsx)(WalletActionReceive,{}),(0,m.jsx)(WalletActionMore,{})]}))}function TokenListContainer_ownKeys(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function TokenListContainer_objectSpread(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?TokenListContainer_ownKeys(Object(n),!0).forEach((function(t){(0,g.A)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):TokenListContainer_ownKeys(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var Qe=(0,R.V$)();function TokenListContainer({showWalletActions:e=!1}){var t,n,i,a,s,l,u,f,p,{isFocused:k,isHeaderRefreshing:w,setIsHeaderRefreshing:g}=(0,c.useTabIsRefreshingFocused)(),{activeAccount:{account:b,network:v,wallet:A,indexedAccount:T,isOthersWallet:I,deriveInfo:j,deriveType:S}}=(0,h.LH)({num:0}),[x,O]=(0,o.useState)(!1),{vaultSettings:P}=(0,ke.b)({networkId:null!=(t=v?.id)?t:""}),{handleOnBuy:M,isSupported:E}=useBuyToken({accountId:null!=(n=b?.id)?n:"",networkId:null!=(i=v?.id)?i:""}),{handleOnReceive:_}=(0,Be.m)({accountId:null!=(a=b?.id)?a:"",networkId:null!=(s=v?.id)?s:"",walletId:null!=(l=A?.id)?l:"",deriveInfo:j,deriveType:S}),{handleOnManageToken:R,manageTokenEnabled:D}=function useManageToken({accountId:e,networkId:t,walletId:n,isOthersWallet:r,indexedAccountId:i,deriveType:a}){var s=(0,ie.A)(),{result:c}=(0,y.yk)((function(){return d.A.serviceNetwork.getVaultSettings({networkId:t})}),[t]),l=(0,o.useCallback)((function(){s.pushModal(se.ry.MainModal,{screen:se.jX.TokenManagerModal,params:{walletId:n,isOthersWallet:r,indexedAccountId:i,networkId:t,accountId:e,deriveType:a}})}),[s,n,r,i,t,e,a]);return{manageTokenEnabled:!c?.isSingleToken,handleOnManageToken:l}}({accountId:null!=(u=b?.id)?u:"",networkId:null!=(f=v?.id)?f:"",walletId:null!=(p=A?.id)?p:"",deriveType:S,indexedAccountId:T?.id,isOthersWallet:I}),$=(0,o.useRef)(!1),F=(0,c.useMedia)(),U=(0,ie.A)();(0,c.useOnRouterChange)((function(e){var t=e?.routes.find((function({name:e}){return e===se.WP.Modal}));t?.params?.screen===se.ry.AssetSelectorModal&&t?.params?.params?.screen===se.jA.TokenSelector?O(!0):O(!1)}));var B,{refreshAllTokenList:W,refreshAllTokenListMap:V,refreshTokenList:K,refreshTokenListMap:z,refreshRiskyTokenList:X,refreshRiskyTokenListMap:q,refreshSmallBalanceTokenList:G,refreshSmallBalanceTokenListMap:J,refreshSmallBalanceTokensFiatValue:Z,updateTokenListState:Y,updateSearchKey:Q}=(0,Fe.WE)().current,{updateAccountWorth:ee,updateAccountOverviewState:te}=(0,N.Lu)().current,{run:ne}=(0,y.yk)((0,r.A)((function*(){try{var e,t,n,r;if(!b||!v)return;if(v.isAllNetworks)return;L.iL.emit(L.Tu.TabListStateUpdate,{isRefreshing:!0,type:C.GV.TOKENS}),yield d.A.serviceToken.abortFetchAccountTokens();var o=yield d.A.serviceToken.fetchAccountTokens({accountId:b.id,mergeTokens:!0,networkId:v.id,flag:"home-token-list"}),i=new fe.A(0);if(i=i.plus(null!=(e=o.tokens.fiatValue)?e:"0").plus(null!=(t=o.riskTokens.fiatValue)?t:"0").plus(null!=(n=o.smallBalanceTokens.fiatValue)?n:"0"),te({isRefreshing:!1,initialized:!0}),ee({worth:i.toFixed(),merge:!1}),K({keys:o.tokens.keys,tokens:o.tokens.data}),z({tokens:o.tokens.map}),X({keys:o.riskTokens.keys,riskyTokens:o.riskTokens.data}),q({tokens:o.riskTokens.map}),G({keys:o.smallBalanceTokens.keys,smallBalanceTokens:o.smallBalanceTokens.data}),J({tokens:o.smallBalanceTokens.map}),Z(null!=(r=o.smallBalanceTokens.fiatValue)?r:"0"),o.allTokens){W({keys:o.allTokens?.keys,tokens:o.allTokens?.data}),V({tokens:o.allTokens.map});var a=o.allTokens.data;a&&a.length&&d.A.serviceToken.updateLocalTokens({networkId:v.id,tokens:a}),L.iL.emit(L.Tu.TokenListUpdate,{tokens:a,keys:o.allTokens.keys,map:o.allTokens.map}),Y({initialized:!0,isRefreshing:!1}),L.iL.emit(L.Tu.TabListStateUpdate,{isRefreshing:!1,type:C.GV.TOKENS})}}catch(e){if(L.iL.emit(L.Tu.TabListStateUpdate,{isRefreshing:!1,type:C.GV.TOKENS}),!(e instanceof Ae))throw e}finally{g(!1)}})),[b,v,K,z,X,q,G,J,Z,W,V,Y,g,te,ee],{overrideIsFocused:function(e){return e&&k||x},debounced:H.EI,pollingInterval:H.iD}),re=(0,o.useCallback)((B=(0,r.A)((function*({accountId:e,networkId:t,allNetworkDataInit:n}){var r=yield d.A.serviceToken.fetchAccountTokens({networkId:t,accountId:e,flag:"home-token-list",isAllNetworks:!0,mergeTokens:!0,allNetworksAccountId:b?.id,allNetworksNetworkId:v?.id});if(!n&&!$.current&&r.isSameAllNetworksAccountData){var o,i,a,s=new fe.A(0);s=s.plus(null!=(o=r.tokens.fiatValue)?o:"0").plus(null!=(i=r.riskTokens.fiatValue)?i:"0").plus(null!=(a=r.smallBalanceTokens.fiatValue)?a:"0");var c=!!(yield d.A.serviceNetwork.getVaultSettings({networkId:t})).mergeDeriveAssetsEnabled;te({isRefreshing:!1,initialized:!0}),ee({worth:s.toFixed(),merge:!0}),z({tokens:r.tokens.map,merge:!0,mergeDerive:c}),K({keys:r.tokens.keys,tokens:r.tokens.data,merge:!0,map:r.tokens.map,mergeDerive:c}),J({tokens:r.smallBalanceTokens.map,merge:!0,mergeDerive:c}),G({keys:r.smallBalanceTokens.keys,smallBalanceTokens:r.smallBalanceTokens.data,merge:!0,map:r.smallBalanceTokens.map,mergeDerive:c}),q({tokens:r.riskTokens.map,merge:!0,mergeDerive:c}),X({keys:r.riskTokens.keys,riskyTokens:r.riskTokens.data,merge:!0,map:r.riskTokens.map,mergeDerive:c}),Y({initialized:!0,isRefreshing:!1}),r.allTokens&&(V({tokens:r.allTokens.map,merge:!0,mergeDerive:c}),W({keys:r.allTokens.keys,tokens:r.allTokens.data,map:r.allTokens.map,merge:!0,mergeDerive:c}),L.iL.emit(L.Tu.TokenListUpdate,{tokens:r.allTokens.data,keys:r.allTokens.keys,map:r.allTokens.map,merge:!0}))}return r})),function(e){return B.apply(this,arguments)}),[b?.id,v?.id,W,V,X,q,G,J,K,z,te,ee,Y]),oe=(0,o.useCallback)((function(){var e=(0,De.H7)();W({tokens:e.allTokens.data,keys:e.allTokens.keys}),V({tokens:e.allTokens.map}),K({tokens:e.tokens.data,keys:e.tokens.keys}),z({tokens:e.tokens.map}),G({smallBalanceTokens:e.smallBalanceTokens.data,keys:e.smallBalanceTokens.keys}),J({tokens:e.smallBalanceTokens.map}),X({riskyTokens:e.riskTokens.data,keys:e.riskTokens.keys}),q({tokens:e.riskTokens.map})}),[W,V,X,q,G,J,K,z]),ae=(0,o.useCallback)((function({accountId:e,networkId:t}){e===b?.id&&t===v?.id&&L.iL.emit(L.Tu.TabListStateUpdate,{isRefreshing:!1,type:C.GV.TOKENS})}),[b?.id,v?.id]),ce=(0,o.useCallback)((function(){L.iL.emit(L.Tu.TabListStateUpdate,{isRefreshing:!0,type:C.GV.TOKENS})}),[]),{run:le,result:ue}=useAllNetworkRequests({account:b,network:v,wallet:A,allNetworkRequests:re,clearAllNetworkData:oe,onStarted:ce,onFinished:ae,interval:200,shouldAlwaysFetch:x}),de=(0,o.useCallback)((0,r.A)((function*(){var e={tokens:[],keys:""},t={smallBalanceTokens:[],keys:""},n={riskyTokens:[],keys:""},r={},o={},i={},a=new fe.A(0);if($.current&&ue){for(var s of ue){var c,l,u,f,p=(yield d.A.serviceNetwork.getVaultSettings({networkId:null!=(c=s.networkId)?c:""})).mergeDeriveAssetsEnabled;e.tokens=(0,De.JW)({sourceTokens:s.tokens.data,targetTokens:e.tokens,mergeDeriveAssets:p}),e.keys=`${e.keys}_${s.tokens.keys}`,r=(0,De.bX)({sourceMap:s.tokens.map,targetMap:r,mergeDeriveAssets:p}),t.smallBalanceTokens=(0,De.JW)({sourceTokens:s.smallBalanceTokens.data,targetTokens:t.smallBalanceTokens,mergeDeriveAssets:p}),t.keys=`${t.keys}_${s.smallBalanceTokens.keys}`,o=(0,De.bX)({sourceMap:s.smallBalanceTokens.map,targetMap:o,mergeDeriveAssets:p}),n.riskyTokens=(0,De.JW)({sourceTokens:s.riskTokens.data,targetTokens:n.riskyTokens,mergeDeriveAssets:p}),n.riskyTokens=n.riskyTokens.concat(s.riskTokens.data),n.keys=`${n.keys}_${s.riskTokens.keys}`,i=(0,De.bX)({sourceMap:s.riskTokens.map,targetMap:i,mergeDeriveAssets:p}),a=a.plus(null!=(l=s.tokens.fiatValue)?l:"0").plus(null!=(u=s.riskTokens.fiatValue)?u:"0").plus(null!=(f=s.smallBalanceTokens.fiatValue)?f:"0")}e.tokens=(0,De.LQ)({tokens:e.tokens,map:r}),t.smallBalanceTokens=(0,De.LQ)({tokens:t.smallBalanceTokens,map:o}),n.riskyTokens=(0,De.LQ)({tokens:n.riskyTokens,map:i}),ee({worth:a.toFixed()}),K(e),z({tokens:r}),G(t),J({tokens:o}),X(n),q({tokens:i})}})),[ue,X,q,G,J,K,z,ee]);(0,o.useEffect)((function(){de()}),[de]),(0,o.useEffect)((function(){w&&ne()}),[w,ne]),(0,o.useEffect)((function(){b?.id&&v?.id&&A?.id&&(Y({initialized:!1,isRefreshing:!0}),Q(""),$.current=!1,d.A.serviceToken.updateCurrentAccount({networkId:v.id,accountId:b.id}),v.id!==Qe.onekeyall&&oe())}),[b?.id,oe,v?.id,Q,Y,A?.id]);var pe=(0,o.useCallback)((function(e){var t,n;b&&v&&A&&j&&U.pushModal(se.ry.MainModal,{screen:se.kZ.TokenDetails,params:{accountId:null!=(t=e.accountId)?t:b.id,networkId:null!=(n=e.networkId)?n:v.id,walletId:A.id,deriveInfo:j,deriveType:S,tokenInfo:e,isAllNetworks:v.isAllNetworks}})}),[b,j,S,U,v,A]),me=(0,o.useMemo)((function(){return!P?.disabledSendAction&&A?.type!==Re.Hk}),[P?.disabledSendAction,A?.type]),ye=(0,o.useCallback)((function(){$.current=!0,le()}),[le]);return(0,o.useEffect)((function(){var refresh=function(){v?.isAllNetworks?ye():ne()},fn=function(){k&&refresh()};return L.iL.on(L.Tu.RefreshTokenList,refresh),L.iL.on(L.Tu.AccountDataUpdate,fn),function(){L.iL.off(L.Tu.RefreshTokenList,refresh),L.iL.off(L.Tu.AccountDataUpdate,fn)}}),[ye,k,v?.isAllNetworks,ne,le]),(0,m.jsxs)(m.Fragment,{children:[e?(0,m.jsx)(c.Portal.Body,{container:c.Portal.Constant.WALLET_ACTIONS,children:(0,m.jsx)(WalletActions,{pt:"$5",$gtLg:{pt:0}})}):null,(0,m.jsx)($e.x,TokenListContainer_objectSpread({withHeader:!0,withFooter:!0,withPrice:!0,inTabList:!0,withBuyAndReceive:me,isBuyTokenSupported:E,onBuyToken:M,onReceiveToken:_,manageTokenEnabled:D,onManageToken:R,onPressToken:pe,isAllNetworks:v?.isAllNetworks},F.gtLg&&{tableLayout:!0}))]})}var et=(0,o.memo)((function(e){var t,{activeAccount:{account:n}}=(0,h.LH)({num:0});return He.A.isUrlAccountFn({accountId:null!=(t=n?.id)?t:""})?(0,m.jsx)(Ke,{children:(0,m.jsx)(TokenListContainer,TokenListContainer_objectSpread({showWalletActions:!0},e))}):(0,m.jsx)(x.p,{children:(0,m.jsx)(TokenListContainer,TokenListContainer_objectSpread({showWalletActions:!0},e))})}));et.displayName="TokenListContainerWithProvider";var tt=n(232471),nt=n(124155),rt=n(616552);function TxHistoryContainer_ownKeys(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}var ot=(0,o.memo)((0,rt.UK)((function TxHistoryListContainer(e){var t,{isFocused:n,isHeaderRefreshing:i,setIsHeaderRefreshing:a}=(0,c.useTabIsRefreshingFocused)(),{updateSearchKey:s}=(0,rt.n8)().current,[l,u]=(0,o.useState)([]),[f,p]=(0,o.useState)({initialized:!1,isRefreshing:!1}),k=(0,o.useRef)(!1),w=(0,c.useMedia)(),b=(0,ie.A)(),{activeAccount:{account:v,network:A,wallet:T}}=(0,h.LH)({num:0}),I=(0,o.useCallback)((t=(0,r.A)((function*(e){if(v&&A){if(e.decodedTx.status===tt.Y1.Pending&&e.isLocalCreated){var t=yield d.A.serviceHistory.getLocalHistoryTxById({accountId:e.decodedTx.accountId,networkId:e.decodedTx.networkId,historyId:e.id});if(!t||t.replacedNextId)return}b.pushModal(se.ry.MainModal,{screen:se.kZ.HistoryDetails,params:{networkId:e.decodedTx.networkId,accountId:e.decodedTx.accountId,historyTx:e,isAllNetworks:A.isAllNetworks}})}})),function(e){return t.apply(this,arguments)}),[v,b,A]),{run:j}=(0,y.yk)((0,r.A)((function*(){if(v&&A){L.iL.emit(L.Tu.TabListStateUpdate,{isRefreshing:!0,type:C.GV.HISTORY});var e=yield d.A.serviceHistory.fetchAccountHistory({accountId:v.id,networkId:A.id});p({initialized:!0,isRefreshing:!1}),a(!1),u(e),L.iL.emit(L.Tu.TabListStateUpdate,{isRefreshing:!1,type:C.GV.HISTORY})}})),[v,A,a],{overrideIsFocused:function(e){return e&&n},debounced:H.EI,pollingInterval:H.fu});return(0,o.useEffect)((function(){v?.id&&A?.id&&T?.id&&(p({initialized:!1,isRefreshing:!0}),s(""),k.current=!1)}),[v?.id,A?.id,s,T?.id]),(0,o.useEffect)((function(){i&&j()}),[i,j]),(0,o.useEffect)((function(){var refresh=function(){n&&j()},clearCallback=function(){return u((function(e){return e.filter((function(e){return e.decodedTx.status!==tt.Y1.Pending}))}))};return L.iL.on(L.Tu.ClearLocalHistoryPendingTxs,clearCallback),L.iL.on(L.Tu.AccountDataUpdate,refresh),function(){L.iL.off(L.Tu.ClearLocalHistoryPendingTxs,clearCallback),L.iL.off(L.Tu.AccountDataUpdate,refresh)}}),[n,j]),(0,o.useEffect)((function(){var reloadCallback=function(){return j({alwaysSetState:!0})},fn=function(){n&&j()};return L.iL.on(L.Tu.AccountDataUpdate,fn),L.iL.on(L.Tu.HistoryTxStatusChanged,reloadCallback),function(){L.iL.off(L.Tu.HistoryTxStatusChanged,reloadCallback),L.iL.off(L.Tu.AccountDataUpdate,fn)}}),[n,j]),(0,m.jsx)(nt.q,function TxHistoryContainer_objectSpread(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?TxHistoryContainer_ownKeys(Object(n),!0).forEach((function(t){(0,g.A)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):TxHistoryContainer_ownKeys(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}({showIcon:!0,inTabList:!0,data:null!=l?l:[],onPressHistory:I,showHeader:!0,isLoading:f.isRefreshing,initialized:f.initialized},w.gtLg&&{tableLayout:!0}))})));const it=function LNHardwareWalletAuth({children:e,accountId:t,networkId:n}){var a=(0,i.A)(),[s,l]=(0,o.useState)(!1),[f,p]=(0,o.useState)(!1),{result:k,run:h}=(0,y.yk)((0,r.A)((function*(){try{return yield d.A.serviceLightning.checkAuth({accountId:t,networkId:n}),!0}catch{return!1}finally{l(!0)}})),[n,t]),w=(0,o.useCallback)((0,r.A)((function*(){p(!0);try{yield d.A.serviceLightning.exchangeToken({networkId:n,accountId:t}),setTimeout((function(){h()}),200)}catch(e){c.Toast.error({title:a.formatMessage({id:u.ETranslations.ln_authorize_access_network_error})})}finally{p(!1)}})),[n,t,a,h]);return s?k?(0,m.jsx)(m.Fragment,{children:e}):(0,m.jsxs)(c.Stack,{testID:"LNHardwareAuth",w:"100%",h:"100%",children:[(0,m.jsx)(x.p,{children:(0,m.jsx)(c.Stack,{testID:"Wallet-Tab-Header",p:"$5",children:(0,m.jsx)(j,{mb:"$2.5"})})}),(0,m.jsx)(c.Stack,{flex:1,testID:"LNHardware",justifyContent:"center",alignItems:"center",children:(0,m.jsx)(c.Empty,{icon:"PasswordOutline",title:a.formatMessage({id:u.ETranslations.ln_authorize_access}),description:a.formatMessage({id:u.ETranslations.ln_authorize_access_desc}),buttonProps:{children:a.formatMessage({id:u.ETranslations.global_connect_hardware_wallet}),onPress:function(){w()},loading:f}})})]}):(0,m.jsx)(c.Stack,{w:"100%",h:"100%",alignItems:"center",justifyContent:"center",children:(0,m.jsx)(c.Spinner,{size:"large"})})};var at=n(184251);const st=function WalletContentWithAuth({networkId:e,accountId:t,children:n}){return at.A.isLightningNetworkByNetworkId(e)&&He.A.isHwAccount({accountId:t})?(0,m.jsx)(it,{networkId:e,accountId:t,children:n}):n};var ct;function HomePageView({onPressHide:e,sceneName:t}){var n,k,{screenWidth:g,pageWidth:b}=(0,S.A)();null==ct&&(ct=new a.A.Value(b)),(0,o.useEffect)((function(){ct&&a.A.timing(ct,{toValue:b,duration:400,easing:s.A.inOut(s.A.quad),useNativeDriver:!1}).start()}),[b]);var v=(0,i.A)(),{activeAccount:{account:A,accountName:T,network:I,deriveInfo:x,wallet:O,ready:L,device:P}}=(0,h.LH)({num:0}),[C,N]=(x?.labelKey?v.formatMessage({id:x?.labelKey}):n=x?.label,(0,o.useState)(!1)),M=(0,y.yk)((0,r.A)((function*(){var e;return I?d.A.serviceNetwork.getVaultSettings({networkId:null!=(e=I?.id)?e:""}):Promise.resolve(void 0)})),[I]).result,E=M?.NFTEnabled&&(0,l.cN)().includes(null!=(k=I?.id)?k:""),_=M?.validationRequired,R=M?.enabledOnClassicOnly,H=(0,o.useMemo)((function(){return[{title:v.formatMessage({id:u.ETranslations.global_crypto}),page:(0,o.memo)(et,(function(){return!0}))},E?{title:v.formatMessage({id:u.ETranslations.global_nft}),page:(0,o.memo)(we,(function(){return!0}))}:null,{title:v.formatMessage({id:u.ETranslations.global_history}),page:(0,o.memo)(ot,(function(){return!0}))}].filter(Boolean)}),[v,A?.id,I?.id,E]),D=(0,o.useCallback)((function(){return(0,m.jsx)(c.Tab,{disableRefresh:!0,data:H,ListHeaderComponent:(0,m.jsx)(HomeHeaderContainer,{}),initialScrollIndex:0,contentItemWidth:ct,contentWidth:g,showsVerticalScrollIndicator:!1})}),[H,g]),$=(0,o.useCallback)((function(){return R&&"classic"!==P?.deviceType?(0,m.jsxs)(c.YStack,{height:"100%",children:[(0,m.jsx)(j,{createAddressDisabled:!0,padding:"$5"}),(0,m.jsx)(c.Stack,{flex:1,justifyContent:"center",children:(0,m.jsx)(c.Empty,{icon:"GlobusOutline",title:v.formatMessage({id:u.ETranslations.selected_network_only_supports_device},{deviceType:"OneKey Classic"})})})]}):A?_?(0,m.jsx)(st,{networkId:null!=(n=I?.id)?n:"",accountId:null!=(r=A?.id)?r:"",children:(0,m.jsx)(m.Fragment,{children:D()})}):(0,m.jsx)(m.Fragment,{children:D()}):(0,m.jsxs)(c.YStack,{height:"100%",children:[(0,m.jsx)(j,{padding:"$5"}),(0,m.jsx)(c.Stack,{flex:1,justifyContent:"center",children:(0,m.jsx)(f.TP,{name:T,chain:null!=(e=I?.name)?e:"",type:null!=(t=x?.labelKey?v.formatMessage({id:x?.labelKey}):x?.label)?t:""})})]});var e,t,n,r}),[R,P?.deviceType,A,_,D,T,I?.name,I?.id,x?.labelKey,x?.label,v]),F=(0,o.useCallback)((function(){if(!L)return(0,m.jsx)(p.i,{showHeaderRight:!0,sceneName:t});var e=(0,m.jsx)(c.Stack,{h:"100%",justifyContent:"center",children:(0,m.jsx)(f.Bl,{})});return O&&(e=$()),(0,m.jsxs)(m.Fragment,{children:[(0,m.jsx)(p.i,{showHeaderRight:!0,sceneName:t}),(0,m.jsxs)(c.Page.Body,{children:[(0,m.jsx)(UpdateReminder,{}),(0,m.jsx)(w.a,{}),e]})]})}),[L,O,t,$]);return(0,o.useMemo)((function(){return(0,m.jsx)(c.Page,{fullPage:!0,children:F()})}),[F])}},639451:(e,t,n)=>{n.d(t,{Ed:()=>l,Xo:()=>s,sB:()=>c,xf:()=>useDownloadProgress});var r,o,i,a=n(586330),s=(r=(0,a.A)((function*(){return{}})),function downloadPackage(){return r.apply(this,arguments)}),c=(o=(0,a.A)((function*(){})),function verifyPackage(){return o.apply(this,arguments)}),l=(i=(0,a.A)((function*(){})),function installPackage(){return i.apply(this,arguments)}),useDownloadProgress=function(){return 0}}}]);
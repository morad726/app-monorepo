"use strict";(self.webpackChunkweb=self.webpackChunkweb||[]).push([[38381],{738381:(e,t,r)=>{r.r(t),r.d(t,{default:()=>x});var s=r(586330),i=r(514041),n=r(724249),a=r(908867),o=r(17617),d=r(490343),l=r(604343),c=r(318822),u=r(254491),f=r(213644),g=r(491180),y=r(901976),m=r(100645),h=r(60153),w=r(298254),b=r(911998),v=function(e){return e[e.Unverified=0]="Unverified",e[e.Verifying=1]="Verifying",e[e.Verified=2]="Verified",e[e.ForceShow=3]="ForceShow",e}({}),p=r(831085);const x=function ReceiveToken(){(0,y.e)({name:"ReceiveToken9971"});var e=(0,a.A)(),t=(0,n.lq)(),{networkId:r,accountId:x,walletId:$,deriveType:T,token:S}=t.params,{account:_,network:k,wallet:j,vaultSettings:A}=(0,w.b)({accountId:x,networkId:r,walletId:$}),I=(0,b.yk)((0,s.A)((function*(){var t,s,i=yield h.A.serviceAccount.getAccountAddressType({accountId:x,networkId:r,address:null!=(t=_?.address)?t:""});return i.typeKey?e.formatMessage({id:i.typeKey}):null!=(s=i.type)?s:""})),[_?.address,x,e,r]).result,[C,E]=(0,i.useState)(v.Unverified),[M]=(0,l.useHardwareUiStateAtom)(),{copyText:U}=(0,d.useClipboard)(),R=g.A.isQrWallet({walletId:$})||g.A.isHwWallet({walletId:$}),V=(0,i.useMemo)((function(){return!R||(C===v.ForceShow||C===v.Verified||C===v.Verifying&&M?.action===l.EHardwareUiStateAction.REQUEST_BUTTON)}),[C,M?.action,R]),z=(0,i.useMemo)((function(){if(C===v.Verifying&&M?.action===l.EHardwareUiStateAction.REQUEST_BUTTON)return!0}),[C,M?.action]),B=(0,i.useMemo)((function(){return!R||(C===v.ForceShow||C===v.Verified)}),[C,R]),H=C===v.Verifying,F=(0,i.useCallback)((0,s.A)((function*(){E(v.Verifying);try{var t=yield h.A.serviceAccount.verifyHWAccountAddresses({walletId:$,networkId:r,indexedAccountId:_?.indexedAccountId,deriveType:T,confirmOnDevice:m.hz.EveryItem}),s=t?.[0]?.toLowerCase()===_?.address?.toLowerCase();f.U.transaction.receive.showReceived({walletType:j?.type,isSuccess:s,failedReason:s?"":e.formatMessage({id:u.ETranslations.feedback_address_mismatch})}),s||d.Toast.error({title:e.formatMessage({id:u.ETranslations.feedback_address_mismatch}),message:e.formatMessage({id:u.ETranslations.feedback_address_mismatch_desc})}),E(s?v.Verified:v.Unverified)}catch(e){throw E(v.Unverified),f.U.transaction.receive.showReceived({walletType:j?.type,isSuccess:!1,failedReason:e.message}),e}})),[_?.address,_?.indexedAccountId,T,e,r,j?.type,$]);(0,i.useEffect)((function(){var callback=function(){return E(v.Unverified)};return c.iL.on(c.Tu.CloseHardwareUiStateDialogManually,callback),function(){c.iL.off(c.Tu.CloseHardwareUiStateDialogManually,callback)}}),[]),(0,i.useEffect)((function(){R||f.U.transaction.receive.showReceived({walletType:j?.type,isSuccess:!0,failedReason:""})}),[R,j?.type]);var O=(0,i.useCallback)((function(){return R?C===v.Verified||C===v.ForceShow||H?(0,p.jsx)(d.Button,{mt:"$5",icon:"Copy1Outline",disabled:H,loading:H,onPress:function(){var e;return U(null!=(e=_?.address)?e:"")},children:e.formatMessage({id:u.ETranslations.global_copy_address})}):(0,p.jsxs)(d.YStack,{space:"$5",alignItems:"center",children:[(0,p.jsx)(d.Button,{mt:"$5",variant:"primary",onPress:F,children:e.formatMessage({id:u.ETranslations.global_verify_on_device})}),(0,p.jsx)(d.Button,{size:"medium",variant:"tertiary",onPress:function(){return E(v.ForceShow)},children:e.formatMessage({id:u.ETranslations.skip_verify_text})})]}):(0,p.jsx)(d.Button,{mt:"$5",icon:"Copy1Outline",onPress:function(){var e;return U(null!=(e=_?.address)?e:"")},children:e.formatMessage({id:u.ETranslations.global_copy_address})})}),[_?.address,C,U,F,e,R,H]),P=(0,i.useCallback)((function(){var t;return _&&k&&j?(0,p.jsxs)(p.Fragment,{children:[(0,p.jsxs)(d.Stack,{mb:"$5",children:[(0,p.jsxs)(d.XStack,{space:"$2",alignItems:"center",justifyContent:"center",children:[(0,p.jsx)(d.Heading,{size:"$headingMd",children:null!=(t=S?.symbol)?t:k.symbol}),A?.showAddressType&&I?(0,p.jsx)(d.Badge,{children:I}):null]}),(0,p.jsx)(d.SizableText,{mt:"$1",size:"$bodyMd",color:"$textSubdued",textAlign:"center",children:e.formatMessage({id:u.ETranslations.receive_send_asset_warning_message},{network:k.name})})]}),(0,p.jsxs)(d.Stack,{borderRadius:"$3",borderWidth:o.A.hairlineWidth,borderColor:"$borderSubdued",p:"$4",children:[(0,p.jsx)(d.QRCode,{value:_.address,logo:{uri:S?.logoURI||k.logoURI},logoSize:40,size:240}),B?null:(0,p.jsxs)(d.Stack,{position:"absolute",top:"$0",left:"$0",right:"$0",bottom:"$0",alignItems:"center",justifyContent:"center",children:[(0,p.jsx)(d.BlurView,{contentStyle:{borderRadius:"$3",width:"100%",height:"100%",borderCurve:"continuous"},position:"absolute",intensity:100,top:"$0",left:"$0",right:"$0",bottom:"$0"}),(0,p.jsx)(d.Empty,{icon:"EyeOffOutline",description:e.formatMessage({id:u.ETranslations.address_verify_address_instruction})})]})]}),(0,p.jsx)(d.ConfirmHighlighter,{maxWidth:"$96",highlight:z,mt:"$5",px:"$3",borderRadius:"$3",borderCurve:"continuous",children:(0,p.jsx)(d.SizableText,{textAlign:"center",size:"$bodyMd",style:{wordBreak:"break-all"},children:V?_.address:g.A.shortenAddress({address:_.address})})}),V&&C===v.ForceShow?(0,p.jsxs)(d.XStack,{mt:"$1",justifyContent:"center",alignItems:"center",children:[(0,p.jsx)(d.Icon,{name:"InfoCircleOutline",size:"$4",color:"$iconCritical"}),(0,p.jsx)(d.SizableText,{size:"$bodyMd",color:"$textCritical",pl:"$1.5",children:e.formatMessage({id:u.ETranslations.receive_address_unconfimed_alert_message})})]}):null,O()]}):null}),[_,k,j,A?.showAddressType,I,e,S?.logoURI,B,z,V,C,O,S?.symbol]);return(0,p.jsxs)(d.Page,{children:[(0,p.jsx)(d.Page.Header,{title:e.formatMessage({id:u.ETranslations.global_receive})}),(0,p.jsx)(d.Page.Body,{flex:1,justifyContent:"center",alignItems:"center",px:"$5",pb:"$5",children:P()})]})}}}]);
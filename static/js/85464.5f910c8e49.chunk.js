(self.webpackChunkweb=self.webpackChunkweb||[]).push([[85464],{82506:(e,t,r)=>{"use strict";r.d(t,{d:()=>useDebounce});var n=r(578104);function useDebounce(e,t,r){var[i]=(0,n.d7)(e,t,r);return i}},471230:(e,t,r)=>{"use strict";r.d(t,{YG:()=>m,U9:()=>i.U});r(490343),r(791088),r(757559);var n=r(498356);r(831085);var i=r(952954),o=r(324586),a=r(586330),s=r(514041),u=r(908867),c=r(604343),l=r(318822),d=(r(254491),r(663522),r(584186)),f=r(60153),p=r(131397),v=r(621591);function ownKeys(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function _objectSpread(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?ownKeys(Object(r),!0).forEach((function(t){(0,o.A)(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):ownKeys(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}var g=0,b=!1,y=!1;var m=(0,s.memo)((function OnboardingOnMountCmp(){(0,u.A)();var e=(0,p.t1)(),t=(0,n.A)(),r=(0,v.D)(),[i,o]=(0,c.useV4migrationPersistAtom)(),m=i?.downgradeWarningConfirmed;(0,s.useRef)(m).current=m;var h=(0,s.useCallback)((0,a.A)((function*(){(yield f.A.serviceV4Migration.checkShouldMigrateV4OnMount())&&(b||(b=!0,yield f.A.serviceV4Migration.migrateBaseSettings()))})),[]),w=(0,s.useCallback)((0,a.A)((function*({checkingV4Migration:t}={}){try{if(t)if(yield f.A.serviceV4Migration.checkShouldMigrateV4OnMount()){if(yield h(),yield d.A.wait(600),!y){y=!0,yield r.navigateToV4MigrationPage({isAutoStartOnMount:!0});var n=Date.now();n-g>3e3&&(g=n,o((function(e){return _objectSpread(_objectSpread({},e),{},{v4migrationAutoStartCount:(e.v4migrationAutoStartCount||0)+1})})))}return}}catch(e){}var{isOnboardingDone:i}=yield f.A.serviceOnboarding.isOnboardingDone();i||e({isFullModal:!0,params:{showCloseButton:!0}})})),[h,o,e,r]),j=(0,s.useCallback)((0,a.A)((function*(){yield w({checkingV4Migration:!0})})),[w,h,o]);return(0,s.useEffect)((function(){}),[]),(0,s.useEffect)((function(){}),[o]),(0,s.useEffect)((function(){}),[t]),(0,s.useEffect)((function(){}),[r]),(0,s.useEffect)((function(){j()}),[j]),(0,s.useEffect)((function(){var fn=function(){w({checkingV4Migration:!1})};return l.iL.on(l.Tu.WalletClear,fn),function(){l.iL.off(l.Tu.WalletClear,fn)}}),[w]),null}))},85464:(e,t,r)=>{"use strict";r.r(t),r.d(t,{default:()=>I});var n=r(586330),i=r(514041),o=r(908867),a=r(490343),s=r(60153),u=r(325809),c=r(498356),l=r(911998),d=r(162616),f=r(181447),p=r(254491),v=r(213644),g=r(714191),b=r(471230),y=r(324586),m=r(70107),h=r.n(m),w=r(575995),j=r(660395),O=r(82506),k=r(147882),x=r(848312),A=r(831085);function ownKeys(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function _objectSpread(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?ownKeys(Object(r),!0).forEach((function(t){(0,y.A)(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):ownKeys(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}var fixInputImportSingleChain=function(e){return h()(e)};function ImportSingleChainBase({validationParams:e,title:t,inputLabel:r,inputPlaceholder:c,inputIsSecure:l,inputTestID:d,invalidMessage:f,children:v,onConfirm:g,networkIds:b}){var y=(0,o.A)(),m=(0,a.useMedia)(),{activeAccount:{network:h}}=(0,j.w)({num:0}),{clearText:I}=(0,a.useClipboard)(),S=(0,a.useForm)({values:{networkId:h?.id&&h.id!==(0,x.V$)().onekeyall?h?.id:(0,x.V$)().btc,input:"",deriveType:void 0}}),{setValue:P,control:_}=S,[M,T]=(0,i.useState)(),E=(0,i.useRef)(!1),C=(0,a.useFormWatch)({control:_,name:"networkId"}),D=(0,a.useFormWatch)({control:_,name:"input"}),V=(0,O.d)(D,600),$=(0,i.useCallback)((0,n.A)((function*(){if(P("deriveType",void 0),V&&C){var t=yield s.A.servicePassword.encodeSensitiveText({text:fixInputImportSingleChain(V)});try{var r=yield s.A.serviceAccount.validateGeneralInputOfImporting(_objectSpread(_objectSpread({},e),{},{input:t,networkId:C}));T(r),I()}catch(e){T({isValid:!1})}}else T(void 0)})),[I,V,C,P,e]);(0,i.useEffect)((function(){(0,n.A)((function*(){try{E.current=!0,yield $()}finally{E.current=!1}}))()}),[$]),(0,i.useEffect)((function(){}),[C,P]);var F,{start:K}=(0,k.A)();return(0,A.jsxs)(a.Page,{children:[(0,A.jsx)(a.Page.Header,{title:t}),(0,A.jsxs)(a.Page.Body,{px:"$5",children:[(0,A.jsxs)(a.Form,{form:S,children:[(0,A.jsx)(a.Form.Field,{label:y.formatMessage({id:p.ETranslations.global_network}),name:"networkId",children:(0,A.jsx)(u.YS,{networkIds:b})}),(0,A.jsx)(a.Form.Field,{label:r,name:"input",children:(0,A.jsx)(a.Input,{secureTextEntry:l,placeholder:c,size:m.gtMd?"medium":"large",testID:d,addOns:[{iconName:"ScanOutline",onPress:(F=(0,n.A)((function*(){var e=yield K({handlers:[],autoHandleResult:!1});S.setValue("input",e.raw)})),function onPress(){return F.apply(this,arguments)})}]})}),M?.deriveInfoItems?(0,A.jsx)(a.Form.Field,{label:y.formatMessage({id:p.ETranslations.derivation_path}),name:"deriveType",children:(0,A.jsx)(w.l$,{networkId:S.getValues().networkId||"",enabledItems:M?.deriveInfoItems||[],renderTrigger:function({label:e}){return(0,A.jsxs)(a.Stack,{userSelect:"none",flexDirection:"row",px:"$3.5",py:"$2.5",borderWidth:1,borderColor:"$borderStrong",borderRadius:"$3",$gtMd:{px:"$3",py:"$1.5",borderRadius:"$2"},borderCurve:"continuous",hoverStyle:{bg:"$bgHover"},pressStyle:{bg:"$bgActive"},children:[(0,A.jsx)(a.SizableText,{flex:1,children:e}),(0,A.jsx)(a.Icon,{name:"ChevronDownSmallOutline",color:"$iconSubdued",mr:"$-0.5"})]})}})}):null]}),M&&!M?.isValid&&V?(0,A.jsx)(a.SizableText,{color:"$textCritical",children:f}):null,v]}),(0,A.jsx)(a.Page.Footer,{confirmButtonProps:{disabled:!M?.isValid},onConfirm:(0,n.A)((function*(){return g(S)}))})]})}function ImportPrivateKey(){var e,t=(0,o.A)(),r=(0,i.useMemo)((function(){return{input:"",validateXprvt:!0,validatePrivateKey:!0}}),[]),u=(0,d.z$)(),g=(0,c.A)(),{result:y}=(0,l.yk)((0,n.A)((function*(){return(yield s.A.serviceNetwork.getImportedAccountEnabledNetworks()).map((function(e){return e.id}))})),[],{initResult:[]});return(0,A.jsx)(ImportSingleChainBase,{title:t.formatMessage({id:p.ETranslations.global_import_private_key}),inputLabel:t.formatMessage({id:p.ETranslations.global_private_key}),inputPlaceholder:t.formatMessage({id:p.ETranslations.form_enter_private_key_placeholder}),inputIsSecure:!0,inputTestID:"private-key",invalidMessage:t.formatMessage({id:p.ETranslations.form_private_key_error_invalid}),validationParams:r,onConfirm:(e=(0,n.A)((function*(e){var r=e.getValues();if(r.input&&r.networkId){var n=yield s.A.servicePassword.encodeSensitiveText({text:fixInputImportSingleChain(r.input)}),i=yield s.A.serviceAccount.addImportedAccount({input:n,deriveType:r.deriveType,networkId:r.networkId}),o=i?.accounts?.[0]?.id;o&&a.Toast.success({title:t.formatMessage({id:p.ETranslations.global_success})}),u.current.updateSelectedAccountForSingletonAccount({num:0,networkId:r.networkId,walletId:f.C5,othersWalletAccountId:o}),g.popStack(),v.U.account.wallet.importWallet({importMethod:"privatekey"})}})),function(t){return e.apply(this,arguments)}),networkIds:y,children:(0,A.jsx)(b.U9,{list:[{title:t.formatMessage({id:p.ETranslations.faq_private_key}),description:t.formatMessage({id:p.ETranslations.faq_private_key_desc})},{title:t.formatMessage({id:p.ETranslations.faq_recovery_phrase_safe_store}),description:t.formatMessage({id:p.ETranslations.faq_recovery_phrase_safe_store_desc})}]})})}const I=function ImportPrivateKeyPage(){return(0,A.jsx)(u.b8,{config:{sceneName:g.Zs.home},enabledNum:[0],children:(0,A.jsx)(ImportPrivateKey,{})})}},552837:e=>{e.exports=function asciiToArray(e){return e.split("")}},528931:(e,t,r)=>{var n=r(73501);e.exports=function castSlice(e,t,r){var i=e.length;return r=void 0===r?i:r,!t&&r>=i?e:n(e,t,r)}},728774:(e,t,r)=>{var n=r(2478);e.exports=function charsEndIndex(e,t){for(var r=e.length;r--&&n(t,e[r],0)>-1;);return r}},217905:(e,t,r)=>{var n=r(2478);e.exports=function charsStartIndex(e,t){for(var r=-1,i=e.length;++r<i&&n(t,e[r],0)>-1;);return r}},283417:e=>{var t=RegExp("[\\u200d\\ud800-\\udfff\\u0300-\\u036f\\ufe20-\\ufe2f\\u20d0-\\u20ff\\ufe0e\\ufe0f]");e.exports=function hasUnicode(e){return t.test(e)}},482237:(e,t,r)=>{var n=r(552837),i=r(283417),o=r(792013);e.exports=function stringToArray(e){return i(e)?o(e):n(e)}},792013:e=>{var t="\\ud800-\\udfff",r="["+t+"]",n="[\\u0300-\\u036f\\ufe20-\\ufe2f\\u20d0-\\u20ff]",i="\\ud83c[\\udffb-\\udfff]",o="[^"+t+"]",a="(?:\\ud83c[\\udde6-\\uddff]){2}",s="[\\ud800-\\udbff][\\udc00-\\udfff]",u="(?:"+n+"|"+i+")"+"?",c="[\\ufe0e\\ufe0f]?",l=c+u+("(?:\\u200d(?:"+[o,a,s].join("|")+")"+c+u+")*"),d="(?:"+[o+n+"?",n,a,s,r].join("|")+")",f=RegExp(i+"(?="+i+")|"+d+l,"g");e.exports=function unicodeToArray(e){return e.match(f)||[]}},70107:(e,t,r)=>{var n=r(652291),i=r(386403),o=r(528931),a=r(728774),s=r(217905),u=r(482237),c=r(595243);e.exports=function trim(e,t,r){if((e=c(e))&&(r||void 0===t))return i(e);if(!e||!(t=n(t)))return e;var l=u(e),d=u(t),f=s(l,d),p=a(l,d)+1;return o(l,f,p).join("")}}}]);
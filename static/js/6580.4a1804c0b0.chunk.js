"use strict";(self.webpackChunkweb=self.webpackChunkweb||[]).push([[6580],{696755:(e,t,n)=>{n.d(t,{A:()=>O});var r=n(586330),o=n(324586),a=n(514041),i=n(241440),s=n(490343),c=n(60153),u=n(298254),d=n(498356),l=n(564452),f=n(908867),k=n(391944),p=n(604343),b=n(254491),w=n(911998),I=n(831085),y=(0,a.createContext)({}),NetworkContainer=function({networkIds:e,children:t}){var{result:{networks:n}}=(0,w.yk)((function(){return c.A.serviceNetwork.getNetworksByIds({networkIds:e})}),[e],{initResult:{networks:[]}}),r=(0,a.useMemo)((function(){return n.reduce((function(e,t){return e[t.id]=t,e}),{})}),[n]);return(0,I.jsx)(y.Provider,{value:r,children:t})},keyExtractor=function(e){var t=e.address;return`${e.networkId}--${t||"main"}`},ListItemFiatToken=function({item:e,onPress:t}){var n=function({networkId:e}){return(0,a.useContext)(y)[e]}({networkId:e.networkId}),[{currencyInfo:{symbol:r}}]=(0,p.useSettingsPersistAtom)();return(0,I.jsxs)(s.XStack,{flexDirection:"row",alignItems:"center",minHeight:"$11",space:"$3",py:"$2",px:"$3",mx:"$2",borderRadius:"$3",borderCurve:"continuous",justifyContent:"space-between",hoverStyle:{bg:"$bgHover"},pressStyle:{bg:"$bgActive"},focusable:!0,focusStyle:{outlineWidth:2,outlineStyle:"solid",outlineColor:"$focusRing",outlineOffset:-2},onPress:function(){return t?.(e)},children:[(0,I.jsxs)(s.XStack,{alignItems:"center",children:[(0,I.jsx)(k.o,{size:"lg",tokenImageUri:e.icon,networkImageUri:n?.logoURI}),(0,I.jsxs)(s.YStack,{ml:"$3",children:[(0,I.jsxs)(s.XStack,{children:[(0,I.jsx)(s.SizableText,{size:"$bodyLgMedium",children:e.symbol.toUpperCase()}),(0,I.jsx)(s.Stack,{ml:"$2",children:(0,I.jsx)(s.Badge,{badgeType:"default",badgeSize:"sm",children:n?.name})})]}),(0,I.jsx)(s.SizableText,{size:"$bodyMd",children:e.name})]}),(0,I.jsx)(s.YStack,{})]}),(0,I.jsxs)(s.YStack,{alignItems:"flex-end",children:[e.balanceParsed?(0,I.jsx)(s.NumberSizeableText,{size:"$bodyLgMedium",formatter:"balance",children:e.balanceParsed}):null,e.fiatValue?(0,I.jsx)(s.NumberSizeableText,{size:"$bodyMd",formatter:"balance",color:"$textSubdued",formatterOptions:{currency:r},children:e.fiatValue}):null]})]})},TokenList=function({items:e,onPress:t}){var[n,r]=(0,a.useState)(""),o=(0,a.useCallback)((function(e){r(e.trim())}),[]),i=(0,a.useMemo)((function(){var t=n.toLowerCase();return e.filter((function(e){return e.name.toLowerCase().includes(t)||e.symbol.toLowerCase().includes(n)}))}),[e,n]),c=(0,f.A)(),{bottom:u}=(0,s.useSafeAreaInsets)();return(0,I.jsxs)(s.Stack,{flex:1,children:[(0,I.jsx)(s.Stack,{px:"$5",pb:"$4",children:(0,I.jsx)(s.SearchBar,{placeholder:c.formatMessage({id:b.ETranslations.global_search_tokens}),value:n,onChangeText:o})}),(0,I.jsx)(s.Stack,{flex:1,children:(0,I.jsx)(s.ListView,{estimatedItemSize:60,data:i,renderItem:function({item:e}){return(0,I.jsx)(ListItemFiatToken,{item:e,onPress:t})},keyExtractor,ListFooterComponent:(0,I.jsx)(s.Stack,{h:u||"$2"}),ListEmptyComponent:(0,I.jsx)(s.Empty,{title:c.formatMessage({id:b.ETranslations.global_no_results}),icon:"SearchOutline"})})})]})},j=n(69531),m=n(848312),g=n(757559),x=n(491180),h=n(184251),A=n(117746),v=n(359395),S=n(941230);function ownKeys(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function _objectSpread(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?ownKeys(Object(n),!0).forEach((function(t){(0,o.A)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):ownKeys(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}const O=(0,l.k)((function({title:e,type:t,networkId:n,accountId:o}){var l,f=(0,d.A)(),{result:k,isLoading:p}=(0,j.ej)({networkId:n,accountId:o,type:t}),{getTokenFiatValue:b,fiatMap:w}=(0,S.gZ)(),{account:y}=(0,u.b)({networkId:n,accountId:o}),O=(0,a.useMemo)((function(){if(!h.A.isAllNetwork({networkId:n}))return k;var e=k.map((function(e){return _objectSpread(_objectSpread({},e),{},{fiatValue:b({networkId:e.networkId,tokenAddress:e.address.toLowerCase()})?.fiatValue,balanceParsed:b({networkId:e.networkId,tokenAddress:e.address.toLowerCase()})?.balanceParsed})}));return"sell"===t&&(e=e.filter((function(e){return e.balanceParsed&&0!==Number(e.balanceParsed)}))),y&&x.A.isOthersAccount({accountId:y.id})&&(e=e.filter((function(e){return x.A.isAccountCompatibleWithNetwork({account:y,networkId:e.networkId})}))),e.sort((function(e,t){var n,r,o=null!=(n=e.fiatValue)?n:"0",a=null!=(r=t.fiatValue)?r:"0";return(0,i.A)(o).gt(a)?-1:1}))}),[k,b,n,t,y]),P=(0,a.useCallback)((l=(0,r.A)((function*(e){var a,i,s=(a=(0,r.A)((function*({networkAccountId:n}){var{url:r}=yield c.A.serviceFiatCrypto.generateWidgetUrl({networkId:e.networkId,tokenAddress:e.address,accountId:n,type:t});(0,A.Dr)(r),f.popStack()})),function openFiatCryptoUrl(e){return a.apply(this,arguments)}),u=o;if(h.A.isAllNetwork({networkId:n})&&y?.indexedAccountId){if(e.networkId===(0,m.V$)().btc)return void f.push(g.Mg.DeriveTypesAddress,{networkId:e.networkId,indexedAccountId:y.indexedAccountId,accountId:o,actionType:v.rI.Select,tokenMap:w,onSelected:(i=(0,r.A)((function*({account:e}){yield s({networkAccountId:e.id})})),function onSelected(e){return i.apply(this,arguments)})});var d=yield c.A.serviceNetwork.getGlobalDeriveTypeOfNetwork({networkId:e.networkId}),l=yield c.A.serviceAccount.getOrCreateIndexedAccount({networkId:e.networkId,indexedAccountId:y.indexedAccountId,deriveType:d});if(!l)return;u=l.id}yield s({networkAccountId:u})})),function(e){return l.apply(this,arguments)}),[f,t,o,y,n,w]),C=(0,a.useMemo)((function(){return Array.from(new Set(O.map((function(e){return e.networkId}))))}),[O]);return(0,I.jsxs)(s.Page,{safeAreaEnabled:!1,children:[(0,I.jsx)(s.Page.Header,{title:e}),(0,I.jsx)(s.Page.Body,{children:(0,I.jsx)(NetworkContainer,{networkIds:C,children:p?(0,I.jsx)(s.Stack,{minHeight:300,justifyContent:"center",alignItems:"center",children:(0,I.jsx)(s.Spinner,{size:"large"})}):(0,I.jsx)(TokenList,{items:O,onPress:P})})})]})}))},941230:(e,t,n)=>{n.d(t,{gZ:()=>useTokenDataContext,jh:()=>TokenDataContainer});var r=n(324586),o=n(514041),a=n(318822),i=n(184251),s=n(831085);function ownKeys(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function _objectSpread(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?ownKeys(Object(n),!0).forEach((function(t){(0,r.A)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):ownKeys(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var buildAccountTokenIndexKey=function({networkId:e,tokenAddress:t}){return e?`${e}__${t}`:""};function buildAccountTokenMap({tokens:e,lastResult:t={}}){for(var n=_objectSpread({},t),r=0;r<e.length;r+=1){var o=e[r],a=buildAccountTokenIndexKey({networkId:o.networkId,tokenAddress:o.address});a&&(n[a]=o)}return n}var c=(0,o.createContext)({tokensMap:{},fiatMap:{},networkId:""}),useTokenDataContext=function(){var{tokensMap:e,fiatMap:t,networkId:n}=(0,o.useContext)(c);return{getTokenFiatValue:(0,o.useCallback)((function({networkId:r,tokenAddress:o}){if(i.A.isAllNetwork({networkId:n})){var a=buildAccountTokenIndexKey({networkId:r,tokenAddress:o}),s=e[a]?.$key;return s?t[s]:void 0}}),[e,t,n]),tokensMap:e,fiatMap:t}};function TokenDataContainer({children:e,initialMap:t,initialTokens:n,networkId:r}){var[u,d]=(0,o.useState)((function(){return buildAccountTokenMap({tokens:n})})),[l,f]=(0,o.useState)(t),k=(0,o.useCallback)((function({map:e,tokens:t}){f((function(t){return _objectSpread(_objectSpread({},t),e)})),d((function(e){return buildAccountTokenMap({tokens:t,lastResult:e})}))}),[]),p=(0,o.useMemo)((function(){return{tokensMap:u,fiatMap:l,networkId:r}}),[u,l,r]);return(0,o.useEffect)((function(){if(i.A.isAllNetwork({networkId:r}))return a.iL.on(a.Tu.TokenListUpdate,k),function(){a.iL.off(a.Tu.TokenListUpdate,k)}}),[k,r]),(0,s.jsx)(c.Provider,{value:p,children:e})}},606580:(e,t,n)=>{n.r(t),n.d(t,{default:()=>__WEBPACK_DEFAULT_EXPORT__});var r=n(724249),o=n(908867),a=n(254491),i=n(696755),s=n(941230),c=n(831085);const __WEBPACK_DEFAULT_EXPORT__=function(){var e=(0,r.lq)(),{networkId:t,accountId:n,tokens:u=[],map:d={}}=e.params,l=(0,o.A)();return(0,c.jsx)(s.jh,{initialMap:d,initialTokens:u,networkId:t,children:(0,c.jsx)(i.A,{title:l.formatMessage({id:a.ETranslations.global_sell}),type:"sell",networkId:t,accountId:n})})}}}]);
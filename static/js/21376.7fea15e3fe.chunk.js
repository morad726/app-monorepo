"use strict";(self.webpackChunkweb=self.webpackChunkweb||[]).push([[21376],{583354:(e,t,n)=>{n.d(t,{D:()=>o,U:()=>r});var r=function(e){return e.hd="hd",e.qr="qr",e.hardware="hardware",e.imported="imported",e.watching="watching",e.external="external",e}({}),o=function(e){return e.DEPOSIT="deposit",e.WITHDRAW="withdraw",e}({})},793437:(e,t,n)=>{n.d(t,{X:()=>OpenInAppButton});var r=n(586330),o=n(514041),a=n(908867),s=n(17617),i=n(490343),c=n(889949),u=n(726130),l=n(254491),d=n(663522),p=n(117746),f=n(911998),m=n(831085);function OpenInAppButton({buildDeepLinkUrl:e,buildFullUrl:t}){var n=(0,a.A)(),{result:g}=(0,f.yk)((0,r.A)((function*(){var t=e();return(yield p.Ay.linkingCanOpenURL(t))?t:""})),[e]),w=((0,o.useMemo)((function(){return d.Ay.isWebMobile?d.Ay.isWebMobileAndroid?"Open by OneKey Android":d.Ay.isWebMobileIOS?"Open by OneKey iOS":void 0:"Open by OneKey Desktop"}),[]),(0,o.useCallback)((0,r.A)((function*(){var e=yield t();i.Dialog.show({title:n.formatMessage({id:l.ETranslations.open_in_mobile_app}),floatingPanelProps:{overflow:"hidden"},renderContent:(0,m.jsxs)(i.Stack,{children:[(0,m.jsx)(i.Stack,{alignItems:"center",justifyContent:"center",overflow:"hidden",children:(0,m.jsx)(i.Stack,{p:"$4",borderRadius:"$6",borderCurve:"continuous",borderWidth:s.A.hairlineWidth,borderColor:"$borderSubdued",children:(0,m.jsx)(i.QRCode,{value:e,logo:c,logoSize:40,size:224})})}),(0,m.jsxs)(i.XStack,{m:"$-5",mt:"$5",py:"$4",px:"$5",backgroundColor:"$bgSubdued",alignItems:"center",children:[(0,m.jsx)(i.SizableText,{size:"$bodyMd",color:"$textSubdued",flex:1,children:n.formatMessage({id:l.ETranslations.dont_have_mobile_app_yet})}),(0,m.jsx)(i.Button,{size:"small",onPress:function(){(0,p.Dr)(u.A8)},children:n.formatMessage({id:l.ETranslations.global_download})})]})]}),showFooter:!1})})),[t,n]));return(0,m.jsx)(i.Button,{size:"small",onPress:w,children:n.formatMessage({id:l.ETranslations.open_in_mobile_app})})}},660823:(e,t,n)=>{n.d(t,{i:()=>TabPageHeader});var r=n(514041),o=n(490343),a=n(901976),s=n(162616),i=n(208257),c=n(325809),u=n(714191),l=n(831085);function HeaderLeft({sceneName:e}){var t=(0,r.useMemo)((function(){return e===u.Zs.homeUrlAccount?(0,l.jsx)(o.Page.Close,{children:(0,l.jsx)(o.NavBackButton,{})}):(0,l.jsx)(c.Qt,{num:0},"accountSelectorTrigger")}),[e]);return(0,l.jsx)(c.b8,{enabledNum:[0],config:{sceneName:e,sceneUrl:""},children:t})}var d=n(586330),p=n(908867),f=n(896666),m=n(384013),g=n(254491),w=n(663522),b=n(757559),S=n(60153),v=n(498356),y=n(793437),A=n(211129),k=n(491180),j=n(796151),h=n(826339);function OpenInAppButtonContainer(){var{activeAccount:{account:e,network:t}}=(0,s.LH)({num:0}),n=(0,r.useCallback)((function(){return e&&t?j.Ay.buildDeepLinkUrl({path:A.oO.url_account,query:{networkCode:t.code,address:e.address}}):""}),[e,t]),o=(0,r.useCallback)((0,d.A)((function*(){return e&&t?(0,h.Hw)({account:e,network:t}):"n"})),[e,t]);return e?.address&&t?.id?(0,l.jsx)(y.X,{buildDeepLinkUrl:n,buildFullUrl:o}):null}function ShareButton(){var{activeAccount:{account:e,network:t}}=(0,s.LH)({num:0}),{shareText:n}=(0,o.useShare)();return e?.address&&t?.id?(0,l.jsx)(o.HeaderIconButton,{onPress:(0,d.A)((function*(){var r=yield(0,h.Hw)({account:e,network:t});yield n(r)})),icon:"ShareOutline"}):null}var I={Address:function Address(){var{activeAccount:{account:e}}=(0,s.LH)({num:0});return(0,o.useMedia)(),(0,l.jsxs)(o.XStack,{alignItems:"center",children:[(0,l.jsx)(o.SizableText,{size:"$headingLg",children:k.A.shortenAddress({address:e?.address})}),null]})},OpenInApp:function OpenInApp(){return(0,l.jsx)(c.b8,{config:{sceneName:u.Zs.homeUrlAccount,sceneUrl:""},enabledNum:[0],children:(0,l.jsx)(OpenInAppButtonContainer,{})})},Share:function Share(){return(0,l.jsx)(c.b8,{config:{sceneName:u.Zs.homeUrlAccount,sceneUrl:""},enabledNum:[0],children:(0,l.jsx)(ShareButton,{})})}},x=n(147882),T=n(390574),O=n(506851);function UniversalSearchInput(){var e=(0,p.A)(),t=(0,v.A)(),n=(0,r.useCallback)((function(){t.pushModal(b.ry.UniversalSearchModal,{screen:T.j.UniversalSearch,params:{filterType:O.j.Address}})}),[t]);return(0,l.jsxs)(o.XStack,{w:280,children:[(0,l.jsx)(o.Input,{leftIconName:"SearchOutline",containerProps:{w:"100%"},size:"small",placeholder:e.formatMessage({id:g.ETranslations.global_search_address})},"searchInput"),(0,l.jsx)(o.View,{position:"absolute",top:0,left:0,right:0,bottom:0,onPress:n})]})}function HeaderRight({sceneName:e}){var t=(0,p.A)(),n=(0,v.A)(),a=(0,x.A)(),{activeAccount:{account:i}}=(0,s.LH)({num:0}),[c]=(0,m.RI)(),[y]=(0,m.D4)(),A=(0,r.useCallback)((function(){n.pushModal(b.ry.SettingModal,{screen:b.Pj.SettingListModal})}),[n]),k=(0,r.useCallback)((function(){return a.start({handlers:a.PARSE_HANDLER_NAMES.all,autoHandleResult:!0,account:i,tokens:{data:c.tokens,keys:c.keys,map:y}})}),[a,i,c,y]),j=(0,r.useCallback)((0,d.A)((function*(){var e,n,r,a={routes:""};o.ActionList.show({title:t.formatMessage({id:g.ETranslations.global_layout}),items:[w.Ay.isExtensionUiPopup?{label:t.formatMessage({id:g.ETranslations.open_as_sidebar}),icon:"LayoutRightOutline",onPress:(r=(0,d.A)((function*(){yield S.A.serviceApp.openExtensionSidePanelOnActionClick(!0),yield S.A.serviceApp.openExtensionSidePanel(a),window.close()})),function onPress(){return r.apply(this,arguments)})}:{label:t.formatMessage({id:g.ETranslations.open_as_popup}),icon:"LayoutTopOutline",onPress:(n=(0,d.A)((function*(){yield S.A.serviceApp.openExtensionSidePanelOnActionClick(!1),window.close()})),function onPress(){return n.apply(this,arguments)})},{label:t.formatMessage({id:g.ETranslations.global_expand_view}),icon:"ExpandOutline",onPress:(e=(0,d.A)((function*(){window.close(),yield S.A.serviceApp.openExtensionExpandTab(a)})),function onPress(){return e.apply(this,arguments)})}]})})),[t]),h=(0,o.useMedia)(),T=(0,r.useMemo)((function(){var n=(0,l.jsx)(f.v$,{title:t.formatMessage({id:g.ETranslations.settings_settings}),icon:"SettingsOutline",testID:"setting",onPress:A},"setting"),r=(0,l.jsx)(f.v$,{title:t.formatMessage({id:g.ETranslations.global_layout}),icon:"LayoutRightOutline",onPress:j},"layoutRightView"),o=(0,l.jsx)(f.v$,{title:t.formatMessage({id:g.ETranslations.scan_scan_qr_code}),icon:"ScanOutline",onPress:k},"scan"),a=h.gtMd?(0,l.jsx)(UniversalSearchInput,{},"searchInput"):null;return e===u.Zs.homeUrlAccount?[(0,l.jsx)(I.OpenInApp,{},"urlAccountOpenInApp"),(0,l.jsx)(I.Share,{},"urlAccountShare")].filter(Boolean):w.Ay.isExtensionUiPopup||w.Ay.isExtensionUiSidePanel?[r,n]:[o,n,a]}),[t,h.gtMd,k,j,A,e]);return(0,l.jsx)(f.bE,{testID:"Wallet-Page-Header-Right",className:"app-region-no-drag",children:T})}function HeaderTitle({sceneName:e}){var t=(0,r.useMemo)((function(){if(e===u.Zs.homeUrlAccount)return(0,l.jsx)(I.Address,{},"urlAccountNavHeaderAddress")}),[e]);return(0,l.jsx)(c.b8,{enabledNum:[0],config:{sceneName:e,sceneUrl:""},children:t})}function TabPageHeader({sceneName:e,showHeaderRight:t}){(0,a.e)({name:`web TabPageHeader:${e}:${String(t)}`});var n=(0,r.useCallback)((function(){return(0,l.jsx)(HeaderLeft,{sceneName:e})}),[e]),{config:u}=(0,s.H9)(),d=(0,r.useCallback)((function(){return t&&u?(0,l.jsx)(i.p,{children:(0,l.jsx)(c.b8,{enabledNum:[0],config:u,children:(0,l.jsx)(HeaderRight,{sceneName:e})})}):null}),[u,e,t]),p=(0,r.useCallback)((function(){return(0,l.jsx)(HeaderTitle,{sceneName:e})}),[e]);return(0,l.jsx)(l.Fragment,{children:(0,l.jsx)(o.Page.Header,{headerTitle:p,headerLeft:n,headerRight:d})})}},82506:(e,t,n)=>{n.d(t,{d:()=>useDebounce});var r=n(578104);function useDebounce(e,t,n){var[o]=(0,r.d7)(e,t,n);return o}},20322:(e,t,n)=>{n.d(t,{j:()=>useSwapFromAccountNetworkSync,z:()=>useSwapAddressInfo});var r=n(324586),o=n(586330),a=n(712784),s=n.n(a),i=n(514041),c=n(490343),u=n(153763),l=n(604343),d=n(757559),p=n(619390),f=n(317522),m=n(162616),g=n(325529);function ownKeys(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function _objectSpread(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?ownKeys(Object(n),!0).forEach((function(t){(0,r.A)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):ownKeys(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function useSwapFromAccountNetworkSync(){var{updateSelectedAccountNetwork:e}=(0,m.z$)().current,[t]=(0,g.NE)(),{activeAccount:n}=(0,m.LH)({num:1}),[r,a]=(0,g.rv)(),[p]=(0,g.dF)(),[,w]=(0,l.useSettingsAtom)(),[b]=(0,g.Q8)(),S=(0,i.useRef)(),v=(0,i.useRef)(),y=(0,i.useRef)(),A=(0,i.useRef)(r),k=(0,i.useRef)(n);k.current!==n&&(k.current=n),S.current!==t&&(S.current=t),v.current!==b&&(v.current=b),A.current!==r&&(A.current=r),y.current!==p&&(y.current=p);var j,h=(0,i.useCallback)(s()((0,o.A)((function*(){S.current&&(yield e({num:0,networkId:S.current?.networkId})),v.current&&(yield e({num:1,networkId:v.current?.networkId})),S.current&&v.current&&(A.current?.networkId&&v.current?.networkId!==A.current?.networkId||!A.current?.networkId&&!k.current?.account&&k.current?.wallet||!1===y.current)&&(w((function(e){return _objectSpread(_objectSpread({},e),{},{swapToAnotherAccountSwitchOn:!1})})),a((function(e){return _objectSpread(_objectSpread({},e),{},{address:void 0})})),setTimeout((function(){v.current&&e({num:1,networkId:v.current?.networkId})}),500))})),100),[w,e]),I=(0,c.usePageType)();(0,f.A)(d.V4.Swap,(j=(0,o.A)((function*(e,t){if(I!==c.EPageType.modal){if(t)return;e&&(yield h())}})),function(e,t){return j.apply(this,arguments)})),(0,i.useEffect)((function(){I!==c.EPageType.modal&&(0,o.A)((function*(){yield h()}))()}),[h,t,b,p,I]);var x=(0,u.E)();(0,i.useEffect)((function(){I===c.EPageType.modal&&x&&(0,o.A)((function*(){yield h()}))()}),[h,x,I,t,b,p])}function useSwapAddressInfo(e){var{activeAccount:t}=(0,m.LH)({num:e===p.En.FROM?0:1}),[{swapToAnotherAccountSwitchOn:n}]=(0,l.useSettingsAtom)(),[r]=(0,g.rv)();return(0,i.useMemo)((function(){var o={networkId:void 0,address:void 0,accountInfo:void 0};return e===p.En.TO&&n&&r.address&&r.networkId&&t&&t.network?.id===r.networkId?_objectSpread(_objectSpread({},o),{},{address:r.address,networkId:r.networkId,accountInfo:r.accountInfo}):t?_objectSpread(_objectSpread({},o),{},{address:t.account?.address,networkId:t.network?.id,accountInfo:_objectSpread({},t)}):o}),[e,n,r,t])}},866063:(e,t,n)=>{n.d(t,{FI:()=>useSwapInit,GM:()=>useSwapTokenList,ZF:()=>useSwapSelectedTokenInfo});var r=n(503668),o=n.n(r),a=n(324586),s=n(586330),i=n(514041),c=n(490343),u=n(153763),l=n(604343),d=n(557503),p=n(22937),f=n(757559),m=n(58546),g=n(619390),w=n(60153),b=n(317522),S=n(162616),v=n(325529),y=n(20322);function ownKeys(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function _objectSpread(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?ownKeys(Object(n),!0).forEach((function(t){(0,a.A)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):ownKeys(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function useSwapInit(e){var[t,n]=(0,v.ZM)(),[r,a]=(0,v.NE)(),[c,u]=(0,v.Q8)(),[,l]=(0,v.tb)(),p=(0,y.z)(g.En.FROM),{updateSelectedAccountNetwork:f}=(0,S.z$)().current,[b,A]=(0,i.useState)(!0),k=(0,i.useRef)();k.current!==p&&(k.current=p);var j=(0,i.useRef)([]);j.current!==t&&(j.current=t);var h=(0,i.useRef)();h.current!==r&&(h.current=r);var I=(0,i.useRef)();I.current!==c&&(I.current=c);var x=(0,i.useCallback)((0,s.A)((function*(){if(t.length)A(!1);else{var e=yield w.A.simpleDb.swapNetworksSort.getRawData();e?.data?.length&&(n(e.data),A(!1));var r=[],o=yield w.A.serviceSwap.fetchSwapNetworks();if(r=[...o],e?.data?.length&&o?.length){var a=e.data;r=a.filter((function(e){return o.find((function(t){return t.networkId===e.networkId}))})).map((function(e){var t=o.find((function(t){return t.networkId===e.networkId}));return _objectSpread(_objectSpread({},e),t)})).concat(o.filter((function(e){return!a.find((function(t){return t.networkId===e.networkId}))})))}r.length&&(yield w.A.simpleDb.swapNetworksSort.setRawData({data:r}),e?.data?.length&&e?.data?.length===r.length||(n(r),A(!1)))}})),[n,t.length]),T=(0,i.useCallback)((0,s.A)((function*(){if(e?.importFromToken&&j.current.find((function(t){return t.networkId===e?.importFromToken?.networkId}))||e?.importToToken&&j.current.find((function(t){return t.networkId===e?.importFromToken?.networkId})))return a(e.importFromToken),void u(e.importToToken);if(!(!k.current?.accountInfo?.ready||!k.current?.networkId||!j.current.length||e?.importNetworkId&&k.current?.networkId&&e?.importNetworkId!==k.current?.networkId||h.current||I.current)){var t=j.current.find((function(e){return e.networkId===k.current?.networkId})),n=k.current?.networkId===d.Tc.id,r=t,s=t?.networkId;if(n&&(s=d.Tc.id,r=j.current.find((function(e){return"evm--1"===e.networkId}))),r&&s&&(!o()(m.TW[s]?.fromToken)||!o()(m.TW[s]?.toToken))){var i=m.TW[s]?.fromToken,c=m.TW[s]?.toToken;i&&a(_objectSpread(_objectSpread({},i),{},{networkLogoURI:r?.logoURI})),c&&u(_objectSpread(_objectSpread({},c),{},{networkLogoURI:r?.logoURI}))}}})),[e?.importFromToken,e?.importNetworkId,e?.importToToken,a,u]);return(0,i.useEffect)((function(){(0,s.A)((function*(){yield x()}))()}),[x,t.length]),(0,i.useEffect)((function(){(0,s.A)((function*(){var e=yield w.A.simpleDb.swapConfigs.getRawData();e?.providerSort&&l(e.providerSort)}))()}),[l]),(0,i.useEffect)((function(){(0,s.A)((function*(){e?.importNetworkId&&k.current?.networkId&&e.importNetworkId!==k.current.networkId&&(yield f({num:0,networkId:e.importNetworkId}))}))()}),[e?.importNetworkId,f]),(0,i.useEffect)((function(){(0,s.A)((function*(){yield T()}))()}),[p.accountInfo?.ready,t.length,p.networkId,e?.importFromToken,e?.importToToken,e?.importNetworkId]),{fetchLoading:b}}function useSwapTokenList(e,t,n){var[r,o]=(0,i.useState)([]),[{tokenCatch:a}]=(0,v.PQ)(),{tokenListFetchAction:s}=(0,v.eR)().current,c=(0,y.z)(e),[u]=(0,v.Hb)(),l=(0,i.useMemo)((function(){return{networkId:t,keywords:n,accountAddress:c?.address,accountNetworkId:c?.networkId,accountId:c?.accountInfo?.account?.id}}),[t,n,c?.address,c?.networkId,c?.accountInfo?.account]),d=(0,p.bJ)(a?.[JSON.stringify(l)]?.data||[],{keys:["symbol"].concat(1===(a?.[JSON.stringify(l)]?.data||[]).length?["contractAddress"]:[])}),f=(0,i.useRef)(d);return f.current!==d&&(f.current=d),(0,i.useEffect)((function(){l.accountNetworkId&&l.networkId!==l.accountNetworkId||s(l)}),[l,s]),(0,i.useEffect)((function(){l.accountNetworkId&&l.networkId!==l.accountNetworkId||(n&&f.current?o(f.current.search(n)):o(a?.[JSON.stringify(l)]?.data||[]))}),[a,l,t,n]),{fetchLoading:u&&0===r.length,currentTokens:r}}function useSwapSelectedTokenInfo({token:e,type:t}){var n=(0,y.z)(t),[r,o]=(0,i.useState)(0),[{swapHistoryPendingList:a}]=(0,l.useInAppNotificationAtom)(),{loadSwapSelectTokenDetail:s}=(0,v.eR)().current,d=(0,i.useRef)(a);d.current!==a&&(d.current=a);var p=(0,i.useRef)(r);p.current!==r&&(p.current=r);var m=(0,i.useRef)(n);m.current!==n&&(m.current=n);var w=(0,u.E)(),S=(0,i.useRef)(w);S.current!==w&&(S.current=w),(0,i.useEffect)((function(){if(S.current&&a.length){var e=a.filter((function(e){return e.status===g.lr.SUCCESS})).length;e>p.current&&(s(t,m.current,!0),o(e))}}),[s,a,t]),(0,i.useEffect)((function(){s(t,m.current)}),[t,n,e?.networkId,e?.contractAddress,s]);var A=(0,c.usePageType)();(0,b.A)(f.V4.Swap,(function(e,n){if(A!==c.EPageType.modal&&e&&!n&&d.current.length){var r=d.current.filter((function(e){return e.status===g.lr.SUCCESS})).length;r>p.current&&(s(t,m.current,!0),o(r))}}))}},321376:(e,t,n)=>{n.r(t),n.d(t,{default:()=>views_Swap});var r=n(901976),o=n(714191),a=n(325809),s=n(490343),i=n(660823),c=n(663504),u=n(831085);const pages_SwapPageContainer=function(){return(0,r.e)({name:"SwapPageContainer"}),(0,u.jsxs)(s.Page,{fullPage:!0,children:[(0,u.jsx)(i.i,{sceneName:o.Zs.swap,showHeaderRight:!1}),(0,u.jsx)(s.Page.Body,{children:(0,u.jsx)(c.A,{})})]})};const views_Swap=function(){return(0,r.e)({name:"SwapRoutePage"}),(0,u.jsx)(a.b8,{config:{sceneName:o.Zs.swap,sceneUrl:""},enabledNum:[0,1],children:(0,u.jsx)(pages_SwapPageContainer,{})})}},309008:(e,t,n)=>{n.d(t,{o:()=>l});var r=n(324586),o=n(514041),a=n(325529),s=n(2577),i=n(597102),c=n(829561),u=n(831085);function ownKeys(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function _objectSpread(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?ownKeys(Object(n),!0).forEach((function(t){(0,r.A)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):ownKeys(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var l=(0,o.memo)((function(e){var{children:t,storeName:n}=e,r=(0,c.x6)(n),o=s.A.getOrCreateStore(r);return(0,u.jsxs)(u.Fragment,{children:[(0,u.jsx)(i.H,_objectSpread({},r)),(0,u.jsx)(a.BY,{store:o,children:t})]})}));l.displayName="SwapProviderMirror"},663504:(e,t,n)=>{n.d(t,{A:()=>SwapMainLand});var r=n(324586),o=n(586330),a=n(514041),s=n(490343),i=n(498356),c=n(325529),u=n(604343),l=n(757559),d=n(628380),p=n(58546),f=n(619390),m=n(20322),g=n(241440),w=n(583354),b=n(213644),S=n(403144),v=n(60153),y=n(927799);function ownKeys(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function _objectSpread(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?ownKeys(Object(n),!0).forEach((function(t){(0,r.A)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):ownKeys(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function useSwapBuildTx(){var e,t,n,r,s,[i]=(0,c.NE)(),[l]=(0,c.Q8)(),[{slippageItem:d}]=(0,c.H_)(),[p]=(0,c.Zr)(),[,A]=(0,c.sh)(),[,k]=(0,u.useInAppNotificationAtom)(),[,j]=(0,c.VS)(),[,h]=(0,c.oz)(),I=(0,m.z)(f.En.FROM),x=(0,m.z)(f.En.TO),{generateSwapHistoryItem:T}=function useSwapTxHistoryActions(){var e,[t]=(0,c.ZM)(),[,n]=(0,c.NE)(),[,r]=(0,c.Q8)(),[,s]=(0,c.VS)(),[i]=(0,u.useSettingsPersistAtom)(),l=(0,a.useCallback)((e=(0,o.A)((function*({txId:e,gasFeeInNative:n,gasFeeFiatValue:r,swapTxInfo:o}){if(o){var a,s,c,u={status:f.lr.PENDING,currency:i.currencyInfo.symbol,baseInfo:{toAmount:o.receiver.amount,fromAmount:o.sender.amount,fromToken:o.sender.token,toToken:o.receiver.token,fromNetwork:t.find((function(e){return e?.networkId===o.sender.token.networkId})),toNetwork:t.find((function(e){return e?.networkId===o.receiver.token.networkId}))},txInfo:{txId:e,gasFeeFiatValue:r,gasFeeInNative:n,orderId:o.swapBuildResData.swftOrder?.orderId,sender:o.accountAddress,receiver:o.receivingAddress},date:{created:Date.now(),updated:Date.now()},swapInfo:{instantRate:null!=(a=o.swapBuildResData.result.instantRate)?a:"0",provider:o.swapBuildResData.result.info,socketBridgeScanUrl:o.swapBuildResData.socketBridgeScanUrl,oneKeyFee:null!=(s=o.swapBuildResData.result.fee?.percentageFee)?s:0,protocolFee:null!=(c=o.swapBuildResData.result.fee?.protocolFees)?c:0,orderId:o.swapBuildResData.orderId,supportUrl:o.swapBuildResData.result.supportUrl},ctx:o.swapBuildResData.ctx};yield v.A.serviceSwap.addSwapHistoryItem(u)}})),function(t){return e.apply(this,arguments)}),[i.currencyInfo.symbol,t]);return{generateSwapHistoryItem:l,swapAgainUseHistoryItem:(0,a.useCallback)((function(e){n(e?.baseInfo.fromToken),r(e?.baseInfo.toToken),s(e?.baseInfo.fromAmount)}),[n,s,r])}}(),[{isFirstTimeSwap:O},_]=(0,u.useSettingsPersistAtom)(),{navigationToSendConfirm:M}=(0,y.E)({accountId:null!=(e=I.accountInfo?.account?.id)?e:"",networkId:null!=(t=I.networkId)?t:""}),E=(0,a.useCallback)((n=(0,o.A)((function*(e){if(e?.[0]){j("");var t=e[0].signedTx,n=e[0].decodedTx,r=t.txid,{swapInfo:o}=t,{totalFeeInNative:a,totalFeeFiatValue:s}=n;o&&(yield T({txId:r,gasFeeFiatValue:s,gasFeeInNative:a,swapTxInfo:o}))}A(!1)})),function(e){return n.apply(this,arguments)}),[T,A,j]),C=(0,a.useCallback)((r=(0,o.A)((function*(e){if(e?.[0]){var t=e[0].signedTx.txid;k((function(e){return e.swapApprovingTransaction?_objectSpread(_objectSpread({},e),{},{swapApprovingTransaction:_objectSpread(_objectSpread({},e.swapApprovingTransaction),{},{txId:t})}):e}))}})),function(e){return r.apply(this,arguments)}),[k]),P=(0,a.useCallback)((function(){A(!1)}),[A]),R=(0,a.useCallback)((function(){P(),h(!0)}),[P,h]),$=(0,a.useCallback)((function(){P(),k((function(e){return e.swapApprovingTransaction?_objectSpread(_objectSpread({},e),{},{swapApprovingTransaction:_objectSpread(_objectSpread({},e.swapApprovingTransaction),{},{status:f.MG.CANCEL})}):e}))}),[P,k]),N=(0,a.useCallback)((0,o.A)((function*(){if(i&&l&&p?.fromAmount&&p?.toAmount&&I.address&&x.address&&I.networkId){A(!0);var e=i.isNative?w.D.DEPOSIT:w.D.WITHDRAW,t={from:I.address,type:e,contract:e===w.D.WITHDRAW?i.contractAddress:l.contractAddress,amount:p?.fromAmount},n={sender:{amount:p?.fromAmount,token:i},receiver:{amount:p.toAmount,token:l},accountAddress:I.address,receivingAddress:x.address,swapBuildResData:{result:p}};yield M({wrappedInfo:t,swapInfo:n,onSuccess:E,onCancel:P})}})),[i,l,p,I.address,I.networkId,x.address,A,M,E,P]),D=(0,a.useCallback)((s=(0,o.A)((function*(e,t,n){var r=p?.allowanceResult;if(r&&i&&l&&I.networkId&&I.accountInfo?.account?.id&&I.address)try{var o;A(!0);var a={owner:I.address,spender:r.allowanceTarget,amount:e,isMax:!n&&t,tokenInfo:_objectSpread(_objectSpread({},i),{},{isNative:!!i.isNative,address:i.contractAddress,name:null!=(o=i.name)?o:i.symbol})};k((function(o){var a;return _objectSpread(_objectSpread({},o),{},{swapApprovingTransaction:{provider:p?.info.provider,fromToken:i,toToken:l,amount:e,useAddress:null!=(a=I.address)?a:"",spenderAddress:r.allowanceTarget,status:f.MG.PENDING,resetApproveValue:n,resetApproveIsMax:t}})})),yield M({approveInfo:a,onSuccess:C,onCancel:$})}catch(e){A(!1)}})),function(e,t,n){return s.apply(this,arguments)}),[p?.allowanceResult,p?.info.provider,i,l,I.networkId,I.accountInfo?.account?.id,I.address,A,k,M,C,$]);return{buildTx:(0,a.useCallback)((0,o.A)((function*(){if(i&&l&&p?.fromAmount&&d&&p?.toAmount&&I.address&&x.address&&I.networkId)try{A(!0);var e=yield v.A.serviceSwap.fetchBuildTx({fromToken:i,toToken:l,toTokenAmount:p.toAmount,fromTokenAmount:p.fromAmount,slippagePercentage:d.value,receivingAddress:x.address,userAddress:I.address,provider:p?.info.provider,accountId:I.accountInfo?.account?.id,quoteResultCtx:p?.quoteResultCtx});if(e){var t,n,r,o,a;if(e?.swftOrder)o=void 0,r={from:I.address,tokenInfo:_objectSpread(_objectSpread({},e.result.fromTokenInfo),{},{isNative:!!e.result.fromTokenInfo.isNative,address:e.result.fromTokenInfo.contractAddress,name:null!=(a=e.result.fromTokenInfo.name)?a:e.result.fromTokenInfo.symbol}),to:e.swftOrder.platformAddr,amount:e.swftOrder.depositCoinAmt};else if(e?.changellyOrder){var s;o=void 0,r={from:I.address,tokenInfo:_objectSpread(_objectSpread({},e.result.fromTokenInfo),{},{isNative:!!e.result.fromTokenInfo.isNative,address:e.result.fromTokenInfo.contractAddress,name:null!=(s=e.result.fromTokenInfo.name)?s:e.result.fromTokenInfo.symbol}),to:e.changellyOrder.payinAddress,amount:e.changellyOrder.amountExpectedFrom}}else if(e?.thorSwapCallData){var c;o=void 0,r={from:I.address,tokenInfo:_objectSpread(_objectSpread({},e.result.fromTokenInfo),{},{isNative:!!e.result.fromTokenInfo.isNative,address:e.result.fromTokenInfo.contractAddress,name:null!=(c=e.result.fromTokenInfo.name)?c:e.result.fromTokenInfo.symbol}),to:e.thorSwapCallData.vault,opReturn:e.thorSwapCallData.hasStreamingSwap?e.thorSwapCallData.memoStreamingSwap:e.thorSwapCallData.memo,amount:new g.A(e.thorSwapCallData.amount).shiftedBy(-i.decimals).toFixed()}}else if(e?.tx)if(r=void 0,"string"!=typeof e.tx&&e.tx.data){var u,m=(0,S.Si)(new g.A(null!=(u=e.tx.value)?u:0));o=_objectSpread(_objectSpread({},e?.tx),{},{value:m,from:I.address})}else o=e.tx;var w={sender:{amount:p.fromAmount,token:i},receiver:{amount:p.toAmount,token:l},accountAddress:I.address,receivingAddress:x.address,swapBuildResData:e};yield M({transfersInfo:r?[r]:void 0,encodedTx:o,swapInfo:w,onSuccess:E,onCancel:R}),b.U.swap.createSwapOrder.swapCreateOrder({swapType:f.If.SWAP,slippage:d.value.toString(),sourceChain:i.networkId,receivedChain:l.networkId,fromAddress:I.address,toAddress:x.address,sourceTokenSymbol:i.symbol,receivedTokenSymbol:l.symbol,swapAmount:p?.fromAmount,swapValue:p?.toAmount,feeType:null!=(t=p?.fee?.percentageFee?.toString())?t:"0",router:JSON.stringify(null!=(n=p?.routesData)?n:""),isFirstTime:O}),_((function(e){return _objectSpread(_objectSpread({},e),{},{isFirstTimeSwap:!1})}))}else A(!1),h(!0)}catch(e){A(!1),h(!0)}})),[_,i,l,p?.fromAmount,p?.toAmount,p?.info.provider,p?.quoteResultCtx,p?.fee?.percentageFee,p?.routesData,d,I.address,I.networkId,I.accountInfo?.account?.id,x.address,A,M,E,R,O,h]),wrappedTx:N,approveTx:D}}var A=n(908867),k=n(153763),j=n(254491),h=n(82506);function useSwapQuoteLoading(){var[e]=(0,c.iA)(),[t]=(0,c.I4)();return e||t}function useSwapActionState(){var e=(0,A.A)(),t=useSwapQuoteLoading(),[n]=(0,c.Zr)(),[r]=(0,c.sh)(),[o]=(0,c.VS)(),[s]=(0,c.NE)(),[i]=(0,c.Q8)(),[u]=(0,c.oz)(),[l]=(0,c.rE)();!function useSwapWarningCheck(){var e=(0,m.z)(f.En.FROM),[t]=(0,c.ZM)(),[n]=(0,c.NE)(),[r]=(0,c.Q8)(),[o]=(0,c.Zr)(),[s]=(0,c.VS)(),[i]=(0,c.kz)(),{checkSwapWarning:u}=(0,c.eR)().current,l=(0,a.useRef)({swapFromAddressInfo:{address:void 0,networkId:void 0,accountInfo:void 0}}),d=(0,k.E)(),p=(0,a.useCallback)((function(){l.current.swapFromAddressInfo!==e&&(l.current.swapFromAddressInfo=e)}),[e]);(0,a.useEffect)((function(){d&&(p(),u(l.current.swapFromAddressInfo))}),[p,u,n,s,r,i,o,t,d])}();var[d]=(0,c.LX)(),[w]=(0,c.kz)(),b=s?.networkId!==i?.networkId,S=(0,m.z)(f.En.FROM),v=(0,m.z)(f.En.TO),{getQuoteIntervalCount:y}=(0,c.eR)().current,I=y()>=p.si||u,x=d.some((function(e){return e.alertLevel===f.HM.ERROR})),T=(0,a.useMemo)((function(){return n&&(n.fromTokenInfo.networkId!==s?.networkId||n.toTokenInfo.networkId!==i?.networkId||n.fromTokenInfo.contractAddress!==s?.contractAddress||n.toTokenInfo.contractAddress!==i?.contractAddress)||n?.allowanceResult&&n.allowanceResult.amount!==o}),[s?.contractAddress,s?.networkId,o,n,i?.contractAddress,i?.networkId]),O=(0,h.d)(T,10),_=(0,a.useMemo)((function(){var r={disable:!(!x&&n),label:e.formatMessage({id:j.ETranslations.swap_page_swap_button})};if(S.address&&v.address&&n?.fromAmount===o||(r.disable=!0),t)r.label=e.formatMessage({id:j.ETranslations.swap_page_button_fetching_quotes});else{b&&s&&i&&(r.label=e.formatMessage({id:j.ETranslations.swap_page_button_cross_chain})),n&&n.isWrapped&&(r.label=e.formatMessage({id:j.ETranslations.swap_page_button_wrap})),n&&n.allowanceResult&&(r.label=e.formatMessage({id:j.ETranslations.global_approve})),!n||n.toAmount||n.limit||(r.label=e.formatMessage({id:j.ETranslations.swap_page_alert_no_provider_supports_trade}),r.disable=!0),n&&n.toAmount&&!v.address&&(r.label=e.formatMessage({id:j.ETranslations.swap_page_button_enter_a_recipient}),r.disable=!0);var a=new g.A(null!=w?w:0),c=new g.A(o);s&&S.address&&a.lt(c)&&(r.label=e.formatMessage({id:j.ETranslations.swap_page_button_insufficient_balance}),r.disable=!0),s&&i||(r.label=e.formatMessage({id:j.ETranslations.swap_page_button_select_token}),r.disable=!0),o||(r.label=e.formatMessage({id:j.ETranslations.swap_page_button_enter_amount}),r.disable=!0),(I||O)&&(r.label=e.formatMessage({id:j.ETranslations.swap_page_button_refresh_quotes}),r.disable=!1)}return r}),[s,o,x,e,b,I,n,t,O,w,S.address,v.address,i]);return{label:_.label,isLoading:r,disabled:_.disable||t,approveUnLimit:l,isApprove:!!n?.allowanceResult,isCrossChain:b,shoutResetApprove:!!n?.allowanceResult?.shouldResetApprove,isWrapped:!!n?.isWrapped,isRefreshQuote:(I||O)&&!t}}var I=n(866063),x=n(309008),T=n(831085);function SwapActionsState_ownKeys(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function SwapActionsState_objectSpread(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?SwapActionsState_ownKeys(Object(n),!0).forEach((function(t){(0,r.A)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):SwapActionsState_ownKeys(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}const O=(0,a.memo)((function({onBuildTx:e,onApprove:t,onWrapped:n}){var r=(0,A.A)(),[o]=(0,c.NE)(),[i]=(0,c.VS)(),u=(0,m.z)(f.En.FROM),{cleanQuoteInterval:l,quoteAction:d}=(0,c.eR)().current,p=useSwapActionState(),g=useSwapQuoteLoading(),w=(0,a.useCallback)((function(){p.shoutResetApprove?s.Dialog.confirm({onConfirmText:r.formatMessage({id:j.ETranslations.global_continue}),onConfirm:function(){t(i,p.approveUnLimit,!0)},showCancelButton:!0,title:r.formatMessage({id:j.ETranslations.swap_page_provider_approve_usdt_dialog_title}),description:r.formatMessage({id:j.ETranslations.swap_page_provider_approve_usdt_dialog_content}),icon:"ErrorOutline"}):t(i,p.approveUnLimit)}),[i,r,t,p.approveUnLimit,p.shoutResetApprove]),b=(0,s.usePageType)(),{md:S}=(0,s.useMedia)(),v=(0,a.useCallback)((function(){if(p.isRefreshQuote)d(u?.address,u?.accountInfo?.account?.id);else{if(l(),p.isApprove)return void w();if(p.isWrapped)return void n();e()}}),[l,w,e,n,d,p.isApprove,p.isRefreshQuote,p.isWrapped,u?.accountInfo?.account?.id,u?.address]),y=(0,a.useMemo)((function(){var e;return p.isApprove&&!g?(0,T.jsxs)(s.XStack,SwapActionsState_objectSpread(SwapActionsState_objectSpread({space:"$1"},b!==s.EPageType.modal||S?{pb:"$5"}:{}),{},{children:[(0,T.jsx)(s.Popover,{title:r.formatMessage({id:j.ETranslations.global_approve}),placement:"top-start",renderContent:(0,T.jsx)(s.SizableText,{size:"$bodyLg",$gtMd:{size:"$bodyMd",pt:"$5"},pb:"$5",px:"$5",children:r.formatMessage({id:j.ETranslations.swap_page_swap_steps_1_approve_dialog})}),renderTrigger:(0,T.jsxs)(s.XStack,{userSelect:"none",hoverStyle:{opacity:.5},children:[(0,T.jsx)(s.SizableText,{size:"$bodyMdMedium",pr:"$1",children:r.formatMessage({id:j.ETranslations.swap_page_swap_steps_1},{tokenSymbol:null!=(e=o?.symbol)?e:""})}),(0,T.jsx)(s.Icon,{size:"$5",color:"$iconSubdued",name:"QuestionmarkOutline"})]})}),(0,T.jsx)(s.Icon,{name:"ArrowRightOutline",size:"$5",color:"$iconSubdued"}),(0,T.jsx)(s.SizableText,{size:"$bodyMd",color:"$textSubdued",children:r.formatMessage({id:j.ETranslations.swap_page_swap_steps_2})})]})):null}),[o?.symbol,r,S,b,g,p.isApprove]),k=(0,a.useMemo)((function(){return(0,T.jsxs)(s.Stack,SwapActionsState_objectSpread(SwapActionsState_objectSpread({flex:1},b!==s.EPageType.modal||S?{}:{flexDirection:"row",justifyContent:p.isApprove&&!g?"space-between":"flex-end",alignItems:"center"}),{},{children:[y,(0,T.jsx)(s.Button,{onPress:v,size:b!==s.EPageType.modal||S?"large":"medium",variant:"primary",disabled:p.disabled||p.isLoading,loading:p.isLoading,children:p.label})]}))}),[y,S,v,b,g,p.disabled,p.isApprove,p.isLoading,p.label]);return(0,T.jsx)(s.YStack,{p:"$5",children:b===s.EPageType.modal||S?(0,T.jsx)(s.Page.Footer,SwapActionsState_objectSpread(SwapActionsState_objectSpread({},b!==s.EPageType.modal||S?{}:{buttonContainerProps:{flex:1}}),{},{confirmButton:k})):k})}));function SwapAlertContainer_ownKeys(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function SwapAlertContainer_objectSpread(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?SwapAlertContainer_ownKeys(Object(n),!0).forEach((function(t){(0,r.A)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):SwapAlertContainer_ownKeys(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}const _=(0,a.memo)((function({alerts:e}){var t,n=(0,a.useMemo)((function(){return e?.sort((function(e){return e.alertLevel===f.HM.ERROR?-1:e.alertLevel===f.HM.INFO?0:1}))}),[e]);return n?.some((function(e){return e.alertLevel===f.HM.ERROR}))?n.filter((function(e){return e.alertLevel===f.HM.ERROR})).reverse().map((function(e,t){var{message:n}=e;return(0,T.jsx)(s.Alert,SwapAlertContainer_objectSpread({type:"critical",description:n},0!==t&&{mt:"$2.5"}),t)})):null!=(t=n?.map((function(e,t){var{message:n,alertLevel:r}=e;return(0,T.jsx)(s.Alert,SwapAlertContainer_objectSpread({type:r===f.HM.WARNING?"warning":"default",description:n},0!==t&&{mt:"$2.5"}),t)})))?t:null}));var M=n(896666),SwapHeaderRightActionContainer=function({storeName:e}){var t=(0,i.A)(),[{swapHistoryPendingList:n}]=(0,u.useInAppNotificationAtom)(),r=(0,a.useMemo)((function(){return n.filter((function(e){return e.status===f.lr.PENDING||e.status===f.lr.CANCELING}))}),[n]),o=(0,a.useCallback)((function(){t.pushModal(l.ry.SwapModal,{screen:d.u.SwapHistoryList,params:{storeName:e}})}),[t,e]);return(0,T.jsx)(M.bE,{children:r.length>0?(0,T.jsxs)(s.Badge,{badgeSize:"lg",badgeType:"info",onPress:o,children:[(0,T.jsx)(s.Stack,{borderRadius:"$full",p:3,bg:"$borderInfo",children:(0,T.jsx)(s.Stack,{w:"$1.5",h:"$1.5",borderRadius:"$full",bg:"$iconInfo"})}),(0,T.jsx)(s.Badge.Text,{cursor:"pointer",pl:"$2",children:`${r.length} Pending `})]}):(0,T.jsx)(M.v$,{icon:"ClockTimeHistoryOutline",onPress:o,iconProps:{size:24},size:"medium"})})};const components_SwapHeaderRightActionContainer=function({storeName:e}){return(0,T.jsx)(x.o,{storeName:e,children:(0,T.jsx)(SwapHeaderRightActionContainer,{storeName:e})})};const E=(0,a.memo)((function({pageType:e}){var t=(0,A.A)(),n=(0,a.useCallback)((function(){return(0,T.jsx)(components_SwapHeaderRightActionContainer,{storeName:e===s.EPageType.modal?u.EJotaiContextStoreNames.swapModal:u.EJotaiContextStoreNames.swap})}),[e]),r=(0,a.useCallback)((function(){s.Dialog.confirm({icon:"InfoCircleOutline",showCancelButton:!1,onConfirmText:t.formatMessage({id:j.ETranslations.swap_page_limit_dialog_button}),title:t.formatMessage({id:j.ETranslations.swap_page_limit_dialog_title}),description:t.formatMessage({id:j.ETranslations.swap_page_limit_dialog_content})})}),[t]);return(0,T.jsxs)(s.XStack,{justifyContent:"space-between",children:[(0,T.jsxs)(s.XStack,{space:"$5",children:[(0,T.jsx)(s.SizableText,{size:"$headingLg",userSelect:"none",children:t.formatMessage({id:j.ETranslations.swap_page_swap})}),(0,T.jsxs)(s.XStack,{opacity:.5,space:"$1",onPress:r,children:[(0,T.jsx)(s.SizableText,{size:"$headingLg",userSelect:"none",children:t.formatMessage({id:j.ETranslations.swap_page_limit})}),(0,T.jsx)(s.Badge,{badgeSize:"sm",badgeType:"default",children:t.formatMessage({id:j.ETranslations.coming_soon})})]})]}),n()]})}));var C=n(317522);function useSwapApproving_ownKeys(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function useSwapApproving_objectSpread(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?useSwapApproving_ownKeys(Object(n),!0).forEach((function(t){(0,r.A)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):useSwapApproving_ownKeys(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var P=n(100009);var R=n(88803),$=n(353203),N=n(557503),D=n(491180);function SwapAccountAddressContainer_ownKeys(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function SwapAccountAddressContainer_objectSpread(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?SwapAccountAddressContainer_ownKeys(Object(n),!0).forEach((function(t){(0,r.A)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):SwapAccountAddressContainer_ownKeys(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function AddressButton({address:e,empty:t,edited:n,loading:r,onPress:o}){var a=(0,A.A)();return(0,T.jsxs)(s.XStack,SwapAccountAddressContainer_objectSpread(SwapAccountAddressContainer_objectSpread({alignItems:"center",space:"$1",py:"$0.5",px:"$1.5",my:"$-0.5",mx:"$-1.5",borderRadius:"$2",opacity:r?.5:1,disabled:!!r,onPress:o},o&&{role:"button",userSelect:"none",focusable:!0,hoverStyle:{bg:"$bgHover"},pressStyle:{bg:"$bgActive"},focusStyle:{outlineWidth:2,outlineColor:"$focusRing",outlineStyle:"solid"},"$platform-native":{hitSlop:{top:8,right:8}}}),{},{children:[(0,T.jsxs)(s.XStack,{children:[(0,T.jsx)(s.SizableText,{size:"$bodyMd",color:t?"$textCaution":"$textSubdued",children:t?a.formatMessage({id:j.ETranslations.wallet_no_address}):e}),n?(0,T.jsx)(s.SizableText,{size:"$bodyMd",color:"$textSubdued",children:a.formatMessage({id:j.ETranslations.swap_account_to_address_edit})}):null]}),r?(0,T.jsx)(s.Spinner,{size:"small"}):null,o&&t&&!r?(0,T.jsx)(s.Icon,{name:"PlusCircleOutline",size:"$4.5",color:"$iconSubdued",mr:"$-0.5"}):null,!o||t||r?null:(0,T.jsx)(s.Icon,{name:"PencilOutline",size:"$4.5",color:"$iconSubdued",mr:"$-0.5"})]}))}const components_SwapAccountAddressContainer=function({type:e,onToAnotherAddressModal:t}){var n=(0,A.A)(),r=(0,m.z)(e),i=(0,m.z)(e===f.En.FROM?f.En.TO:f.En.FROM),[l]=(0,c.NE)(),[d]=(0,c.Q8)(),[p]=(0,c.Zr)(),[g]=(0,c.dF)(),{createAddress:w}=(0,$.m)(),[{swapToAnotherAccountSwitchOn:b}]=(0,u.useSettingsAtom)(),[S,v]=(0,u.useAccountManualCreatingAtom)(),y=(0,a.useCallback)((0,o.A)((function*(){if(r.accountInfo){var t=r.accountInfo.network?.id,o=r.accountInfo.wallet?.id,a=r.accountInfo.indexedAccount?.id,i=r.accountInfo.deriveType,c={walletId:o,indexedAccountId:a,deriveType:i,networkId:t},u=t&&o&&(i||a)?[t,i,o,a].join("-"):Math.random().toString();try{v((function(e){return SwapAccountAddressContainer_objectSpread(SwapAccountAddressContainer_objectSpread({},e),{},{key:u,isLoading:!0})})),yield w({num:e===f.En.FROM?0:1,account:c,selectAfterCreate:!1}),s.Toast.success({title:n.formatMessage({id:j.ETranslations.swap_page_toast_address_generated})})}catch(e){s.Toast.error({title:n.formatMessage({id:j.ETranslations.swap_page_toast_address_generated_fail})})}finally{v((function(e){return SwapAccountAddressContainer_objectSpread(SwapAccountAddressContainer_objectSpread({},e),{},{isLoading:!1})}))}}})),[w,n,v,r.accountInfo,e]),k=(0,a.useMemo)((function(){var o,a,s;return(l||e!==f.En.FROM)&&(d||e!==f.En.TO)&&(e!==f.En.FROM||r.accountInfo?.wallet&&(!(D.A.isHdWallet({walletId:r.accountInfo?.wallet?.id})||D.A.isHwWallet({walletId:r.accountInfo?.wallet?.id})||D.A.isQrWallet({walletId:r.accountInfo?.wallet?.id}))||r.accountInfo?.indexedAccount)&&(r.address||D.A.isHdWallet({walletId:r.accountInfo?.wallet?.id})||D.A.isHwWallet({walletId:r.accountInfo?.wallet?.id})))?(l&&e===f.En.FROM||d&&e===f.En.TO)&&r.address&&i.address&&r.address===i.address||r.accountInfo?.network?.id===N.Tc.id||i.accountInfo?.network?.id===N.Tc.id||l&&(!d||d&&!i.address)&&e===f.En.FROM&&r.address?null:!r.address&&(D.A.isHdWallet({walletId:r.accountInfo?.wallet?.id})||D.A.isHwWallet({walletId:r.accountInfo?.wallet?.id})||D.A.isQrWallet({walletId:r.accountInfo?.wallet?.id}))?(0,T.jsx)(AddressButton,{empty:!0,loading:S.isLoading,onPress:y}):e!==f.En.FROM&&g&&p?(0,T.jsx)(AddressButton,{onPress:t,address:b&&r.address?`${D.A.shortenAddress({address:null!=(o=r.address)?o:"",leadingLength:8})} ${n.formatMessage({id:j.ETranslations.swap_account_to_address_edit})}`:D.A.shortenAddress({address:null!=(a=r.address)?a:"",leadingLength:8})}):(0,T.jsx)(AddressButton,{address:D.A.shortenAddress({address:null!=(s=r.address)?s:"",leadingLength:8})}):null}),[l,e,d,r.accountInfo?.wallet,r.accountInfo?.indexedAccount,r.accountInfo?.network?.id,r.address,i.address,i.accountInfo?.network?.id,g,p,t,b,n,S.isLoading,y]);return(0,T.jsxs)(s.XStack,{pb:"$1.5",children:[(0,T.jsx)(s.SizableText,{size:"$bodyMdMedium",mr:"$2",userSelect:"none",children:n.formatMessage({id:e===f.En.FROM?j.ETranslations.swap_page_from:j.ETranslations.swap_page_to})}),k]})};const L=(0,a.memo)((function({onAmountChange:e,direction:t,token:n,amountValue:r,selectTokenLoading:o,inputLoading:i,onSelectToken:l,onBalanceMaxPress:d,onToAnotherAddressModal:p,balance:m}){(0,I.ZF)({token:n,type:t});var[w]=(0,u.useSettingsPersistAtom)(),[b]=(0,c.LX)(),[S]=(0,c.I5)(),v=(0,a.useMemo)((function(){var e;if(!n?.price)return"0.0";var t=new g.A(null!=(e=n.price)?e:0),o=new g.A(null!=r?r:0).multipliedBy(t);return o.isNaN()?"0.0":`${o.decimalPlaces(6,g.A.ROUND_DOWN).toFixed()}`}),[r,n?.price]),y=(0,a.useMemo)((function(){return b?.some((function(e){return e.inputShowError}))&&t===f.En.FROM}),[t,b]),A=(0,a.useMemo)((function(){if(S&&t===f.En.TO){var e="$textSubdued";return S.unit===f.GK.NEGATIVE&&(e="$textCritical"),S.unit===f.GK.POSITIVE&&(e="$textSuccess"),(0,T.jsx)(s.SizableText,{size:"$bodyMd",color:e,children:S.value})}return null}),[t,S]);return(0,T.jsxs)(s.YStack,{children:[(0,T.jsx)(components_SwapAccountAddressContainer,{type:t,onToAnotherAddressModal:p}),(0,T.jsx)(R.J,{onChange:e,value:r,hasError:y,balanceProps:{value:m,onPress:d},valueProps:{value:v,loading:i,currency:w.currencyInfo.symbol,moreComponent:A},inputProps:{loading:i,placeholder:"0.0",readOnly:t===f.En.TO},tokenSelectorTriggerProps:{loading:o,selectedNetworkImageUri:n?.networkLogoURI,selectedTokenImageUri:n?.logoURI,selectedTokenSymbol:n?.symbol,onPress:function(){l(t)}},enableMaxAmount:t===f.En.FROM})]})}));const z=(0,a.memo)((function({onSelectToken:e,selectLoading:t,onToAnotherAddressModal:n}){var r,[o,i]=(0,c.VS)(),d=useSwapQuoteLoading(),[p]=(0,c.NE)(),[w]=(0,c.Q8)(),[b]=(0,c.WC)(),{alternationToken:S}=(0,c.eR)().current,[v]=(0,c.Zr)(),[y]=(0,c.kz)(),[I]=(0,c.pW)();return function useSwapQuote(){var e=(0,A.A)(),{quoteAction:t,cleanQuoteInterval:n,recoverQuoteInterval:r}=(0,c.eR)().current,o=(0,m.z)(f.En.FROM),[i]=(0,c.NE)(),[d]=(0,c.Q8)(),[p]=(0,c.DI)(),[g]=(0,c.FR)(),[w,b]=(0,c.VS)(),[{swapApprovingTransaction:S}]=(0,u.useInAppNotificationAtom)(),[v]=(0,c.oz)(),y=(0,a.useRef)(v);y.current!==v&&(y.current=v);var j=(0,k.E)(),I=(0,a.useRef)(j);I.current!==j&&(I.current=j);var x=(0,a.useRef)();x.current!==o&&(x.current=o);var T=(0,a.useRef)();T.current!==S&&(T.current=S);var O=(0,h.d)(w,500),_=(0,a.useCallback)((function(){var e=(0,P.mD)(O,i?.decimals);e&&e!==O&&b(e)}),[i?.decimals,O,b]);(0,a.useEffect)((function(){w||t(x.current?.address,x.current?.accountInfo?.account?.id)}),[w,t]),(0,a.useEffect)((function(){p.status||g?n():p.status||"save"!==p.flag?r(x.current?.address,x.current?.accountInfo?.account?.id):t(x.current?.address,x.current?.accountInfo?.account?.id)}),[t,n,r,g,p]),(0,a.useEffect)((function(){I.current&&S&&S.txId&&S.status===f.MG.SUCCESS&&!S.resetApproveValue&&t(x.current?.address,x.current?.accountInfo?.account?.id,S.blockNumber)}),[e,n,t,S]),(0,a.useEffect)((function(){if(i?.networkId===x.current?.networkId&&(i?.networkId!==d?.networkId||i?.contractAddress!==d?.contractAddress))return _(),t(x.current?.address,x.current?.accountInfo?.account?.id),function(){n()}}),[n,t,o.address,o.networkId,i,d?.networkId,d?.contractAddress,_]);var M=(0,s.usePageType)();(0,C.A)(l.V4.Swap,(function(e,t){M!==s.EPageType.modal&&(!e||t||T.current?.txId||y.current?n():r(x.current?.address,x.current?.accountInfo?.account?.id))})),(0,a.useEffect)((function(){M===s.EPageType.modal&&(!j||T.current?.txId||y.current?n():r(x.current?.address,x.current?.accountInfo?.account?.id))}),[n,j,M,r])}(),(0,m.j)(),function useSwapApproving(){var e=(0,A.A)(),{approvingStateAction:t,cleanApprovingInterval:n}=(0,c.eR)().current,[{swapApprovingTransaction:r},o]=(0,u.useInAppNotificationAtom)(),i=(0,a.useRef)();i.current!==r&&(i.current=r);var{approveTx:d}=useSwapBuildTx(),p=(0,a.useRef)(d);p.current!==d&&(p.current=d);var m=(0,k.E)(),g=(0,a.useRef)(m);g.current!==m&&(g.current=m),(0,a.useEffect)((function(){if(g.current)return r?.txId&&r?.status===f.MG.PENDING?t():n(),r?.status===f.MG.FAILED?s.Toast.error({title:e.formatMessage({id:j.ETranslations.swap_page_toast_approve_failed})}):r?.status===f.MG.CANCEL?s.Toast.error({title:e.formatMessage({id:j.ETranslations.swap_page_toast_approve_canceled})}):r?.status===f.MG.SUCCESS&&(r?.resetApproveValue&&Number(r?.resetApproveValue)>0?p.current?.(r?.resetApproveValue,!!r?.resetApproveIsMax):s.Toast.success({title:e.formatMessage({id:j.ETranslations.swap_page_toast_approve_successful})})),r?.status!==f.MG.FAILED&&r?.status!==f.MG.CANCEL||o((function(e){return useSwapApproving_objectSpread(useSwapApproving_objectSpread({},e),{},{swapApprovingTransaction:void 0})})),function(){n()}}),[t,n,e,o,r?.resetApproveIsMax,r?.resetApproveValue,r?.status,r?.txId]);var w=(0,s.usePageType)();(0,C.A)(l.V4.Swap,(function(e,r){w!==s.EPageType.modal&&(e&&!r&&i.current?.txId&&i.current?.status===f.MG.PENDING?t():n())})),(0,a.useEffect)((function(){w===s.EPageType.modal&&(m&&i.current?.txId&&i.current?.status===f.MG.PENDING?t():n())}),[t,n,m,w])}(),(0,T.jsxs)(s.YStack,{children:[(0,T.jsx)(L,{token:p,direction:f.En.FROM,selectTokenLoading:t,onAmountChange:function(e){(0,P.dM)(e,p?.decimals)&&i(e)},amountValue:o,onBalanceMaxPress:function(){var e=y;if(p?.reservationValue){var t=new g.A(null!=y?y:0),n=new g.A(p.reservationValue);t.minus(n).isGreaterThan(0)&&(e=t.minus(n).toFixed())}i(e)},onSelectToken:e,balance:y}),(0,T.jsxs)(s.YStack,{pt:"$3.5",children:[(0,T.jsx)(s.IconButton,{alignSelf:"flex-end",icon:"SwitchVerOutline",size:"small",zIndex:2,disabled:b.from||b.to,onPress:S,mb:"$-3"}),(0,T.jsx)(L,{token:w,inputLoading:d,selectTokenLoading:t,direction:f.En.TO,amountValue:null!=(r=v?.toAmount)?r:"",onSelectToken:e,balance:I,onToAnotherAddressModal:n})]})]})}));var F=n(503668),U=n.n(F);const components_SwapCommonInfoItem=function({title:e,value:t,onPress:n,isLoading:r,valueComponent:o,questionMarkContent:i,renderPopoverContent:c,popoverOnOpenChange:u}){var l=(0,a.useMemo)((function(){return(0,T.jsx)(s.Popover,{title:e,renderTrigger:(0,T.jsx)(s.IconButton,{variant:"tertiary",size:"small",icon:"QuestionmarkOutline"}),renderContent:(0,T.jsx)(s.SizableText,{p:"$5",$gtMd:{size:"$bodyMd"},children:i})})}),[i,e]),d=(0,a.useMemo)((function(){return(0,T.jsxs)(s.XStack,{userSelect:"none",hoverStyle:{opacity:.5},alignItems:"center",children:[o||(0,T.jsx)(s.SizableText,{onPress:n,size:"$bodyMdMedium",children:t}),n||c?(0,T.jsx)(s.Icon,{name:"ChevronRightSmallOutline",mr:"$-1",size:"$5",color:"$iconSubdued"}):null]})}),[n,c,t,o]),p=(0,a.useCallback)((function(){return c?(0,T.jsx)(s.Popover,{renderTrigger:d,renderContent:c,title:e,keepChildrenMounted:!0,onOpenChange:u}):d}),[u,c,d,e]);return(0,T.jsxs)(s.XStack,{justifyContent:"space-between",alignItems:"center",children:[(0,T.jsxs)(s.XStack,{children:[(0,T.jsx)(s.SizableText,{userSelect:"none",mr:"$1",size:"$bodyMd",color:"$textSubdued",children:e}),i?l:null]}),(0,T.jsx)(s.XStack,{space:"$2",children:r?(0,T.jsx)(s.Stack,{py:"$1",children:(0,T.jsx)(s.Skeleton,{h:"$3",w:"$24"})}):p()})]})};const components_SwapProviderInfoItem=function({showBest:e,rate:t,fromToken:n,toToken:r,providerIcon:o,showLock:i,onPress:c,isLoading:u}){var l=(0,A.A)(),{md:d}=(0,s.useMedia)(),p=(0,a.useMemo)((function(){return!new g.g(null!=t?t:0).isZero()}),[t]),f=(0,a.useMemo)((function(){if(!c||!n||!r)return(0,T.jsx)(s.SizableText,{size:"$bodyMdMedium",children:l.formatMessage({id:j.ETranslations.swap_page_provider_provider_insufficient_liquidity})});if(!p)return(0,T.jsx)(s.SizableText,{ml:"$1",size:"$bodyMdMedium",children:l.formatMessage({id:j.ETranslations.swap_page_provider_rate_unavailable})});var e=new g.g(null!=t?t:0);return(0,T.jsxs)(s.SizableText,{size:"$bodyMdMedium",pl:"$1",maxWidth:d?240:360,textAlign:"right",children:[`1 ${n.symbol.toUpperCase()} = `,(0,T.jsx)(s.NumberSizeableText,{size:"$bodyMdMedium",formatter:"balance",children:e.toFixed()})," ",(0,T.jsx)(s.SizableText,{size:"$bodyMdMedium",children:r.symbol})]})}),[n,l,d,c,t,p,r]);return(0,T.jsxs)(s.XStack,{justifyContent:"space-between",alignItems:"center",children:[(0,T.jsx)(s.SizableText,{size:"$bodyMd",color:"$textSubdued",userSelect:"none",children:l.formatMessage({id:j.ETranslations.swap_page_provider_provider})}),u?(0,T.jsx)(s.Stack,{py:"$1",children:(0,T.jsx)(s.Skeleton,{h:"$3",w:"$24"})}):(0,T.jsxs)(s.XStack,{alignItems:"center",userSelect:"none",hoverStyle:{opacity:.5},onPress:c,children:[e?(0,T.jsx)(s.Badge,{badgeType:"success",badgeSize:"sm",mr:"$1",children:"Best"}):null,o&&n&&r?(0,T.jsx)(s.Image,{source:{uri:o},w:"$5",h:"$5",borderRadius:"$1"}):null,f,i?(0,T.jsx)(s.Icon,{name:"LockOutline",color:"$iconSubdued",ml:"$1",size:"$5"}):null,c?(0,T.jsx)(s.Icon,{name:"ChevronRightSmallOutline",size:"$5",color:"$iconSubdued",mr:"$-1"}):null]})]})};const B=(0,a.memo)((function({onSelectAllowanceValue:e,currentSelectAllowanceValue:t,selectItems:n,onSelectOpenChange:r,isLoading:o}){var i=(0,A.A)(),c=(0,a.useCallback)((function(){return o?(0,T.jsx)(s.Stack,{py:"$1",children:(0,T.jsx)(s.Skeleton,{h:"$3",w:"$24"})}):(0,T.jsxs)(s.XStack,{userSelect:"none",hoverStyle:{opacity:.5},children:[(0,T.jsx)(s.SizableText,{size:"$bodyMdMedium",children:t?.label}),(0,T.jsx)(s.Icon,{size:"$5",color:"$iconSubdued",name:"ChevronRightSmallOutline",mr:"$-1"})]})}),[t?.label,o]);return(0,T.jsxs)(s.XStack,{justifyContent:"space-between",children:[(0,T.jsx)(s.SizableText,{size:"$bodyMd",color:"$textSubdued",userSelect:"none",children:i.formatMessage({id:j.ETranslations.swap_page_provider_approve_amount})}),(0,T.jsx)(s.Select,{placement:"bottom-end",items:n,value:t?.value,onChange:function(t){e(t)},onOpenChange:r,title:i.formatMessage({id:j.ETranslations.swap_page_provider_approve_amount}),renderTrigger:c})]})}));const H=(0,a.memo)((function({allowanceResult:e,fromTokenSymbol:t,isLoading:n}){var r=(0,A.A)(),[o,i]=(0,c.rE)(),[,u]=(0,c.FR)(),l=(0,a.useMemo)((function(){return[{label:(0,T.jsx)(s.NumberSizeableText,{size:"$bodyMdMedium",formatter:"balance",formatterOptions:{tokenSymbol:t},children:e.amount}),value:f.KF.PRECISION},{label:r.formatMessage({id:j.ETranslations.swap_page_provider_approve_amount_un_limit}),value:f.KF.UN_LIMIT}]}),[e.amount,t,r]),d=(0,a.useCallback)((function(e){i(e===f.KF.UN_LIMIT)}),[i]);return(0,T.jsx)(B,{currentSelectAllowanceValue:l[o?1:0],onSelectAllowanceValue:d,selectItems:l,isLoading:n,onSelectOpenChange:u})}));var W=n(712784),V=n.n(W);function SwapSlippageContentContainer_ownKeys(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}var K=(0,a.memo)((function({swapSlippage:e,onChangeText:t,props:n}){var[o,i]=(0,a.useState)(""),c=(0,a.useCallback)((function(e){(0,P.dM)(e,p.Oz)&&(i(e),t(e))}),[t]),u=(0,a.useMemo)((function(){return new g.g(e.value).decimalPlaces(p.Oz,g.g.ROUND_DOWN).toFixed()}),[e.value]);return(0,a.useEffect)((function(){i(u)}),[u]),(0,T.jsx)(s.Input,function SwapSlippageContentContainer_objectSpread(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?SwapSlippageContentContainer_ownKeys(Object(n),!0).forEach((function(t){(0,r.A)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):SwapSlippageContentContainer_ownKeys(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}({size:"medium",containerProps:{flex:1},value:o,autoFocus:e.key===f.k0.CUSTOM,addOns:[{label:"%"}],textAlign:"left",disabled:e.key===f.k0.AUTO,placeholder:u,onChangeText:c},n))}));const Q=(0,a.memo)((function({swapSlippage:e,onSave:t,autoValue:n}){var[r,o]=(0,a.useState)(e),i=(0,A.A)(),[c,u]=(0,a.useState)({status:f.nC.NORMAL,message:""}),l=(0,a.useCallback)(V()((function(e){var t=new g.g(e);t.isNaN()||t.isNegative()||t.gt(p.qm)?u({status:f.nC.ERROR,message:i.formatMessage({id:j.ETranslations.slippage_tolerance_error_message})}):(o({key:f.k0.CUSTOM,value:t.toNumber()}),t.lte(p.SF)?u({status:f.nC.WRONG,message:i.formatMessage({id:j.ETranslations.slippage_tolerance_warning_message_2},{number:p.SF})}):t.gte(p.Rq)?u({status:f.nC.WRONG,message:i.formatMessage({id:j.ETranslations.slippage_tolerance_warning_message_1},{number:p.Rq})}):u({status:f.nC.NORMAL,message:""}))}),350),[]);return(0,T.jsxs)(s.YStack,{space:"$4",children:[(0,T.jsx)(s.SegmentControl,{fullWidth:!0,value:r.key,options:p.dI.map((function(e){return{label:i.formatMessage({id:e.key===f.k0.AUTO?j.ETranslations.slippage_tolerance_switch_auto:j.ETranslations.slippage_tolerance_switch_custom}),value:e.key}})),onChange:function(t){o({key:t,value:t===f.k0.AUTO?n:e.value})}}),r.key!==f.k0.CUSTOM?(0,T.jsx)(K,{swapSlippage:r,onChangeText:l}):null,r.key===f.k0.CUSTOM?(0,T.jsxs)(s.XStack,{space:"$2.5",children:[(0,T.jsx)(K,{swapSlippage:r,onChangeText:l}),(0,T.jsx)(s.XStack,{children:p.RW.map((function(e,t){return(0,T.jsxs)(T.Fragment,{children:[(0,T.jsx)(s.Button,{variant:"secondary",size:"medium",borderTopRightRadius:2!==t?0:"$2",borderBottomRightRadius:2!==t?0:"$2",borderTopLeftRadius:0!==t?0:"$2",borderBottomLeftRadius:0!==t?0:"$2",onPress:function(){u({status:f.nC.NORMAL,message:""}),o({key:f.k0.CUSTOM,value:e})},children:`${e}${t===p.RW.length-1?"  ":""}%`},e),t!==p.RW.length-1?(0,T.jsx)(s.Divider,{vertical:!0}):null]})}))})]}):null,r.key===f.k0.AUTO?(0,T.jsx)(s.SizableText,{size:"$bodyMd",color:"$textSubdued",children:i.formatMessage({id:j.ETranslations.slippage_tolerance_description})}):null,r.key!==f.k0.AUTO&&c.status!==f.nC.NORMAL?(0,T.jsx)(s.SizableText,{size:"$bodySmMedium",color:c.status===f.nC.ERROR?"$textCritical":"$textCaution",children:c.message}):null,(0,T.jsx)(s.Dialog.Footer,{showCancelButton:!1,onConfirmText:i.formatMessage({id:j.ETranslations.slippage_tolerance_button_save}),confirmButtonProps:{variant:"primary",disabled:r.key===f.k0.CUSTOM&&c.status===f.nC.ERROR},onConfirm:function({close:e}){t(r,e)}})]})}));const X=(0,a.memo)((function({isLoading:e,onPress:t}){var n=(0,A.A)(),[{slippageItem:r}]=(0,c.H_)(),o=(0,a.useMemo)((function(){return new g.A(r.value).decimalPlaces(p.Oz,g.A.ROUND_DOWN).toFixed()}),[r.value]),i=(0,a.useMemo)((function(){return n.formatMessage({id:r.key===f.k0.AUTO?j.ETranslations.swap_page_provider_slippage_auto:j.ETranslations.swap_page_provider_custom},{number:o})}),[o,n,r.key]),u=(0,a.useMemo)((function(){return(0,T.jsx)(s.SizableText,{size:"$bodyMdMedium",onPress:t,color:r.value>p.Rq?"$textCritical":"$text",children:i})}),[t,i,r.value]);return(0,T.jsx)(components_SwapCommonInfoItem,{title:n.formatMessage({id:j.ETranslations.swap_page_provider_slippage_tolerance}),isLoading:e,onPress:t,questionMarkContent:n.formatMessage({id:j.ETranslations.slippage_tolerance_popover}),valueComponent:u})}));const G=(0,a.memo)((function({onOpenProviderList:e,quoteResult:t}){var n,r,[o]=(0,c.NE)(),[i]=(0,c.Q8)(),[l]=(0,u.useSettingsPersistAtom)(),d=useSwapQuoteLoading(),p=(0,A.A)(),[,m]=(0,c.DI)(),[{slippageItem:g,autoValue:w}]=(0,c.H_)(),[,b]=(0,c.$E)(),[,S]=(0,c.AF)(),v=(0,a.useRef)(null),y=(0,a.useCallback)((function(e,t){S(e.key),e.key===f.k0.CUSTOM&&b(e.value),t({flag:"save"})}),[b,S]),k=(0,a.useCallback)((function(){v.current=s.Dialog.show({title:p.formatMessage({id:j.ETranslations.slippage_tolerance_title}),renderContent:(0,T.jsx)(Q,{swapSlippage:g,autoValue:w,onSave:y}),onOpen:function(){m({status:!0})},onClose:function(e){m({status:!1,flag:e?.flag})}})}),[p,g,w,y,m]);return(0,T.jsxs)(s.YStack,{space:"$4",children:[t.allowanceResult?(0,T.jsx)(H,{allowanceResult:t.allowanceResult,fromTokenSymbol:null!=(n=o?.symbol)?n:"",isLoading:d}):null,U()(t.info.provider)?null:(0,T.jsx)(components_SwapProviderInfoItem,{providerIcon:null!=(r=t.info.providerLogo)?r:"",isLoading:d,rate:t.instantRate,fromToken:o,toToken:i,showLock:!!t.allowanceResult,onPress:t.info.provider?function(){e?.()}:void 0}),!t.toAmount||t.allowanceResult||t.unSupportSlippage?null:(0,T.jsx)(X,{isLoading:d,onPress:k}),t.fee?.estimatedFeeFiatValue?(0,T.jsx)(components_SwapCommonInfoItem,{title:p.formatMessage({id:j.ETranslations.swap_page_provider_est_network_fee}),isLoading:d,valueComponent:(0,T.jsx)(s.NumberSizeableText,{size:"$bodyMdMedium",formatter:"value",formatterOptions:{currency:l.currencyInfo.symbol},children:t.fee?.estimatedFeeFiatValue})}):null]})}));function SwapMainLand_ownKeys(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function SwapMainLand_objectSpread(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?SwapMainLand_ownKeys(Object(n),!0).forEach((function(t){(0,r.A)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):SwapMainLand_ownKeys(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var SwapMainLoad=function({swapInitParams:e,pageType:t}){var n,{buildTx:r,approveTx:g,wrappedTx:w}=useSwapBuildTx(),{fetchLoading:b}=(0,I.FI)(e),S=(0,i.A)(),[v]=(0,c.Zr)(),[y]=(0,c.LX)(),A=(0,m.z)(f.En.TO),k=useSwapQuoteLoading(),[j]=(0,c.WC)(),h=(0,a.useCallback)((function(e){S.pushModal(l.ry.SwapModal,{screen:d.u.SwapTokenSelect,params:{type:e,storeName:t===s.EPageType.modal?u.EJotaiContextStoreNames.swapModal:u.EJotaiContextStoreNames.swap}})}),[S,t]),x=(0,a.useCallback)((function(){S.pushModal(l.ry.SwapModal,{screen:d.u.SwapProviderSelect,params:{storeName:t===s.EPageType.modal?u.EJotaiContextStoreNames.swapModal:u.EJotaiContextStoreNames.swap}})}),[S,t]),M=(0,a.useCallback)((function(){S.pushModal(l.ry.SwapModal,{screen:d.u.SwapToAnotherAddress,params:{address:A.address,storeName:t===s.EPageType.modal?u.EJotaiContextStoreNames.swapModal:u.EJotaiContextStoreNames.swap}})}),[S,t,A.address]),C=(0,a.useCallback)((0,o.A)((function*(){yield r()})),[r]),P=(0,a.useCallback)((n=(0,o.A)((function*(e,t,n){n?yield g(p.XU,t,e):yield g(e,t)})),function(e,t,r){return n.apply(this,arguments)}),[g]),R=(0,a.useCallback)((0,o.A)((function*(){yield w()})),[w]);return(0,T.jsx)(s.ScrollView,{children:(0,T.jsxs)(s.YStack,{testID:"swap-content-container",flex:1,marginHorizontal:"auto",width:"100%",maxWidth:t===s.EPageType.modal?"100%":480,children:[(0,T.jsxs)(s.YStack,{pt:"$2.5",px:"$5",pb:"$5",space:"$5",flex:1,$gtMd:{flex:"unset",pt:"$5"},children:[t!==s.EPageType.modal?(0,T.jsx)(E,{pageType:t}):null,(0,T.jsx)(z,{onSelectToken:h,selectLoading:b,onToAnotherAddressModal:M}),y.length>0&&!k&&!j.from&&!j.to?(0,T.jsx)(_,{alerts:y}):null,v?(0,T.jsx)(G,{onOpenProviderList:x,quoteResult:v}):null]}),(0,T.jsx)(O,{onBuildTx:C,onApprove:P,onWrapped:R})]})})};const SwapMainLand=function(e){return(0,T.jsx)(x.o,{storeName:e?.pageType===s.EPageType.modal?u.EJotaiContextStoreNames.swapModal:u.EJotaiContextStoreNames.swap,children:(0,T.jsx)(SwapMainLoad,SwapMainLand_objectSpread({},e))})}}}]);